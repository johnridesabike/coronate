{"version":3,"sources":["serviceWorker.js","side-effects.js","data-types/types.js","data-types/constants.js","data-types/factories.js","data-types/index.js","pairing-scoring/ratings.js","pairing-scoring/helpers.js","pairing-scoring/scoring.js","pairing-scoring/factories.js","pairing-scoring/pairing.js","components/icons.jsx","hooks/reducers/generic-db-reducer.js","hooks/reducers/options-reducer.js","hooks/reducers/players-reducer.js","hooks/reducers/match-functions.js","hooks/reducers/tournament-reducer.js","demo-data/index.js","hooks/db.js","hooks/tournament-provider.jsx","hooks/index.js","components/tournament/crosstable.jsx","components/utility.jsx","components/new-player.jsx","components/tournament/player-select/selecting.jsx","components/tournament/player-select/index.jsx","components/tournament/pair-picker/player-info.jsx","components/tournament/pair-picker/select-list.jsx","components/tournament/pair-picker/stage.jsx","components/tournament/pair-picker/index.jsx","components/tournament/round/player-match-info.jsx","components/tournament/round/match-row.jsx","components/tournament/round/round.jsx","components/tournament/round/index.jsx","components/tournament/scores.jsx","components/tournament/header.jsx","components/tournament/sidebar.jsx","components/tournament/tournament.jsx","components/tournament/tournament-list.jsx","components/tournament/index.jsx","components/caution/index.jsx","components/404.jsx","components/options.jsx","components/players/info-box.jsx","components/players/player-list.jsx","components/players/index.jsx","components/splash.jsx","App.jsx","index.jsx","components/tournament/scores.module.css","App.module.css","components/tournament/tournament.module.css","components/splash.module.css","components/tournament/round/round.module.css","components/players/index.module.css","components/caution/index.module.css","components/utility.module.css"],"names":["Boolean","window","location","hostname","match","numeral","register","format","value","roundingFunction","whole","Math","floor","remainder","fraction","String","regexps","unformat","Number","Id","t","refinement","id","test","AvoidPair","tuple","Player","interface","firstName","lastName","matchCount","rating","type","PlayerStats","avoidList","list","colorBalance","dueColor","maybe","hasHadBye","isDueBye","opponentHistory","profile","score","upperHalf","Match","newRating","origRating","playerIds","result","RoundList","Tournament","byeQueue","name","roundList","tieBreaks","ScoreCalulator","func","Standing","BLACK","WHITE","DUMMY_ID","createMatch","importObj","nanoid","createPlayer","arguments","length","undefined","dummyPlayer","missingPlayer","kFactor","isNotDummy","playerId","getPlayerMaybe","playerDict","dict","player","isNotBye","includes","getMatchesByPlayer","matchList","filter","getMatchesByPlayerNoByes","getMatchDetailsForPlayer","index","indexOf","color","rounds2Matches","roundId","slice","reduce","acc","round","concat","getAllPlayersFromMatches","allPlayers","Array","from","Set","getUnmatched","tourney","players","matchedIds","Object","values","assoc","getPlayerAvoidList","pair","accumulator","getDueColor","lastMatch","last","getPlayersByOpponent","opponentId","getOpponentScores","map","opponent","getPlayerScore","of","scoreList","getPlayerScoreList","sum","getCumulativeScore","getPlayerScoreListNoByes","getCumulativeOfOpponentScore","oppScores","getColorBalanceScore","colorList","tieBreakMethods","0","scores","pipe","sort","a","b","init","tail","1","2","3","4","createStandingList","methods","selectedTiebreakMethods","selectedTieBreaks","i","tieBreakNames","m","standings","_ref","sortFunc","keys","key","thenBy","standing1","standing2","firstBy","createStandingTree","_createStandingList","_createStandingList2","slicedToArray","standingsFlat","standing","orig","prevStanding","append","over","lensIndex","createPlayerStats","_ref2","matches","freeze","priority","condition","avoidMeetingTwice","sameScores","divider","differentHalf","differentDueColor","maxPriority","add","calcPairIdeal","player1","player2","metBefore","mustAvoid","abs","setUpperHalves","playerStatsList","splitInHalf","splitAt","ignore","src","isUpperHalf","view","setByePlayer","hasNotHadBye","p","nextByeSignup","indexOfDueBye","findLastIndex","sortPlayersForPairing","simpleIcon","icon","props","react_default","createElement","assign","dangerouslySetInnerHTML","__html","svg","aria-label","title","role","style","fill","hex","icons","Alert","ArrowDown","ArrowUp","ArrowUpLeft","Check","ChevronLeft","ChevronRight","Edit","Info","Javascript","Layers","List","Plus","React","ReactIcon","Repeat","Settings","Trash","UserMinus","UserPlus","Users","X","ActionLoadState","state","Any","ActionDelItem","ActionAddItem","item","ActionAddTourney","AdctionAddPlayer","ActionTypes","union","genericDbReducer","action","nextId","console","warn","dissoc","Error","dispatch","x","ADD_ITEM","ADD_PLAYER","ADD_TOURNEY","DEL_ITEM","LOAD_STATE","ActionSetOption","option","ActionAvoidPair","ActionAvoidSingle","optionsReducer","lensProp","ADD_AVOID_PAIR","DEL_AVOID_PAIR","DEL_AVOID_SINGLE","SET_OPTION","ActionSetPlayer","ActionAddPlayer","ActionDelPlayer","ActionSetMatchcount","ActionSetRating","playersReducer","mergeLeft","lensPath","set","DEL_PLAYER","SET_PLAYER","SET_PLAYER_MATCHCOUNT","SET_PLAYER_RATING","autoPair","byeValue","pairs","curry","potentialMatches","playerMatches","reducedResults","blossom","p1Index","p2Index","p1Id","p2Id","p1","p2","matched","pair1","pair2","reverse","byePlayer","pairPlayers","log","getPlayer","idsPair","ActionAddRound","ActionDelLastRound","ActionAddRemoveTieBreak","ActionMoveTieBreak","newIndex","oldIndex","ActionSetTourneyPlayers","ActionSetByeQueue","ActionAutoPair","ActionManualPair","ActionSetMatchResult","matchId","ActionEditMatch","ActionMoveMatch","tournamentReducer","remove","move","__","manualPair","findIndex","propEq","mergeRight","ADD_ROUND","ADD_TIEBREAK","AUTO_PAIR","DEL_LAST_ROUND","DEL_MATCH","DEL_TIEBREAK","MANUAL_PAIR","MOVE_MATCH","MOVE_TIEBREAK","SET_BYE_QUEUE","SET_MATCH_RESULT","SET_STATE","SET_TOURNEY_PLAYERS","SWAP_COLORS","tournaments","demo_data","options","setItemsPrototype","localForage","removeItemsPrototype","optionsStore","createInstance","storeName","playerStore","tourneyStore","useAllItemsFromDb","store","_useReducer","useReducer","_useReducer2","items","_useState","useState","_useState2","isLoaded","setIsLoaded","useEffect","getItems","then","results","_config","setItems","deleted","difference","removeItems","useAllPlayersDb","useAllTournamentsDb","useOptionsDb","_useReducer3","demoData","_useReducer4","_useState3","_useState4","iterate","TournamentContext","createContext","useTournament","useContext","TournamentProvider","children","tourneyId","tourneyDispatch","playersDispatch","isTourneyLoaded","setIsTourneyLoaded","isPlayersLoaded","setIsPlayersLoaded","getItem","allTheIds","unChangedPlayers","symmetricDifference","catch","error","setItem","Provider","useDocumentTitle","origTitle","document","Crosstable","_useTournament","oppResults","defaultTo","opponentScores","getRatingChange","_getPerformanceRating","firstMatch","getPerformanceRatings","_getPerformanceRating2","firstRating","lastRating","change","className","table","rank","row","scope","playerName","index2","player1Id","player2Id","getXScore","Panel","_ref4","styles","panel","objectSpread","PanelContainer","panels","findById","NewPlayer","newPlayerDefault","newPlayerData","setNewPlayerdata","updateField","event","preventDefault","_event$currentTarget","currentTarget","prevState","onSubmit","htmlFor","required","onChange","Selecting","_useAllPlayersDb","_useAllPlayersDb2","allPlayersDispatch","togglePlayer","target","checked","pId","onClick","PlayerSelect","isSelecting","setIsSelecting","colSpan","disabled","dialog_es","isOpen","PlayerInfo","_useOptionsDb","_createPlayerStats","avoidPairs","prettyBalance","opId","SelectList","stagedPlayers","setStagedPlayers","unmatched","unmatchedCount","unmatchedWithDummy","selectPlayer","visually_hidden_es","Stage","_stagedPlayers","white","black","unstage","react","every","PairPicker","isModalOpen","setIsModalOpen","statsList","useMemo","matchIdeal","ideal","PlayerMatchInfo","playerData","data-testid","MatchRow","pos","selectedMatch","setSelectedMatch","openModal","setOpenModal","resultCode","whitePlayer","blackPlayer","whiteName","blackName","setMatchResult","origRatings","matchCounts","whiteElo","EloRank","blackElo","scoreExpected","getExpected","updateRating","calcNewRatings","aria-hidden","winnerSelect","onBlur","Round","moveMatch","direction","forEach","unMatch","Index","openTab","setOpenTab","tabs_es","ScoreTable","_createStandingTree","_createStandingTree2","standingTree","tbMethods","topHeader","j","rowSpan","dashify","SelectTieBreaks","_useTournament2","selectedTb","setSelectedTb","toggleTb","defaultId","moveTb","Scores","Header","Sidebar","isNewRoundReady","lastRound","roundCount","playerCount","ceil","log2","isFinite","calcNumOfRounds","isItOver","tooltipText","tooltipWarn","_delLastRound","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","confirm","navigate","stop","apply","this","es","to","tooltip_es","label","tournament","header","sidebar","content","path","tournament_scores","TournamentList","_useAllTournamentsDb","_useAllTournamentsDb2","tourneys","newTourneyName","setNewTourneyName","isFormOpen","setIsFormOpen","placeholder","TournamentIndex","Caution","caution","caution__text","caution__link","href","NotFound","Options","tourneysDispatch","text","setText","_useOptionsDb2","optionsDispatch","exportData","loadData","data","alert","JSON","stringify","download","encodeURIComponent","reader","FileReader","onload","ev","parse","readAsText","files","cols","rows","spellCheck","PlayerInfoBox","singAvoidList","setSingAvoidList","unAvoided","selectedAvoider","setSelectedAvoider","handleChange","playerInfo","defaultValue","readOnly","arial-label","PlayerList","message","delPlayer","Players","childProps","basepath","Splash","splash","hint","footer","textAlign","fontSize","source","createHashSource","history","createHistory","App","mainMenu","link","tournament_Tournament","_404","default","ReactDOM","render","src_App","getElementById","navigator","serviceWorker","ready","registration","unregister","module","exports","controls"],"mappings":"+WAaoBA,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,yGChBNC,IAAQC,SAAS,SAAU,WAAY,CAEnCC,OAAQ,SAAUC,EAAOD,EAAQE,GAC7B,IAAMC,EAAQC,KAAKC,MAAMJ,GACnBK,EAAYL,EAAQE,EACpBI,EAAY,WACd,OAAQD,GACR,IAAK,IACD,MAAO,OACX,IAAK,GACD,MAAO,OACX,IAAK,IACD,MAAO,OACX,QACI,MAAO,IATG,GAiBlB,OAJe,IAAVH,GAAeG,EACd,GACAE,OAAOL,IAEUI,GAE3BE,QAAS,CACLT,OAAQ,SACRU,SAAU,UAEdA,SAAU,SAAUT,GAEhB,OAAOU,OAAOV,wCC/BhBW,EAAKC,IAAEC,WACTD,IAAEL,OACF,SAACO,GAAD,MAAQ,sBAAsBC,KAAKD,IACnC,UAIEE,EAAYJ,IAAEK,MAAM,CAACN,EAAIA,GAAK,aAG9BO,EAASN,IAAEO,UACb,CACIC,UAAWR,IAAEL,OACbO,GAAIH,EACJU,SAAUT,IAAEL,OACZe,WAAYV,IAAEF,OACda,OAAQX,IAAEF,OACVc,KAAMZ,IAAEL,QAEZ,UAIEkB,EAAcb,IAAEO,UAClB,CACIO,UAAWd,IAAEe,KAAKhB,GAClBiB,aAAchB,IAAEF,OAChBmB,SAAUjB,IAAEkB,MAAMlB,IAAEF,QACpBqB,UAAWnB,IAAEpB,QACbsB,GAAIH,EACJqB,SAAUpB,IAAEpB,QACZyC,gBAAiBrB,IAAEe,KAAKhB,GACxBuB,QAAShB,EACTK,OAAQX,IAAEF,OACVyB,MAAOvB,IAAEF,OACT0B,UAAWxB,IAAEpB,SAEjB,eAIE6C,EAAQzB,IAAEO,UACZ,CACIL,GAAIH,EACJ2B,UAAW1B,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,SAChC6B,WAAY3B,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,SACjC8B,UAAW5B,IAAEK,MAAM,CAACN,EAAIA,IACxB8B,OAAQ7B,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,UAEjC,SAIEgC,EAAY9B,IAAEe,KAAKf,IAAEe,KAAKU,GAAQ,cAGlCM,EAAa/B,IAAEO,UACjB,CACIyB,SAAUhC,IAAEe,KAAKf,IAAEL,QACnBO,GAAIH,EACJkC,KAAMjC,IAAEL,OACRiC,UAAW5B,IAAEe,KAAKf,IAAEL,QACpBuC,UAAWJ,EACXK,UAAWnC,IAAEe,KAAKf,IAAEF,SAExB,cAIEsC,EAAiBpC,IAAEqC,KACrB,CAACtC,EAAIC,IAAEe,KAAKU,IACZzB,IAAEF,OACF,kBAIEwC,EAAWtC,IAAEO,UACf,CACIL,GAAIH,EACJwB,MAAOvB,IAAEF,OACTqC,UAAWnC,IAAEe,KAAKf,IAAEF,SAExB,YCpFEyC,EAAQ,EAERC,EAAQ,EAERC,EAAW,yCCAV,SAASC,EAAYC,GACxB,OAAOlB,EAAM,CACTvB,GAAIyC,EAAUzC,IAAM0C,MACpBlB,UAAWiB,EAAUjB,UACrBC,WAAYgB,EAAUhB,WACtBC,UAAWe,EAAUf,UACrBC,OAAQc,EAAUd,QAAU,CAAC,EAAG,KAIjC,SAASgB,IAA6B,IAAhBF,EAAgBG,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAJ,GACrC,OAAOxC,EAAO,CACVE,UAAWmC,EAAUnC,WAAa,GAClCN,GAAIyC,EAAUzC,IAAM0C,MACpBnC,SAAUkC,EAAUlC,UAAY,GAChCC,WAAYiC,EAAUjC,YAAc,EACpCC,OAAQgC,EAAUhC,QAAU,EAC5BC,KAAM+B,EAAU/B,MAAQ,WCPhC,IAAMqC,EAAcJ,EAAa,CAC7BrC,UAAW,MACXN,GAAIuC,EACJhC,SAAU,SACVG,KAAM,UAGJsC,EAAgB,SAAChD,GAAD,OAAQ2C,EAAa,CACvCrC,UAAW,YACXN,GAAIA,EACJO,SAAU,SACVG,KAAM,8BCrBH,SAASuC,EAAQzC,GAEpB,OAAQ,KADGV,IAAEF,OAAOY,IAAe,eCYjC0C,EAAa,SAACC,GAAD,OAAcA,IAAaZ,GA6CvC,SAASa,EAAeC,EAAYrD,GAGvC,GAFAF,IAAEwD,KAAKzD,EAAIO,EAAXN,CAAmBuD,GACnBxD,EAAGG,GACCA,IAAOuC,EACP,OAAOQ,EAEX,IAAMQ,EAASF,EAAWrD,GAC1B,OAAQuD,GAAmBP,EAAchD,GAM7C,IAAMwD,EAAW,SAAC1E,GAAD,OAAYA,EAAM4C,UAAU+B,SAASlB,IAG/C,SAASmB,EAAmBP,EAAUQ,GAEzC,OADA7D,IAAEe,KAAKU,EAAPzB,CAAc6D,GACPA,EAAUC,OAAO,SAAC9E,GAAD,OAAWA,EAAM4C,UAAU+B,SAASN,KAGzD,SAASU,EAAyBV,EAAUQ,GAE/C,OADA7D,IAAEe,KAAKU,EAAPzB,CAAc6D,GACPA,EAAUC,OACb,SAAC9E,GAAD,OAAWA,EAAM4C,UAAU+B,SAASN,IAAaK,EAAS1E,KAI3D,SAASgF,EAAyBX,EAAUrE,GAC/Ce,EAAGsD,GACH5B,EAAMzC,GACN,IAAMiF,EAAQjF,EAAM4C,UAAUsC,QAAQb,GACtC,MAAO,CACHc,MAAOF,EACPvC,UAAW1C,EAAM0C,UAAUuC,GAC3BtC,WAAY3C,EAAM2C,WAAWsC,GAC7BpC,OAAQ7C,EAAM6C,OAAOoC,IAOtB,SAASG,EAAelC,GAA2B,IAAhBmC,EAAgBvB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAN,KAQhD,OAPAhB,EAAUI,GACVlC,IAAEkB,MAAMlB,IAAEF,OAAVE,CAAkBqE,IAED,OAAZA,EACCnC,EACAA,EAAUoC,MAAM,EAAGD,EAAU,IAErBE,OAAO,SAACC,EAAKC,GAAN,OAAgBD,EAAIE,OAAOD,IAAQ,IAGrD,SAASE,EAAyBd,GACrC7D,IAAEe,KAAKU,EAAPzB,CAAc6D,GACd,IAAMe,EAAaf,EAAUU,OACzB,SAACC,EAAKxF,GAAN,OAAgBwF,EAAIE,OAAO1F,EAAM4C,YACjC,IAEJ,OAAOiD,MAAMC,KAAK,IAAIC,IAAIH,IAgCvB,SAASI,EAAaC,EAASC,EAASb,GAC3CtC,EAAWkD,GACXjF,IAAEwD,KAAKzD,EAAIO,EAAXN,CAAmBkF,GACnBlF,IAAEF,OAAOuE,GACT,IACMc,GADYF,EAAQ/C,UAAUmC,IAAY,IACnBE,OACzB,SAACC,EAAKxF,GAAN,OAAgBwF,EAAIE,OAAO1F,EAAM4C,YACjC,IAUJ,OARkBwD,OAAOC,OAAOH,GAASX,OACrC,SAACC,EAAKf,GAAN,OACK0B,EAAWxB,SAASF,EAAOvD,IAC1BsE,EACAc,YAAM7B,EAAOvD,GAAIuD,EAAQe,IAE/B,IAgBD,SAASe,EAAmBlC,EAAUvC,GAGzC,OAFAd,IAAEe,KAAKX,EAAPJ,CAAkBc,GAClBf,EAAGsD,GACIvC,EAAUgD,OACb,SAAC0B,GAAD,OAAUA,EAAK7B,SAASN,KAC1BkB,OACE,SAACkB,EAAaD,GAAd,OAAuBA,EAAKd,OAAOe,IACnC,IACF3B,OACE,SAAC5D,GAAD,OAAQA,IAAOmD,8HCvKhB,SAASqC,GAAYrC,EAAUQ,GAClC9D,EAAGsD,GACHrD,IAAEe,KAAKU,EAAPzB,CAAc6D,GACd,IAAM8B,EAAYC,YAAKhC,EAAmBP,EAAUQ,IACpD,OAAK8B,EAGW3B,EAAyBX,EAAUsC,GAA5CxB,QACW3B,EAASD,EAAQC,EAHxB,KAMR,SAASrB,GAAUkC,EAAUQ,GAGhC,OAFA9D,EAAGsD,GACHrD,IAAEe,KAAKU,EAAPzB,CAAc6D,GACPD,EACHP,EACAQ,GACFU,OACE,SAACC,EAAKxF,GAAN,OAAgBwF,EAAIE,OAAO1F,EAAM4C,YACjC,IACF+B,SAASlB,GAGR,SAASoD,GAAqBC,EAAYjC,GAG7C,OAFA9D,EAAG+F,GACH9F,IAAEe,KAAKU,EAAPzB,CAAc6D,GACPD,EACHkC,EACAjC,GACFU,OACE,SAACC,EAAKxF,GAAN,OAAgBwF,EAAIE,OAAO1F,EAAM4C,YACjC,IACFkC,OACE,SAACT,GAAD,OAAcA,IAAayC,IAOnC,SAASC,GAAkB1C,EAAUQ,GAWjC,OAVA9D,EAAGsD,GACHrD,IAAEe,KAAKU,EAAPzB,CAAc6D,GACCgC,GACXxC,EACAQ,GACFC,OACEV,GACF4C,IACE,SAACC,GAAD,OAAcC,GAAeD,EAAUpC,KAQ/C,IAAMqC,GAAiB9D,EAAe+D,GAElC,SAAyB9C,EAAUQ,GAC/B,IAAMuC,EDyCP,SAA4B/C,EAAUQ,GAGzC,OAFA9D,EAAGsD,GACHrD,IAAEe,KAAKU,EAAPzB,CAAc6D,GACPD,EACHP,EACAQ,GACFmC,IACE,SAAChH,GAAD,OAAWgF,EAAyBX,EAAUrE,GAAO6C,SChDnCwE,CAAmBhD,EAAUQ,GAC/C,OAAOyC,YAAIF,KAQbG,GAAqBnE,EAAe+D,GAEtC,SAA6B9C,EAAUQ,GACnC,IAAMuC,EDwCP,SAAkC/C,EAAUQ,GAG/C,OAFA9D,EAAGsD,GACHrD,IAAEe,KAAKU,EAAPzB,CAAc6D,GACPE,EACHV,EACAQ,GACFmC,IACE,SAAChH,GAAD,OAAWgF,EAAyBX,EAAUrE,GAAO6C,SC/CnC2E,CACdnD,EACAQ,GACFU,OACE,SAACC,EAAKjD,GAAN,OAAgBiD,EAAIE,OAAO,CAACkB,YAAKpB,GAAOjD,KACxC,CAAC,IAEL,OAAO+E,YAAIF,KAObK,GAA+BrE,EAAe+D,GAEhD,SAAuC9C,EAAUQ,GAC7C,IAAM6C,EAAYb,GACdxC,EACAQ,GACFC,OACEV,GACF4C,IACE,SAAC9F,GAAD,OAAQqG,GAAmBrG,EAAI2D,KAEnC,OAAOyC,YAAII,KAQbC,GAAuBvE,EAAe+D,GAExC,SAA+B9C,EAAUQ,GACrC,IAAM+C,EAAY7C,EACdV,EACAQ,GACFU,OACE,SAACC,EAAKxF,GAAN,OACKA,EAAM4C,UAAUY,KAAWa,EAC1BmB,EAAIE,QAAQ,GACZF,EAAIE,OAAO,IAEjB,CAAC,IAEL,OAAO4B,YAAIM,KA6BbC,GAAkB,CACpBC,EAAG,CACCzE,KAvBuBD,EAAe+D,GAE1C,SAAiC9C,EAAUQ,GACvC,IAAMkD,EAAShB,GAAkB1C,EAAUQ,GAC3C,OAAOmD,YACHC,YAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAIC,IACnBC,IACAC,KACAf,IAJGU,CAKLD,KAeF7G,GAAI,EACJ+B,KAAM,mBAEVqF,EAAG,CACCjF,KAfgBD,EAAe+D,GAEnC,SAA0B9C,EAAUQ,GAChC,IAAMuC,EAAYL,GAAkB1C,EAAUQ,GAC9C,OAAOyC,YAAIF,KAYXlG,GAAI,EACJ+B,KAAM,WAEVsF,EAAG,CACClF,KAAMkE,GACNrG,GAAI,EACJ+B,KAAM,oBAEVuF,EAAG,CACCnF,KAAMoE,GACNvG,GAAI,EACJ+B,KAAM,4BAEVwF,EAAG,CACCpF,KAAMsE,GACNzG,GAAI,EACJ+B,KAAM,eC5JP,SAASyF,GAAmBC,EAASzF,EAAWmC,GACnDrE,IAAEe,KAAKf,IAAEF,OAATE,CAAiB2H,GACjB3H,IAAEe,KAAKf,IAAE6E,MAAT7E,CAAgBkC,GAChBlC,IAAEkB,MAAMlB,IAAEF,OAAVE,CAAkBqE,GAClB,IDmKiCuD,ECnK3B/D,EAAYO,EAAelC,EAAWmC,GACtCwD,EAAoBF,EAAQ3B,IAAI,SAAC8B,GAAD,OAAOjB,GAAgBiB,KACvDC,EAAgBF,EAAkB7B,IAAI,SAACgC,GAAD,OAAOA,EAAE/F,OAE/CgG,EAAYtD,EACdd,GACFmC,IACE,SAAC9F,GAAD,OAAQoC,EAAS,CACbpC,KACAqB,MAAO2E,GAAehG,EAAI2D,GAC1B1B,UAAW0F,EAAkB7B,IAAI,SAAAkC,GAAA,OAAY7F,EAAZ6F,EAAE7F,MAAenC,EAAI2D,SAGxDsE,GDsJ2BP,ECtJKC,EDuJ/BzC,OAAOgD,KAAKR,GAAyBrD,OACxC,SAACC,EAAK6D,GAAN,OACI7D,EAAI8D,OACA,SAACC,EAAWC,GAAZ,OACIA,EAAUrG,UAAUkG,GAAOE,EAAUpG,UAAUkG,MAI3DI,mBAAQ,SAACF,EAAWC,GAAZ,OAA0BA,EAAUjH,MAAQgH,EAAUhH,UC7JlE,MAAO,CADiB0F,YAAKkB,EAAUF,GACdF,GAStB,SAASW,GAAmBf,EAASzF,GAA2B,IAAhBmC,EAAgBvB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAN,KAC7D9C,IAAEe,KAAKf,IAAEF,OAATE,CAAiB2H,GACjB7F,EAAUI,GACVlC,IAAEkB,MAAMlB,IAAEF,OAAVE,CAAkBqE,GAHiD,IAAAsE,EAO/DjB,GAAmBC,EAASzF,EAAWmC,GAPwBuE,EAAAxD,OAAAyD,EAAA,EAAAzD,CAAAuD,EAAA,GAK/DG,EAL+DF,EAAA,GAM/Db,EAN+Da,EAAA,GAyBnE,MAAO,CAjBqBE,EAAchF,OAAOV,GACPmB,OAEtC,SAA+BC,EAAKuE,EAAUjB,EAAGkB,GAC7C,IF/DmBT,EAAWC,EE+DxBS,EAAeD,EAAKlB,EAAI,GAK9B,OAFW,IAANA,IFlEyBU,EEkEmBS,EFjEzD3G,EAD2BiG,EEkEoBQ,GFhE/CzG,EAASkG,KAELD,EAAUhH,QAAUiH,EAAUjH,QAK9BgH,EAAUpG,UAAUoC,OAChB,SAACC,EAAKpF,EAAO0I,GAAb,OAAmBtD,EAAIE,OAAOtF,IAAUoJ,EAAUrG,UAAU2F,KAC5D,IACFnE,UAAS,KEyDIuF,YAAO,CAACH,GAAWvE,GAGvB2E,YAAKC,YAAU5E,EAAIzB,OAAS,GAAImG,YAAOH,GAAWvE,IAE7D,IAEmBuD,GAMpB,SAASsB,GAATC,GAMJ,IALCxI,EAKDwI,EALCxI,UACAZ,EAIDoJ,EAJCpJ,GACAgF,EAGDoE,EAHCpE,QACAhD,EAEDoH,EAFCpH,UACAmC,EACDiF,EADCjF,QAEAtE,EAAGG,GACHF,IAAEF,OAAOuE,GACTrE,IAAEwD,KAAKzD,EAAIO,EAAXN,CAAmBkF,GACnBlF,IAAEe,KAAKX,EAAPJ,CAAkBc,GAClBgB,EAAUI,GACV,IAAMqH,EAAUnF,EAAelC,EAAWmC,GAC1C,OAAOxD,EAAY,CACfC,UAAWyE,EAAmBrF,EAAIY,GAClCE,aAAc2F,GAAqBzG,EAAIqJ,GACvCtI,SAAUyE,GAAYxF,EAAIqJ,GAC1BpI,UAAWA,GAAUjB,EAAIqJ,GACzBrJ,GAAIA,EACJkB,UAAU,EACVC,gBAAiBwE,GAAqB3F,EAAIqJ,GAC1CjI,QAAS4D,EAAQhF,GACjBS,OAAQuE,EAAQhF,GAAIS,OACpBY,MAAO2E,GAAehG,EAAIqJ,GAC1B/H,WAAW,ID4EnB4D,OAAOoE,OAAO3C,QE1KazH,8FADrBqK,GAAW,SAACrK,GAAD,OAAW,SAACsK,GAAD,OAAeA,EAAYtK,EAAQ,IASzDuK,GAAoBF,GAAS,IAS7BG,IAjBqBxK,GAiBU,GAjBA,SAACyK,GAAD,OAAazK,GAAQyK,IAwBpDC,GAAgBL,GAAS,GAKzBM,GAAoBN,GAAS,GAE7BO,GAAchD,YAChBiD,YAAIH,IAAc,IAClBG,YAAIF,IAAkB,IACtBE,YAAIL,GAAW,IACfK,YAAIN,IAAkB,IAJN3C,CAKlB,GAMK,SAASkD,GAAcC,EAASC,GAGnC,GAFAvJ,EAAYsJ,GACZtJ,EAAYuJ,GACRD,EAAQjK,KAAOkK,EAAQlK,GACvB,OAAO,EAEX,IAAMmK,EAAYF,EAAQ9I,gBAAgBsC,SAASyG,EAAQlK,IACrDoK,EAAYH,EAAQrJ,UAAU6C,SAASyG,EAAQlK,IACrD,OAAO8G,YACHiD,YAAIH,GACAK,EAAQ3I,YAAc4I,EAAQ5I,WAC3B2I,EAAQ5I,QAAU6I,EAAQ7I,QAEjC0I,YAAIF,GACqB,OAArBI,EAAQlJ,UACLkJ,EAAQlJ,WAAamJ,EAAQnJ,WAEpCgJ,YAAIL,GAAWrK,KAAKgL,IAAIJ,EAAQ5I,MAAQ6I,EAAQ7I,OAAS,IACzD0I,YAAIN,IAAmBU,IAAcC,IAVlCtD,CAWL,GAQC,SAASwD,GAAeC,GAC3BzK,IAAEe,KAAKF,EAAPb,CAAoByK,GACpB,IAAMC,EAAc,SAAC3J,GAAD,OAAU4J,aAAQ5J,EAAKgC,OAAS,EAAGhC,IACvD,OAAO0J,EAAgBlG,OACnB,SAAUC,EAAKf,EAAQmH,EAAQC,GAC3B,IAMMC,EANe9D,YACjBlD,aAAO,SAACoD,GAAD,OAAOA,EAAE3F,QAAUkC,EAAOlC,QACjCmJ,EACAK,aAAK3B,YAAU,IACfpD,aAAI,SAACkB,GAAD,OAAOA,EAAEhH,KAJI8G,CAKnB6D,GAC+BlH,SAASF,EAAOvD,IACjD,OAAOsE,EAAIE,OAAO,CAACY,YAAM,YAAawF,EAAarH,MAEvD,IAIR,SAASuH,GAAahJ,EAAUyI,GAI5B,GAHAzK,IAAEe,KAAKf,IAAEF,OAATE,CAAiBgC,GACjBhC,IAAEe,KAAKF,EAAPb,CAAoByK,GAEhBA,EAAgB1H,OAAS,IAAM,EAC/B,OAAO0H,EAEX,IAAMQ,EAAeR,EAAgB3G,OACjC,SAACoH,GAAD,OAAQA,EAAE/J,YACZ6E,IAAI,SAACkF,GAAD,OAAOA,EAAEhL,KACTiL,EAAgBnJ,EAAS8B,OAAO,SAAC5D,GAAD,OAAQ+K,EAAatH,SAASzD,KAAK,GACnEkL,EACDD,EAECE,aAAc,SAACH,GAAD,OAAOA,EAAEhL,KAAOiL,GAAeV,GAI7CY,aAAc,SAACH,GAAD,OAAQA,EAAE/J,WAAWsJ,GAInCxG,GACkB,IAAnBmH,EACCX,EAAgB1H,OAAS,EACzBqI,EAEN,OAAOjC,YACHC,YAAUnF,GACVqB,YAAM,YAAY,GAClBmF,GAOD,SAASa,GAAsBb,GAElC,OADAzK,IAAEe,KAAKF,EAAPb,CAAoByK,GACbxD,YACHwB,mBACI,SAACvB,EAAGC,GAAJ,OAAUA,EAAE5F,MAAQ2F,EAAE3F,QACxB+G,OACE,SAACpB,EAAGC,GAAJ,OAAUA,EAAExG,OAASuG,EAAEvG,SAE3B8J,gcC7IFc,GAAa,SAACC,GAAD,OAAU,SAACC,GAAD,OACzBC,EAAAxE,EAAAyE,cAAA,OAAAvG,OAAAwG,OAAA,CACIC,wBAAyB,CAACC,OAAQN,EAAKO,KACvCC,aAAYR,EAAKS,MACjBC,KAAK,MACLC,MAAO,CAACC,KAAM,IAAMZ,EAAKa,MACrBZ,MAIGa,GAAA,CACXC,WACAC,eACAC,aACAC,iBACAC,WACAC,iBACAC,kBACAC,UACAC,UACAC,WAAYzB,GAAWyB,MACvBC,YACAC,UACAC,UACAC,MAAO7B,GAAW8B,MAClBC,YACAC,cACAC,WACAC,eACAC,cACAC,WACAC,+CCjDEC,GAAkB7N,IAAEO,UAAU,CAChCuN,MAAO9N,IAAE+N,MAEPC,GAAgBhO,IAAEO,UAAU,CAC9BL,GAAIF,IAAEL,SAEJsO,GAAgBjO,IAAEO,UAAU,CAC9B2N,KAAMlO,IAAE+N,MAENI,GAAmBnO,IAAEO,UAAU,CACjC0B,KAAMjC,IAAEL,SAENyO,GAAmBpO,IAAEO,UAAU,CACjCC,UAAWR,IAAEL,OACbc,SAAUT,IAAEL,OACZgB,OAAQX,IAAEF,SAERuO,GAAcrO,IAAEsO,MAAM,CACxBT,GACAG,GACAC,GACAG,GACAD,KAaW,SAASI,GAAiBT,EAAOU,GAC5CH,GAAYG,GACZ,IRjB6B7L,EQiBvB8L,EAAS7L,MACf,OAAQ4L,EAAO5N,MACf,IAAK,WAED,OADA8N,QAAQC,KAAK,+CACNrJ,YAAMmJ,EAAQD,EAAON,KAAMJ,GACtC,IAAK,cACD,OAAOxI,YACHmJ,GRxBqB9L,EQyBJ,CAACzC,GAAIuO,EAAQxM,KAAMuM,EAAOvM,MRxB5CF,EAAW,CACdC,SAAUW,EAAUX,UAAY,GAChC9B,GAAIyC,EAAUzC,IAAM0C,MACpBX,KAAMU,EAAUV,MAAQ,GACxBL,UAAWe,EAAUf,WAAa,GAClCM,UAAWS,EAAUT,WAAa,GAClCC,UAAWQ,EAAUR,WAAa,CAAC,EAAG,EAAG,EAAG,MQmBxC2L,GAER,IAAK,aACD,OAAOxI,YACHmJ,EACA5L,EAAa,CACTrC,UAAWgO,EAAOhO,UAClBN,GAAIuO,EACJhO,SAAU+N,EAAO/N,SACjBE,OAAQ6N,EAAO7N,SAEnBmN,GAER,IAAK,WAED,OAAOc,aAAOJ,EAAOtO,GAAI4N,GAC7B,IAAK,aACD,OAAOU,EAAOV,MAClB,QACI,MAAM,IAAIe,MAAM,2BAzCxBR,GAAYS,SAAW,SAAUC,GAQ7B,MAP0B,CACtBC,SAAYf,GACZgB,WAAcb,GACdc,YAAef,GACfgB,SAAYnB,GACZoB,WAAcvB,IAEOkB,EAAEnO,OCjC/B,IAAMiN,GAAkB7N,IAAEO,UAAU,CAChCuN,MAAO9N,IAAE+N,MAEPsB,GAAkBrP,IAAEO,UAAU,CAChC+O,OAAQtP,IAAEL,OACVP,MAAOY,IAAEsO,MAAM,CACXtO,IAAEF,OACFE,IAAEe,KAAKX,OAGTmP,GAAkBvP,IAAEO,UAAU,CAChCiF,KAAMpF,IAEJoP,GAAoBxP,IAAEO,UAAU,CAClCL,GAAIH,IAEFsO,GAAcrO,IAAEsO,MAAM,CACxBT,GACA0B,GACAC,KAaW,SAASC,GAAe3B,EAAOU,GAE1C,OADAH,GAAYG,GACJA,EAAO5N,MACf,IAAK,iBACD,OAAOuI,YACHuG,YAAS,cACTxG,YAAOsF,EAAOhJ,MACdsI,GAER,IAAK,iBACD,OAAO3E,YACHuG,YAAS,cACT5L,aAAO,SAAC0B,GAAD,QACHA,EAAK7B,SAAS6K,EAAOhJ,KAAK,KAAOA,EAAK7B,SAAS6K,EAAOhJ,KAAK,OAE/DsI,GAER,IAAK,mBAGD,OAAO3E,YACHuG,YAAS,cACT5L,aAAO,SAAC0B,GAAD,OAAWA,EAAK7B,SAAS6K,EAAOtO,MACvC4N,GAER,IAAK,aACD,OAAOxI,YACHkJ,EAAOc,OACPd,EAAOpP,MACP0O,GAER,IAAK,aACD,OAAOU,EAAOV,MAClB,QACI,MAAM,IAAIe,MAAM,4BA7CxBR,GAAYS,SAAW,SAAUC,GAQ7B,MAP0B,CACtBY,eAAkBJ,GAClBK,eAAkBL,GAClBM,iBAAoBL,GACpBJ,WAAcvB,GACdiC,WAAcT,IAEON,EAAEnO,yCCpBzBmP,GAAkB/P,IAAEO,UAAU,CAChCC,UAAWR,IAAEL,OACbO,GAAIH,EACJU,SAAUT,IAAEL,OACZe,WAAYV,IAAEF,OACda,OAAQX,IAAEF,SAERkQ,GAAkBhQ,IAAEO,UAAU,CAChCC,UAAWR,IAAEL,OACbc,SAAUT,IAAEL,OACZgB,OAAQX,IAAEF,SAERmQ,GAAkBjQ,IAAEO,UAAU,CAChCL,GAAIH,IAEFmQ,GAAsBlQ,IAAEO,UAAU,CACpCL,GAAIH,EACJW,WAAYV,IAAEF,SAEZqQ,GAAkBnQ,IAAEO,UAAU,CAChCL,GAAIH,EACJY,OAAQX,IAAEF,SAER+N,GAAkB7N,IAAEO,UAAU,CAACuN,MAAO9N,IAAE+N,MACxCM,GAAcrO,IAAEsO,MAAM,CACxByB,GACAC,GACAC,GACAC,GACAC,GACAtC,KAcW,SAASuC,GAAetC,EAAOU,GAC1CH,GAAYG,GACZ,IAAMC,EAAS7L,MACf,OAAQ4L,EAAO5N,MACf,IAAK,aACD,OAAO0E,YACHmJ,EACA5L,EAAa,CACTrC,UAAWgO,EAAOhO,UAClBN,GAAIuO,EACJhO,SAAU+N,EAAO/N,SACjBE,OAAQ6N,EAAO7N,SAEnBmN,GAER,IAAK,aACD,OAAO3E,YACHuG,YAASlB,EAAOtO,IAChBmQ,aACI,CACI7P,UAAWgO,EAAOhO,UAClBC,SAAU+N,EAAO/N,SACjBC,WAAY8N,EAAO9N,WACnBC,OAAQ6N,EAAO7N,SAGvBmN,GAER,IAAK,aAED,OAAOc,aACH0B,aAAS9B,EAAOtO,IAChB4N,GAER,IAAK,wBACD,OAAOyC,aACHD,aAAS,CAAC9B,EAAOtO,GAAI,eACrBsO,EAAO9N,WACPoN,GAER,IAAK,oBACD,OAAOyC,aACHD,aAAS,CAAC9B,EAAOtO,GAAI,WACrBsO,EAAO7N,OACPmN,GAER,IAAK,aACD,OAAOU,EAAOV,MAClB,QACI,MAAM,IAAIe,MAAM,2BA7DxBR,GAAYS,SAAW,SAAUC,GAS7B,MAR0B,CACtBE,WAAce,GACdQ,WAAcP,GACdb,WAAcvB,GACd4C,WAAcV,GACdW,sBAAyBR,GACzBS,kBAAqBR,IAEApB,EAAEnO,iFCvCxB,SAASgQ,GAAT1I,GAMJ,IALCpH,EAKDoH,EALCpH,UACA+P,EAID3I,EAJC2I,SACA3L,EAGDgD,EAHChD,QACAb,EAED6D,EAFC7D,QACAY,EACDiD,EADCjD,QAEAjF,IAAEe,KAAKX,EAAPJ,CAAkBc,GAClBd,IAAEF,OAAO+Q,GACT9O,EAAWkD,GACXjF,IAAEwD,KAAKzD,EAAIO,EAAXN,CAAmBkF,GACnBlF,IAAEF,OAAOuE,GACT,IAAMnC,EAAY+C,EAAQ/C,UACpB4O,ELiJK,SAAA5I,GAMZ,IALChD,EAKDgD,EALChD,QACAb,EAID6D,EAJC7D,QACAnC,EAGDgG,EAHChG,UACApB,EAEDoH,EAFCpH,UACAkB,EACDkG,EADClG,SAEAhC,IAAEF,OAAOuE,GACTrE,IAAEwD,KAAKzD,EAAIO,EAAXN,CAAmBkF,GACnBlF,IAAEe,KAAKf,IAAEF,OAATE,CAAiBgC,GACjBF,EAAUI,GACVlC,IAAEe,KAAKX,EAAPJ,CAAkBc,GAClB,IAAMc,EAAYwD,OAAOgD,KAAKlD,GACxBuF,EAAkBzD,YACpBhB,aAAI,SAAC9F,GAAD,OACAmJ,GAAkB,CACdvI,YACAZ,KACAgF,UACAb,UACAnC,gBAGRoJ,GACAd,GACAuG,aAAM/F,GAAN+F,CAAoB/O,GAZAgF,CAatBpF,GAEIoP,EAAmBvG,EAAgB3G,OACrC,SAACoH,GAAD,OAAQA,EAAE9J,WACZmD,OACE,SAAUC,EAAK2F,EAASS,EAAQC,GAC5B,IAAMoG,EAAgBpG,EAAI7E,IACtB,SAACoE,GAAD,MAAa,CACTxI,EAAUsC,QAAQiG,EAAQjK,IAC1B0B,EAAUsC,QAAQkG,EAAQlK,IAC1BgK,GAAcC,EAASC,MAG/B,OAAO5F,EAAIE,OAAOuM,IAEtB,IAOEC,EAFiBC,KAAQH,GAEOzM,OAClC,SAAUC,EAAK4M,EAASC,GAGpB,IAAiB,IAAbD,EAAgB,CAIhB,IAAME,EAAO1P,EAAUwP,GACjBG,EAAO3P,EAAUyP,GACjBG,EAAK/G,EAAgB3G,OAAO,SAACoH,GAAD,OAAOA,EAAEhL,KAAOoR,IAAM,GAClDG,EAAKhH,EAAgB3G,OAAO,SAACoH,GAAD,OAAOA,EAAEhL,KAAOqR,IAAM,GAMlDG,EAAUlN,EAAIwB,IAAI,SAACR,GAAD,OAAUA,EAAK,KACvC,IAAKkM,EAAQ/N,SAAS6N,KAAQE,EAAQ/N,SAAS8N,GAC3C,OAAOjN,EAAIE,OAAO,CAAC,CAAC8M,EAAIC,KAGhC,OAAOjN,GAEX,IAYE+E,EATgBtC,YAClBwB,mBAAQ,SAACkJ,EAAOC,GAAR,OACJA,EAAM,GAAGrQ,MAAQqQ,EAAM,GAAGrQ,MAAQoQ,EAAM,GAAGpQ,MAAQoQ,EAAM,GAAGpQ,QAC7D+G,OAAO,SAACqJ,EAAOC,GAAR,OACNA,EAAM,GAAGjR,OAASiR,EAAM,GAAGjR,OACzBgR,EAAM,GAAGhR,OAASgR,EAAM,GAAGhR,SAEjCuQ,GAE0BlL,IAC1B,SAAUR,GACN,IAAM2E,EAAU3E,EAAK,GACf4E,EAAU5E,EAAK,GACfxG,EAAQ,CAACmL,EAAQjK,GAAIkK,EAAQlK,IACnC,OAAIiK,EAAQnJ,aAAeoJ,EAAQpJ,aACxB6Q,aAAQ7S,GAEZA,IAIT8S,EAAYrH,EAAgB3G,OAAO,SAACoH,GAAD,OAAOA,EAAE9J,WAAU,GAC5D,OAAI0Q,EACOvI,EAAQ7E,OAAO,CAAC,CAACoN,EAAU5R,GAAIuC,KAEnC8G,EKrPOwI,CAAY,CACtBjR,UAAWA,EACXkB,SAAUiD,EAAQjD,SAClBkD,UACAb,UACAnC,cAEJwM,QAAQsD,IAAI,QAASlB,GACrBpC,QAAQsD,IAAI,UAAW9M,GACvB,IAAM+M,EAAY,SAAC/R,GAAD,OAAQoD,EAAe4B,EAAShF,IAgBlD,OAfqB4Q,EAAM9K,IACvB,SAACkM,GAAD,OACIxP,EAAY,CACRhB,UAAW,CACPuQ,EAAUC,EAAQ1P,IAAQ7B,OAC1BsR,EAAUC,EAAQ3P,IAAQ5B,QAE9BgB,WAAY,CACRsQ,EAAUC,EAAQ1P,IAAQ7B,OAC1BsR,EAAUC,EAAQ3P,IAAQ5B,QAE9BiB,UAAW,CAACsQ,EAAQ1P,GAAQ0P,EAAQ3P,QAI5BgC,OAEhB,SAAUC,EAAKxF,GACX,OAAIA,EAAM4C,UAAUY,KAAWC,EACpB+B,EAAIE,OAAO,CAACY,YAAM,SAAU,CAAC,EAAGuL,GAAW7R,KAElDA,EAAM4C,UAAUW,KAAWE,EACpB+B,EAAIE,OAAO,CAACY,YAAM,SAAU,CAACuL,EAAU,GAAI7R,KAE/CwF,EAAIE,OAAO,CAAC1F,KAEvB,IC1CR,IAAMmT,GAAiBnS,IAAEO,UAAU,IAC7B6R,GAAqBpS,IAAEO,UAAU,IACjC8R,GAA0BrS,IAAEO,UAAU,CACxCL,GAAIF,IAAEF,SAEJwS,GAAqBtS,IAAEO,UAAU,CACnCgS,SAAUvS,IAAEF,OACZ0S,SAAUxS,IAAEF,SAEV2S,GAA0BzS,IAAEO,UAAU,CACxCqB,UAAW5B,IAAEe,KAAKhB,KAEhB2S,GAAoB1S,IAAEO,UAAU,CAClCyB,SAAUhC,IAAEe,KAAKhB,KAEf4S,GAAiB3S,IAAEO,UAAU,CAC/BO,UAAWd,IAAEe,KAAKX,GAClByQ,SAAU7Q,IAAEF,OACZoF,QAASlF,IAAEwD,KAAKzD,EAAIO,GACpB+D,QAASrE,IAAEF,SAET8S,GAAmB5S,IAAEO,UAAU,CACjCsQ,SAAU7Q,IAAEF,OACZ0F,KAAMxF,IAAEK,MAAM,CAACC,EAAQA,IACvB+D,QAASrE,IAAEF,SAET+S,GAAuB7S,IAAEO,UAAU,CACrCuS,QAAS9S,IAAEL,OACX+B,UAAW1B,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,SAChC+B,OAAQ7B,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,SAC7BuE,QAASrE,IAAEF,SAETiT,GAAkB/S,IAAEO,UAAU,CAChCuS,QAAS9S,IAAEL,OACX0E,QAASrE,IAAEF,SAETkT,GAAkBhT,IAAEO,UAAU,CAChCgS,SAAUvS,IAAEF,OACZ0S,SAAUxS,IAAEF,OACZuE,QAASrE,IAAEF,SAET+N,GAAkB7N,IAAEO,UAAU,CAChCuN,MAAO9N,IAAE+N,MAEPM,GAAcrO,IAAEsO,MAAM,CACxB6D,GACAC,GACAC,GACAA,GACAC,GACAG,GACAC,GACAC,GACAC,GACAC,GACAE,GACAC,KAsBW,SAASC,GAAkBnF,EAAOU,GAE7C,OADAH,GAAYG,GACJA,EAAO5N,MACf,IAAK,YACD,OAAOuI,YACHuG,YAAS,aACTxG,YAAO,IACP4E,GAER,IAAK,iBACD,OAAO3E,YACHuG,YAAS,aACTwD,cAAQ,EAAG,GACXpF,GAER,IAAK,eACD,OAAO3E,YACHuG,YAAS,aACTxG,YAAOsF,EAAOtO,IACd4N,GAER,IAAK,eACD,OAAO3E,YACHuG,YAAS,aACT5L,aAAO,SAAC5D,GAAD,OAAQA,IAAOsO,EAAOtO,KAC7B4N,GAER,IAAK,gBACD,OAAO3E,YACHuG,YAAS,aACTyD,aAAK3E,EAAOgE,SAAUhE,EAAO+D,UAC7BzE,GAER,IAAK,sBACD,OAAOxI,YACH,YACAkJ,EAAO5M,UACPkM,GAER,IAAK,gBACD,OAAOxI,YACH,WACAkJ,EAAOxM,SACP8L,GAER,IAAK,YACD,OAAO3E,YACHmH,aAAS,CAAC,YAAa9B,EAAOnK,UAC9BK,aACI0O,KACAxC,GAAS,CACL9P,UAAW0N,EAAO1N,UAClB+P,SAAUrC,EAAOqC,SACjB3L,QAASsJ,EAAOtJ,QAChBb,QAASmK,EAAOnK,QAChBY,QAAS6I,KAGjBA,GAER,IAAK,cACD,OAAO3E,YACHmH,aAAS,CAAC,YAAa9B,EAAOnK,UAC9B6E,YD/FL,SAAoB1D,EAAMqL,GAC7B7Q,IAAEK,MAAM,CAACC,EAAQA,GAAjBN,CAA0BwF,GAC1B,IAAMxG,EAAQ0D,EAAY,CACtBhB,UAAW,CAAC8D,EAAKhD,GAAO7B,OAAQ6E,EAAKjD,GAAO5B,QAC5CgB,WAAY,CAAC6D,EAAKhD,GAAO7B,OAAQ6E,EAAKjD,GAAO5B,QAC7CiB,UAAW,CAAC4D,EAAKhD,GAAOtC,GAAIsF,EAAKjD,GAAOrC,MAE5C,OAAIsF,EAAKhD,GAAOtC,KAAOuC,EACZ6C,YAAM,SAAU,CAAC,EAAGuL,GAAW7R,GAEtCwG,EAAKjD,GAAOrC,KAAOuC,EACZ6C,YAAM,SAAU,CAACuL,EAAU,GAAI7R,GAEnCA,ECkFQqU,CAAW7E,EAAOhJ,KAAMgJ,EAAOqC,WACtC/C,GAER,IAAK,mBACD,OAAO9G,YACHuJ,aACID,aAAS,CACL,YACA9B,EAAOnK,QACPiP,aACIC,aAAO,KAAM/E,EAAOsE,SACpBhF,EAAM5L,UAAUsM,EAAOnK,UAE3B,WAEJmK,EAAO3M,QAEX0O,aACID,aAAS,CACL,YACA9B,EAAOnK,QACPiP,aACIC,aAAO,KAAM/E,EAAOsE,SACpBhF,EAAM5L,UAAUsM,EAAOnK,UAE3B,cAEJmK,EAAO9M,WAvBRsF,CAyBL8G,GACN,IAAK,YACD,OAAO3E,YACHmH,aAAS,CAAC,YAAa9B,EAAOnK,UAC9BP,aAAO,SAAC9E,GAAD,OAAWA,EAAMkB,KAAOsO,EAAOsE,UACtChF,GAER,IAAK,cACD,OAAO3E,YACHmH,aAAS,CACL,YACA9B,EAAOnK,QACPiP,aACIC,aAAO,KAAM/E,EAAOsE,SACpBhF,EAAM5L,UAAUsM,EAAOnK,YAG/B,SAACrF,GAAD,OAAWwU,aACPxU,EACA,CACI0C,UAAWmQ,aAAQ7S,EAAM0C,WACzBC,WAAYkQ,aAAQ7S,EAAM2C,YAC1BC,UAAWiQ,aAAQ7S,EAAM4C,WACzBC,OAAQgQ,aAAQ7S,EAAM6C,WAG9BiM,GAER,IAAK,aACD,OAAO3E,YACHmH,aAAS,CAAC,YAAa9B,EAAOnK,UAC9B8O,aAAK3E,EAAOgE,SAAUhE,EAAO+D,UAC7BzE,GAER,IAAK,YAED,OADAY,QAAQsD,IAAI,iBAAkBxD,EAAOV,OAC9BU,EAAOV,MAClB,QACI,MAAM,IAAIe,MAAM,0BAA4BL,EAAO5N,OAtJ3DyN,GAAYS,SAAW,SAAUN,GAiB7B,MAhB0B,CACtBiF,UAAatB,GACbuB,aAAgBrB,GAChBsB,UAAahB,GACbiB,eAAkBxB,GAClByB,UAAad,GACbe,aAAgBzB,GAChB0B,YAAenB,GACfoB,WAAchB,GACdiB,cAAiB3B,GACjB4B,cAAiBxB,GACjByB,iBAAoBtB,GACpBuB,UAAavG,GACbwG,oBAAuB5B,GACvB6B,YAAevB,IAEMvE,EAAO5N,uCC3FpCZ,IAAEwD,KAAKxD,IAAEL,OAAQoC,EAAjB/B,CAA6BuU,IAC7BvU,IAAEwD,KAAKzD,EAAIO,EAAXN,CAAmBkF,IAEJ,IAAAsP,GAAA,CACXC,WACAvP,WACAqP,iECAJG,2BAAkBC,MAClBC,2BAAqBD,MACrB,IACME,GAAeF,KAAYG,eAAe,CAC5C7S,KAFkB,gBAGlB8S,UAAW,YAETC,GAAcL,KAAYG,eAAe,CAC3C7S,KANkB,gBAOlB8S,UAAW,YAETE,GAAeN,KAAYG,eAAe,CAC5C7S,KAVkB,gBAWlB8S,UAAW,gBAef,SAASG,GAAkBC,GAAO,IAAAC,EACJC,qBAAW9G,GAAkB,IADzB+G,EAAAlQ,OAAAyD,EAAA,EAAAzD,CAAAgQ,EAAA,GACvBG,EADuBD,EAAA,GAChBxG,EADgBwG,EAAA,GAAAE,EAEEC,oBAAS,GAFXC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAEvBG,EAFuBD,EAAA,GAEbE,EAFaF,EAAA,GAgC9B,OA7BAG,oBACI,WACIV,EAAMW,WAAWC,KAAK,SAAUC,GAC5BtH,QAAQsD,IAAI,oBAAqBmD,EAAMc,QAAQlB,WAC/CjG,EAAS,CAAChB,MAAOkI,EAASpV,KAAM,eAChCgV,GAAY,MAGpB,CAACT,IAELU,oBACI,WACSF,IAGLR,EAAMe,SAASX,GAAOQ,KAAK,WACvBrH,QAAQsD,IAAI,iBAAkBmD,EAAMc,QAAQlB,aAEhDI,EAAM/M,OAAO2N,KAAK,SAAU3N,GACxB,IAAM+N,EAAUC,aAAWhO,EAAMhD,OAAOgD,KAAKmN,IACzCY,EAAQpT,OAAS,GACjBoS,EAAMkB,YAAYF,GAASJ,KAAK,WAC5BrH,QAAQsD,IAAI,WAAamE,EAAQpT,OAAS,iBAK1D,CAACoS,EAAOI,EAAOI,IAEZ,CAACJ,EAAOzG,GAMZ,SAASwH,KACZ,OAAOpB,GAAkBF,IAGtB,SAASuB,KACZ,OAAOrB,GAAkBD,IAMtB,SAASuB,KAAe,IAAAC,EACCpB,qBAAW5F,GAAgBiH,GAASjC,SADrCkC,EAAAvR,OAAAyD,EAAA,EAAAzD,CAAAqR,EAAA,GACpBhC,EADoBkC,EAAA,GACX7H,EADW6H,EAAA,GAAAC,EAEKnB,oBAAS,GAFdoB,EAAAzR,OAAAyD,EAAA,EAAAzD,CAAAwR,EAAA,GAEpBjB,EAFoBkB,EAAA,GAEVjB,EAFUiB,EAAA,GAsB3B,OAnBAhB,oBACI,WACIhB,GAAaiC,QAAQ,SAAU1X,EAAOiJ,GAClCyG,EAAS,CAACQ,OAAQjH,EAAKzH,KAAM,aAAcxB,MAAOA,MACnD2W,KAAK,WACJH,GAAY,MAGpB,IAEJC,oBACI,WACSF,GAGLd,GAAaqB,SAASzB,IAE1B,CAACA,EAASkB,IAEP,CAAClB,EAAS3F,iBC9FfiI,GAAoBC,wBAAc,MAEjC,SAASC,KAEZ,OADcC,qBAAWH,IAItB,SAASI,GAATjP,GAAmD,IAAtBkP,EAAsBlP,EAAtBkP,SAAUC,EAAYnP,EAAZmP,UAAYjC,EACnBC,qBAAWpC,GAAmB,IADXqC,EAAAlQ,OAAAyD,EAAA,EAAAzD,CAAAgQ,EAAA,GAC/CnQ,EAD+CqQ,EAAA,GACtCgC,EADsChC,EAAA,GAAAmB,EAEnBpB,qBAAWjF,GAAgB,IAFRuG,EAAAvR,OAAAyD,EAAA,EAAAzD,CAAAqR,EAAA,GAE/CvR,EAF+CyR,EAAA,GAEtCY,EAFsCZ,EAAA,GAAAnB,EAGRC,oBAAS,GAHDC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAG/CgC,EAH+C9B,EAAA,GAG9B+B,EAH8B/B,EAAA,GAAAkB,EAIRnB,oBAAS,GAJDoB,EAAAzR,OAAAyD,EAAA,EAAAzD,CAAAwR,EAAA,GAI/Cc,EAJ+Cb,EAAA,GAI9Bc,EAJ8Bd,EAAA,GAKtDhB,oBACI,WACIZ,GAAa2C,QAAQP,GAAWtB,KAAK,SAAU3W,GAC3CsP,QAAQsD,IAAI,UAAWqF,GACvBC,EAAgB,CAACxJ,MAAO1O,EAAOwB,KAAM,cACrC6W,GAAmB,MAG3B,CAACJ,IAELxB,oBACI,WACI,GAAK5Q,EAAQ/C,WAAc+C,EAAQrD,UAAnC,CAKA,IAAMiW,EAAYlT,EACdP,EAAea,EAAQ/C,YACzBwC,OACEO,EAAQrD,WAGZ,GAAyB,IAArBiW,EAAU9U,OAMV,OAJoC,IAAhCqC,OAAOgD,KAAKlD,GAASnC,QACrBwU,EAAgB,CAACzJ,MAAO,GAAIlN,KAAM,oBAEtC+W,GAAmB,GAGvB3C,GAAYc,SAAS+B,GAAW9B,KAAK,SAAU1Q,GAK3C,IAAMyS,EAAmBC,aACrB3S,OAAOgD,KAAK/C,GACZD,OAAOgD,KAAKlD,IAEhBwJ,QAAQsD,IAAI,qBAAsB8F,GACF,IAA5BA,EAAiB/U,SACjB2L,QAAQsD,IAAI,wBACZuF,EAAgB,CAACzJ,MAAOzI,EAAQzE,KAAM,gBAE1C+W,GAAmB,KACpBK,MAAM,SAAUC,GACfvJ,QAAQuJ,MAAM,qBAAsBJ,GACpCnJ,QAAQuJ,MAAMA,OAGtB,CAAChT,EAAQ/C,UAAWgD,EAASD,EAAQrD,YAEzCiU,oBACI,WACS2B,GAGLvC,GAAaiD,QAAQb,EAAWpS,GAAS+S,MAAM,SAAUC,GACrDvJ,QAAQsD,IAAI,wBAAyBqF,EAAWY,MAGxD,CAACZ,EAAWpS,EAASuS,IAEzB3B,oBACI,WACS6B,GAGL1C,GAAYkB,SAAShR,GAAS6Q,KAAK,SAAU1Q,GACzCqJ,QAAQsD,IAAI,8BAA+B3M,KAC5C2S,MAAM,SAAUC,GACfvJ,QAAQsD,IAAI,+BAAgCiG,MAGpD,CAAC/S,EAASwS,IAGd,OAAKF,GAAoBE,EAIrBhM,EAAAxE,EAAAyE,cAACoL,GAAkBoB,SAAnB,CACI/Y,MAAO,CACH6S,UAPM,SAAC/R,GAAD,OAAQoD,EAAe4B,EAAShF,IAQtCgF,UACAqS,kBACAtS,UACAqS,oBAGHF,GAZE1L,EAAAxE,EAAAyE,cAAA,yBC/FR,SAASyM,GAAiBnM,GAC7B4J,oBACI,WACI,IAAMwC,EAAYC,SAASrM,MAE3B,OADAqM,SAASrM,MAAQ,kBAAoBA,EAC9B,WACHqM,SAASrM,MAAQoM,IAGzB,CAACpM,ICRM,SAASsM,GAAW9M,GAAO,IAAA+M,EACTvB,KAAtBhS,EAD+BuT,EAC/BvT,QAASgN,EADsBuG,EACtBvG,UACT9P,EAAwB8C,EAAxB9C,UAAWD,EAAa+C,EAAb/C,UACZqH,EAAUnF,EAAelC,GACzBuW,EAAa,SAACvY,GAAD,OZoHO2D,EYpHsB0F,EZqHhDxJ,EADqCsD,EYpHoBnD,GZsHzDF,IAAEe,KAAKU,EAAPzB,CAAc6D,GACED,EAAmBP,EAAUQ,GAC9BU,OACX,SAAUC,EAAKxF,GACX,IAAMiH,EAAWjH,EAAM4C,UAAUkC,OAC7B,SAAC5D,GAAD,OAAQA,IAAOmD,IACjB,GACKxB,EAAUmC,EAAyBX,EAAUrE,GAA7C6C,OAKP,OAAOsH,YACHuG,YAASzJ,GACTe,YAAK0R,YAAU,GAAIzO,YAAIpI,IACvB2C,IAGR,IApBR,IAA8BX,EAAWR,GYxHCsF,EAKlBjB,GAAmBvF,EAAWD,GAA3C+F,EAL+B7C,OAAAyD,EAAA,EAAAzD,CAAAuD,EAAA,MAMhCgQ,EAAiB1Q,EAAU1D,OAC7B,SAACC,EAAD0D,GAAA,IAAOhI,EAAPgI,EAAOhI,GAAP,OAAeoF,YAAMpF,EAAIuY,EAAWvY,GAAKsE,IACzC,IAcJ,SAASoU,EAAgBvV,GAAU,IAAAwV,EZ8HvC,SAA+BhV,EAAWR,GACtCtD,EAAGsD,GACHrD,IAAEe,KAAKU,EAAPzB,CAAc6D,GACd,IAAM0F,EAAU3F,EAAmBP,EAAUQ,GACvCiV,EAAavP,EAAQ,GACrB5D,EAAYC,YAAK2D,GACvB,MAAO,CACHvF,EAAyBX,EAAUyV,GAAYnX,WAC/CqC,EAAyBX,EAAUsC,GAAWjE,WYlI1CqX,CAAsBxP,EAASlG,GAJJ2V,EAAA5T,OAAAyD,EAAA,EAAAzD,CAAAyT,EAAA,GAE3BI,EAF2BD,EAAA,GAG3BE,EAH2BF,EAAA,GAKzBG,EAASla,IAAQia,EAAaD,GAAa9Z,OAAO,MACxD,SAAAuF,OAAUwU,EAAV,SAAAxU,OAA4ByU,EAA5B,KAGJ,OACIzN,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAWjN,KAAMkN,OACpB3N,EAAAxE,EAAAyE,cAAA,6BACAD,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,kBACAD,EAAAxE,EAAAyE,cAAA,kBAECvG,OAAOgD,KAAKH,GAAWjC,IAAI,SAACsT,GAAD,OACxB5N,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKiR,GACJxZ,OAAOwZ,GAAQ,KAGxB5N,EAAAxE,EAAAyE,cAAA,mBACAD,EAAAxE,EAAAyE,cAAA,qBAGH1D,EAAUjC,IAAI,SAAC+C,EAAU9E,GAAX,OACXyH,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKpE,EAAOmV,UAAWjN,KAAMoN,KAC7B7N,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAWjN,KAAMmN,KAAME,MAAM,OAC5BvV,EAAQ,GAEbyH,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAWjN,KAAMsN,WAAYD,MAAM,OAClCvH,EAAUlJ,EAAS7I,IAAIM,UAD5B,OAEKyR,EAAUlJ,EAAS7I,IAAIO,UAG3BwH,EAAUjC,IAAI,SAACC,EAAUyT,GAAX,OACXhO,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKqR,EAAQN,UAAU,iBAhDnD,SAAmBO,EAAWC,GAC1B,GAAID,IAAcC,EACd,OAAOlO,EAAAxE,EAAAyE,cAACW,GAAMsB,EAAP,MAEX,IAAM/L,EAAS8W,EAAegB,GAAWC,GACzC,YAAe5W,IAAXnB,EACO,KAEJ5C,IAAQ4C,GAAQ1C,OAAO,OAyCL0a,CAAU9Q,EAAS7I,GAAI+F,EAAS/F,OAIzCwL,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,iBACTna,IAAQ8J,EAASxH,OAAOpC,OAAO,QAEpCuM,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,iBACTR,EAAgB7P,EAAS7I,4CCrD/C,SAAS4Z,GAATC,GAAkC,IAAlB3C,EAAkB2C,EAAlB3C,SAAUjL,EAAQ4N,EAAR5N,MAC7B,OACIT,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAWY,KAAOC,MAAO9N,MAAK/G,OAAA8U,GAAA,EAAA9U,CAAA,GAAM+G,IACpCiL,GASN,SAAS+C,GAAe1O,GAC3B,OACIC,EAAAxE,EAAAyE,cAAA,MAAAvG,OAAAwG,OAAA,GAASH,EAAT,CAAgB2N,UAAWY,KAAOI,SAC7B3O,EAAM2L,UA6CZ,SAASiD,GAASna,EAAIa,GACzB,OAAOA,EAAK+C,OAAO,SAACiL,GAAD,OAAOA,EAAE7O,KAAOA,IAAI,gBCtF5B,SAASoa,GAATpS,GAA+B,IAAX4G,EAAW5G,EAAX4G,SACzByL,EAAmB,CAAC/Z,UAAW,GAAIC,SAAU,GAAIE,OAAQ,MADrB6U,EAEAC,mBAAS8E,GAFT7E,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAEnCgF,EAFmC9E,EAAA,GAEpB+E,EAFoB/E,EAAA,GAWpCgF,EAAc,SAAUC,GAC1BA,EAAMC,iBAD2B,IAAAC,EAEXF,EAAMG,cAArB7Y,EAF0B4Y,EAE1B5Y,KAAM7C,EAFoByb,EAEpBzb,MACbqb,EAAiB,SAACM,GAAD,OAAezV,YAAMrD,EAAM7C,EAAO2b,MAGvD,OACIrP,EAAAxE,EAAAyE,cAAA,QAAMqP,SAdW,SAAUL,GAC3BA,EAAMC,iBAD4B,IAE3Bpa,EAA+Bga,EAA/Bha,UAAWC,EAAoB+Z,EAApB/Z,SAAUE,EAAU6Z,EAAV7Z,OAC5B8Z,EAAiBF,GACjBzL,EAAS,CAACtO,YAAWC,WAAUE,SAAQC,KAAM,iBAWzC8K,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,uCACAD,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,aAAf,cACAvP,EAAAxE,EAAAyE,cAAA,SACI1J,KAAK,YACLrB,KAAK,OACLxB,MAAOob,EAAcha,UACrB0a,UAAQ,EACRC,SAAUT,KAGlBhP,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,YAAf,aACAvP,EAAAxE,EAAAyE,cAAA,SACI1J,KAAK,WACLrB,KAAK,OACLxB,MAAOob,EAAc/Z,SACrBya,UAAQ,EACRC,SAAUT,KAGlBhP,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,UAAf,UACAvP,EAAAxE,EAAAyE,cAAA,SACI1J,KAAK,SACLrB,KAAK,SACLxB,MAAOob,EAAc7Z,OACrBua,UAAQ,EACRC,SAAUT,KAGlBhP,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAO/K,KAAK,SAASxB,MAAM,WCpDhC,SAASgc,GAAU3P,GAAO,IAAA+M,EACFvB,KAA5BhS,EAD8BuT,EAC9BvT,QAASqS,EADqBkB,EACrBlB,gBADqB+D,EAEC/E,KAFDgF,EAAAlW,OAAAyD,EAAA,EAAAzD,CAAAiW,EAAA,GAE9BnW,EAF8BoW,EAAA,GAErBC,EAFqBD,EAAA,GAIrC,SAASE,EAAab,GAClB,IAAMza,EAAKya,EAAMc,OAAOrc,MACpBub,EAAMc,OAAOC,QACbpE,EAAgB,CACZ1V,UAAWqD,EAAQrD,UAAU8C,OAAO,CAACxE,IACrCU,KAAM,wBAGV0W,EAAgB,CACZ1V,UAAWqD,EAAQrD,UAAUkC,OAAO,SAAC6X,GAAD,OAASA,IAAQzb,IACrDU,KAAM,wBAKlB,OACI8K,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVwC,QAAS,kBAAMtE,EAAgB,CAC3B1V,UAAWwD,OAAOgD,KAAKlD,GACvBtE,KAAM,0BAJd,cASA8K,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVwC,QAAS,kBAAMtE,EAAgB,CAC3B1V,UAAW,GACXhB,KAAM,0BAJd,eASA8K,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,iCACAD,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,wBACAD,EAAAxE,EAAAyE,cAAA,uBACAD,EAAAxE,EAAAyE,cAAA,sBAGRD,EAAAxE,EAAAyE,cAAA,aACKvG,OAAOC,OAAOH,GAASc,IAAI,SAAAkC,GAAA,IAAEhI,EAAFgI,EAAEhI,GAAIM,EAAN0H,EAAM1H,UAAWC,EAAjByH,EAAiBzH,SAAjB,OACxBiL,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKnI,GACLwL,EAAAxE,EAAAyE,cAAA,UAAKnL,GACLkL,EAAAxE,EAAAyE,cAAA,UAAKlL,GACLiL,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,SACI+P,QAASzW,EAAQrD,UAAU+B,SAASzD,GACpCU,KAAK,WACLxB,MAAOc,EACPib,SAAUK,UAOlC9P,EAAAxE,EAAAyE,cAAC2O,GAAD,CAAWxL,SAAUyM,KC7DlB,SAASM,GAAapQ,GAAO,IAAA+M,EACIvB,KAArChS,EADiCuT,EACjCvT,QAASqS,EADwBkB,EACxBlB,gBAAiBpS,EADOsT,EACPtT,QAC1BtD,EAAkCqD,EAAlCrD,UAAWM,EAAuB+C,EAAvB/C,UAAWF,EAAYiD,EAAZjD,SACvB8M,EAAWwI,EAHuB9B,EAIFC,mBAA8B,IAArB7T,EAAUmB,QAJjB2S,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAIjCsG,EAJiCpG,EAAA,GAIpBqG,EAJoBrG,EAAA,GAKlCnM,EAAUnF,EAAelC,GAC/B,OACIwJ,EAAAxE,EAAAyE,cAACwO,GAAD,KACIzO,EAAAxE,EAAAyE,cAACmO,GAAD,KACIpO,EAAAxE,EAAAyE,cAAA,UAAQiQ,QAAS,kBAAMG,GAAe,KAClCrQ,EAAAxE,EAAAyE,cAACW,GAAMQ,KAAP,MADJ,uBAGApB,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,iCACAD,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,MAAIqQ,QAAS,GAAb,QACAtQ,EAAAxE,EAAAyE,cAAA,uBAGRD,EAAAxE,EAAAyE,cAAA,aACKvG,OAAOC,OAAOH,GAASc,IACpB,SAAAkC,GAAA,IAAEtH,EAAFsH,EAAEtH,KAAMV,EAARgI,EAAQhI,GAAIM,EAAZ0H,EAAY1H,UAAWC,EAAvByH,EAAuBzH,SAAvB,OACIiL,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKnI,EAAIkZ,UAAWxY,EAAO,WAC3B8K,EAAAxE,EAAAyE,cAAA,UAAKnL,GACLkL,EAAAxE,EAAAyE,cAAA,UAAKlL,GACLiL,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACIsQ,SAAUja,EAAS2B,SAASzD,GAC5B0b,QAAS,kBACL9M,EAAS,CACL9M,SACIA,EAAS0C,OAAO,CAACxE,IACrBU,KAAM,oBANlB,qBAmB5B8K,EAAAxE,EAAAyE,cAACmO,GAAD,KACIpO,EAAAxE,EAAAyE,cAAA,uBACqB,IAApB3J,EAASe,QACN2I,EAAAxE,EAAAyE,cAAA,uDAEJD,EAAAxE,EAAAyE,cAAA,UACK3J,EAASgE,IAAI,SAAC2V,GAAD,OACVjQ,EAAAxE,EAAAyE,cAAA,MACItD,IAAKsT,EACLvC,UACKjY,GAAUwa,EAAKpS,GACd,WACA,IAGLrE,EAAQyW,GAAKnb,UAAW,IACxB0E,EAAQyW,GAAKlb,SACdiL,EAAAxE,EAAAyE,cAAA,UACIiQ,QAAS,kBACL9M,EAAS,CACL9M,SAAUA,EAAS8B,OACf,SAAC5D,GAAD,OAAQyb,IAAQzb,IAEpBU,KAAM,oBANlB,eAgBhB8K,EAAAxE,EAAAyE,cAACuQ,GAAA,EAAD,CAAQC,OAAQL,GACZpQ,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,uBACVwC,QAAS,kBAAMG,GAAe,KAFlC,QAMArQ,EAAAxE,EAAAyE,cAACyP,GAAD,qBCxFD,SAASgB,GAATlU,GAAyC,IAApB7E,EAAoB6E,EAApB7E,SAAUgB,EAAU6D,EAAV7D,QAAUmU,EACzBvB,KAApBhS,EAD6CuT,EAC7CvT,QAASC,EADoCsT,EACpCtT,QADoCmX,EAElC7F,KAFkC8F,EAWhDjT,GAAkB,CAClBvI,UAZgDsE,OAAAyD,EAAA,EAAAzD,CAAAiX,EAAA,MAY7BE,WACnBrc,GAAImD,EACJ6B,UACAb,UACAnC,UAAW+C,EAAQ/C,YAZnBZ,EAJgDgb,EAIhDhb,QACAX,EALgD2b,EAKhD3b,OACAY,EANgD+a,EAMhD/a,MACAP,EAPgDsb,EAOhDtb,aACAG,EARgDmb,EAQhDnb,UACAE,EATgDib,EAShDjb,gBACAP,EAVgDwb,EAUhDxb,UAQE0b,EACExb,EAAe,EACR,UAAYzB,KAAKgL,IAAIvJ,GACrBA,EAAe,EACf,UAAYA,EAEZ,OAGf,OACI0K,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,eACV1N,EAAAxE,EAAAyE,cAAA,UACKrK,EAAQd,UADb,IACyBc,EAAQb,UAEjCiL,EAAAxE,EAAAyE,cAAA,mBAAWpK,GACXmK,EAAAxE,EAAAyE,cAAA,oBAAYhL,GACZ+K,EAAAxE,EAAAyE,cAAA,2BAAmB6Q,GACnB9Q,EAAAxE,EAAAyE,cAAA,iCAAyBxK,EAAY,MAAQ,MAC7CuK,EAAAxE,EAAAyE,cAAA,8BACAD,EAAAxE,EAAAyE,cAAA,UACKtK,EAAgB2E,IAAI,SAACyW,GAAD,OACjB/Q,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKoU,GACJvX,EAAQuX,GAAMjc,UAAW,IACzB0E,EAAQuX,GAAMhc,aAI3BiL,EAAAxE,EAAAyE,cAAA,8BAGAD,EAAAxE,EAAAyE,cAAA,UACK7K,EAAUkF,IAAI,SAAC2V,GAAD,OACXjQ,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKsT,GACJzW,EAAQyW,GAAKnb,UADlB,IAC8B0E,EAAQyW,GAAKlb,2BChDhD,SAASic,GAATxU,GAAgE,IAA3C7D,EAA2C6D,EAA3C7D,QAASsY,EAAkCzU,EAAlCyU,cAAeC,EAAmB1U,EAAnB0U,iBAAmBpE,EAChDvB,KAApBhS,EADoEuT,EACpEvT,QAASC,EAD2DsT,EAC3DtT,QAEV2X,EAAaxY,IAAYY,EAAQ/C,UAAUa,OAAS,EACpDiC,EAAaC,EAASC,EAASb,GAC/B,GAeN,IAAMyY,EAAiB1X,OAAOgD,KAAKyU,GAAW9Z,OAGxCga,EACDD,EAAiB,IAAM,EACtBxX,YAAM7C,EAAUQ,EAAa4Z,GAC7BA,EAEN,OAAuB,IAAnBC,EACO,KAGPpR,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,UACKvG,OAAOC,OAAO0X,GAAoB/W,IAC/B,SAAAsD,GAAA,IAAEpJ,EAAFoJ,EAAEpJ,GAAIM,EAAN8I,EAAM9I,UAAWC,EAAjB6I,EAAiB7I,SAAjB,OACIiL,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKnI,GACLwL,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACV6C,UACKU,EAAchZ,SAAS,OACrBgZ,EAAchZ,SAASzD,GAE9B0b,QAAS,kBApCrC,SAAsB1b,GACW,OAAzByc,EAAcna,GACdoa,EACI,SAAC7B,GAAD,OAAexK,aAAInH,YAAU5G,GAAQtC,EAAI6a,KAEb,OAAzB4B,EAAcpa,IACrBqa,EACI,SAAC7B,GAAD,OAAexK,aAAInH,YAAU7G,GAAQrC,EAAI6a,KA6BViC,CAAa9c,KAE5BwL,EAAAxE,EAAAyE,cAACW,GAAMoB,SAAP,MACAhC,EAAAxE,EAAAyE,cAACsR,GAAA,EAAD,eACYzc,EADZ,IACwBC,IAG3B,IACAD,EAfL,IAeiBC,OCrD1B,SAASyc,GAAThV,GAIZ,IAHC7D,EAGD6D,EAHC7D,QACAsY,EAEDzU,EAFCyU,cACAC,EACD1U,EADC0U,iBACDpE,EACoCvB,KAA5BK,EADRkB,EACQlB,gBAAiBpS,EADzBsT,EACyBtT,QAClB4J,EAAWwI,EAFlB+E,EAGmB7F,KAAX/B,EAHRrP,OAAAyD,EAAA,EAAAzD,CAAAiX,EAAA,MAAAc,EAAA/X,OAAAyD,EAAA,EAAAzD,CAIwBuX,EAJxB,GAIQS,EAJRD,EAAA,GAIeE,EAJfF,EAAA,GAMC,SAASG,EAAQnZ,GACbyY,EAAiB,SAAC7B,GAAD,OAAexK,aAAInH,YAAUjF,GAAQ,KAAM4W,KAahE,OACIrP,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,oCACAD,EAAAxE,EAAAyE,cAAA,kBACW,IACI,OAAVyR,GACG1R,EAAAxE,EAAAyE,cAAC4R,EAAA,SAAD,KACKrY,EAAQkY,GAAO5c,UAAW,IAC1B0E,EAAQkY,GAAO3c,SAAU,IAC1BiL,EAAAxE,EAAAyE,cAAA,UAAQiQ,QAAS,kBAAM0B,EAAQ9a,KAC3BkJ,EAAAxE,EAAAyE,cAACW,GAAMmB,UAAP,MADJ,aAMZ/B,EAAAxE,EAAAyE,cAAA,kBACW,IACI,OAAV0R,GACG3R,EAAAxE,EAAAyE,cAAC4R,EAAA,SAAD,KACKrY,EAAQmY,GAAO7c,UAAW,IAC1B0E,EAAQmY,GAAO5c,SAAU,IAC1BiL,EAAAxE,EAAAyE,cAAA,UAAQiQ,QAAS,kBAAM0B,EAAQ/a,KAC3BmJ,EAAAxE,EAAAyE,cAACW,GAAMmB,UAAP,MADJ,aAMZ/B,EAAAxE,EAAAyE,cAAA,UACIsQ,SACIU,EAAca,MAAM,SAACtd,GAAD,OAAe,OAAPA,IAEhC0b,QAAS,kBAAMgB,EACX,SAAC7B,GAAD,MAAgB,CAACA,EAAUxY,GAAQwY,EAAUvY,QAGjDkJ,EAAAxE,EAAAyE,cAACW,GAAMgB,OAAP,MARJ,gBASU,IACV5B,EAAAxE,EAAAyE,cAAA,UACIsQ,SAAUU,EAAchZ,SAAS,MACjCiY,QAjDZ,WACI9M,EAAS,CACL+B,SAAU4D,EAAQ5D,SAClBrL,KAAM,CAACN,EAAQkY,GAAQlY,EAAQmY,IAC/BhZ,UACAzD,KAAM,gBAEVgc,EAAiB,CAAC,KAAM,SA4ChBlR,EAAAxE,EAAAyE,cAACW,GAAMK,MAAP,MAJJ,mBAKU,KCpDP,SAAS8Q,GAATvV,GAA+B,IAAV7D,EAAU6D,EAAV7D,QAAUmR,EACAC,mBAAS,CAAC,KAAM,OADhBC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GACnCmH,EADmCjH,EAAA,GACpBkH,EADoBlH,EAAA,GAAA2G,EAExB7F,KAAX/B,EAFmCrP,OAAAyD,EAAA,EAAAzD,CAAAiX,EAAA,MAAA7D,EAGEvB,KAArChS,EAHmCuT,EAGnCvT,QAASC,EAH0BsT,EAG1BtT,QAASoS,EAHiBkB,EAGjBlB,gBAHiBV,EAIJnB,oBAAS,GAJLoB,EAAAzR,OAAAyD,EAAA,EAAAzD,CAAAwR,EAAA,GAInC8G,EAJmC7G,EAAA,GAItB8G,EAJsB9G,EAAA,GAKpC+G,EAAYxQ,IAAMyQ,QACpB,kBACI7W,YACI5B,OAAOC,OACPW,aAAI,SAACvC,GAAD,OACA4F,GAAkB,CACdvI,UAAW2T,EAAQ8H,WACnBrc,GAAIuD,EAAOvD,GACXgF,UACAb,UACAnC,UAAW+C,EAAQ/C,cAG3BoJ,GACAd,GAZJxD,CAaE9B,IAEN,CACID,EAAQ/C,UACRmC,EACAoQ,EAAQ8H,WACRrX,IAGF4Y,EAAa1Q,IAAMyQ,QACrB,WACI,GAAIlB,EAAchZ,SAAS,MACvB,OAAO,KAEX,IAEMoa,EAAQ7T,GAFOmQ,GAASsC,EAAc,GAAIiB,GAC3BvD,GAASsC,EAAc,GAAIiB,IAEhD,OAAO3e,IAAQ8e,EAAQ/T,IAAa7K,OAAO,MAE/C,CAACwd,EAAeiB,IAEdf,EAAaxY,IAAYY,EAAQ/C,UAAUa,OAAS,EACpDiC,EAAaC,EAASC,EAASb,GAC/B,GACAyY,EAAiB1X,OAAOgD,KAAKyU,GAAW9Z,OAC9C,OACI2I,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAU,WACX1N,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,iBACV6C,SAA6B,IAAnBa,EACVlB,QAAS,kBAAMtE,EAAgB,CAC3BxW,UAAW2T,EAAQ8H,WACnB1L,SAAU4D,EAAQ5D,SAClB3L,QAAS2X,EACTxY,UACAzD,KAAM,gBARd,+BAYU,IACV8K,EAAAxE,EAAAyE,cAAA,UAAQiQ,QAAS,kBAAM+B,GAAe,KAAtC,2CAIJjS,EAAAxE,EAAAyE,cAACwO,GAAD,KACIzO,EAAAxE,EAAAyE,cAACmO,GAAD,KACIpO,EAAAxE,EAAAyE,cAAC+Q,GAAD,CACIrY,QAASA,EACTuY,iBAAkBA,EAClBD,cAAeA,KAGvBjR,EAAAxE,EAAAyE,cAACmO,GAAD,KACIpO,EAAAxE,EAAAyE,cAACuR,GAAD,CACI7Y,QAASA,EACTuY,iBAAkBA,EAClBD,cAAeA,IAEnBjR,EAAAxE,EAAAyE,cAACwO,GAAD,KACKwC,EAAc3W,IAAI,SAAC9F,GAAD,OACR,OAAPA,GACIwL,EAAAxE,EAAAyE,cAACmO,GAAD,CAAOzR,IAAKnI,GACRwL,EAAAxE,EAAAyE,cAACyQ,GAAD,CACI/Y,SAAUnD,EACVmE,QAASA,QAZjC,gBAkBkByZ,IAGtBpS,EAAAxE,EAAAyE,cAACuQ,GAAA,EAAD,CAAQC,OAAQuB,GACZhS,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVwC,QAAS,kBAAM+B,GAAe,KAFlC,QAMAjS,EAAAxE,EAAAyE,cAACyP,GAAD,eCnHD,SAAS4C,GAAT9V,GAAoD,IAA1B4K,EAA0B5K,EAA1B4K,QAAS3O,EAAiB+D,EAAjB/D,MAAOE,EAAU6D,EAAV7D,QAAUmU,EACzBvB,KAA/BhS,EADwDuT,EACxDvT,QAASC,EAD+CsT,EAC/CtT,QAAS+M,EADsCuG,EACtCvG,UACnBpO,EAAYoB,EAAQ/C,UAAUmC,GAF2BgY,EAG7C7F,KAAX/B,EAHwDrP,OAAAyD,EAAA,EAAAzD,CAAAiX,EAAA,MAIzDrd,EAAQqb,GAASvH,EAASjP,GAC1Boa,EAAa5U,GAAkB,CACjCvI,UAAW2T,EAAQ8H,WACnBrc,GAAIlB,EAAM4C,UAAUuC,GACpBe,UACAb,UACAnC,UAAW+C,EAAQ/C,YAEjBlB,EAAeid,EAAWjd,aAC1Bwb,EACExb,EAAe,EACR,UAAYzB,KAAKgL,IAAIvJ,GACrBA,EAAe,EACf,UAAYA,EAEZ,OAGf,OACI0K,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,eACV1N,EAAAxE,EAAAyE,cAAA,UACKsS,EAAW3c,QAAQd,UADxB,IACoCyd,EAAW3c,QAAQb,UAEvDiL,EAAAxE,EAAAyE,cAAA,mBACAD,EAAAxE,EAAAyE,cAAA,UAAKsS,EAAW1c,OAChBmK,EAAAxE,EAAAyE,cAAA,oBACAD,EAAAxE,EAAAyE,cAAA,MAAIuS,cAAA,UAAAxZ,OAAuBuZ,EAAW/d,KACjClB,EAAM2C,WAAWwC,GADtB,KAEKlF,IACGD,EAAM0C,UAAUyC,GAASnF,EAAM2C,WAAWwC,IAC5ChF,OAAO,MAJb,KAOAuM,EAAAxE,EAAAyE,cAAA,2BACAD,EAAAxE,EAAAyE,cAAA,UAAK6Q,GACL9Q,EAAAxE,EAAAyE,cAAA,iCACAD,EAAAxE,EAAAyE,cAAA,UAAKsS,EAAW9c,UAAY,MAAQ,MACpCuK,EAAAxE,EAAAyE,cAAA,8BACAD,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACKsS,EAAW5c,gBAAgB2E,IAAI,SAACyW,GAAD,OAC5B/Q,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKoU,GACJxK,EAAUwK,GAAMjc,UAAW,IAC3ByR,EAAUwK,GAAMhc,uCCzC9B,SAAS0d,GAATjW,GAMZ,IALCkW,EAKDlW,EALCkW,IACApf,EAIDkJ,EAJClJ,MACAqF,EAGD6D,EAHC7D,QACAga,EAEDnW,EAFCmW,cACAC,EACDpW,EADCoW,iBACD9F,EAOKvB,KALAhS,EAFLuT,EAEKvT,QACAqS,EAHLkB,EAGKlB,gBACApS,EAJLsT,EAIKtT,QACA+M,EALLuG,EAKKvG,UACAsF,EANLiB,EAMKjB,gBAEEzI,EAAWwI,EARlB9B,EASmCC,oBAAS,GAT5CC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GASQ+I,EATR7I,EAAA,GASmB8I,EATnB9I,EAAA,GAUO+I,EACEzf,EAAM6C,OAAO,GAAK7C,EAAM6C,OAAO,GACxB,QACA7C,EAAM6C,OAAO,GAAK7C,EAAM6C,OAAO,GAC/B,QACA7C,EAAM6C,OAAO2b,MAAM,SAACzO,GAAD,MAAa,KAANA,IAC1B,OAEA,SAGT2P,EAAczM,EAAUjT,EAAM4C,UAAUY,IACxCmc,EAAc1M,EAAUjT,EAAM4C,UAAUW,IACxCqc,EAAYF,EAAYle,UAAY,IAAMke,EAAYje,SACtDoe,EAAYF,EAAYne,UAAY,IAAMme,EAAYle,SAE5D,SAASqe,EAAenE,GACpB,IAAM9Y,EAAU,WACZ,OAAQ8Y,EAAMc,OAAOrc,OACrB,IAAK,QACD,MAAO,CAAC,EAAG,GACf,IAAK,QACD,MAAO,CAAC,EAAG,GACf,IAAK,OACD,MAAO,CAAC,GAAK,IACjB,IAAK,SACD,MAAO,CAAC,EAAG,GACf,QACI,MAAM,IAAIyP,OAXF,GAcVuO,EAAQlY,EAAQlG,EAAM4C,UAAUY,IAChC6a,EAAQnY,EAAQlG,EAAM4C,UAAUW,IAChCb,EAC6B,WAA9BiZ,EAAMG,cAAc1b,MACnBJ,EAAM2C,WzBvDb,SAAwBod,EAAaC,EAAand,GACrD7B,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,QAArBE,CAA8B+e,GAC9B/e,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,QAArBE,CAA8Bgf,GAC9Bhf,IAAEK,MAAM,CAACL,IAAEF,OAAQE,IAAEF,QAArBE,CAA8B6B,GAC9B,IAAMod,EAAW,IAAIC,IAAQ/b,EAAQ6b,EAAYxc,KAC3C2c,EAAW,IAAID,IAAQ/b,EAAQ6b,EAAYzc,KAE3C6c,EAAgB,CAClBH,EAASI,YAAYN,EAAYvc,GAAQuc,EAAYxc,IACrD4c,EAASE,YAAYN,EAAYxc,GAAQwc,EAAYvc,KAczD,MAZkB,CACdyc,EAASK,aACLF,EAAc5c,GACdX,EAAOW,GACPuc,EAAYvc,IAEhB2c,EAASG,aACLF,EAAc7c,GACdV,EAAOU,GACPwc,EAAYxc,KAGHyD,IAAI,SAACrF,GAAD,OAAaA,EAjBpB,QAiB8CA,IyBiClD4e,CACEvgB,EAAM2C,WACN,CAACyb,EAAM1c,WAAY2c,EAAM3c,YACzBmB,GAGR0V,EAAgB,CACZrX,GAAIkd,EAAMld,GACVS,OAAQe,EAAUc,GAClB5B,KAAM,sBAEV2W,EAAgB,CACZrX,GAAImd,EAAMnd,GACVS,OAAQe,EAAUa,GAClB3B,KAAM,sBAGmC,IAAzC5B,EAAM6C,OAAO0C,OAAO,SAAC2C,EAAGC,GAAJ,OAAUD,EAAIC,MAClCoQ,EAAgB,CACZrX,GAAIkd,EAAMld,GACVQ,WAAY0c,EAAM1c,WAAa,EAC/BE,KAAM,0BAEV2W,EAAgB,CACZrX,GAAImd,EAAMnd,GACVQ,WAAY2c,EAAM3c,WAAa,EAC/BE,KAAM,2BAGdkO,EAAS,CACLgE,QAAS9T,EAAMkB,GACfwB,YACAG,SACAwC,UACAzD,KAAM,qBAId,OACI8K,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAWpa,EAAMkB,KAAOme,EAAgB,WAAa,IACrD3S,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,wBAAwBI,MAAM,OAAO4E,EAAM,GACzD1S,EAAAxE,EAAAyE,cAAA,MACIyN,UAAW,6BAA+BsF,EAAY9d,KACtDsd,cAAA,SAAAxZ,OAAsB0Z,EAAtB,WAECQ,EAAW,IACI,UAAfH,GACG/S,EAAAxE,EAAAyE,cAAA,QAAMO,KAAK,MAAMsT,eAAA,GAAjB,iBAKR9T,EAAAxE,EAAAyE,cAAA,MACIyN,UAAW,6BAA+BuF,EAAY/d,KACtDsd,cAAA,SAAAxZ,OAAsB0Z,EAAtB,WAECS,EAAW,IACI,UAAfJ,GACG/S,EAAAxE,EAAAyE,cAAA,QAAMO,KAAK,MAAMsT,eAAA,GAAjB,iBAKR9T,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,6BACV1N,EAAAxE,EAAAyE,cAAA,UACIyN,UAAWqG,gBACXxD,SAAUjd,EAAM4C,UAAU+B,SAASlB,GACnCrD,MAAOqf,EACPiB,OAAQZ,EACR3D,SAAU2D,GAEVpT,EAAAxE,EAAAyE,cAAA,UAAQvM,MAAM,UAAd,mBAGAsM,EAAAxE,EAAAyE,cAAA,UAAQvM,MAAM,SACTwf,EADL,QAGAlT,EAAAxE,EAAAyE,cAAA,UAAQvM,MAAM,SACTyf,EADL,QAGAnT,EAAAxE,EAAAyE,cAAA,UAAQvM,MAAM,QAAd,UAKRsM,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,6BACRiF,IAAkBrf,EAAMkB,GAEtBwL,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVnN,MAAM,aACN2P,QAAS,kBAAM0C,EAAiBtf,EAAMkB,MAEtCwL,EAAAxE,EAAAyE,cAACW,GAAMQ,KAAP,OAGJpB,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVnN,MAAM,oBACN2P,QAAS,kBAAM0C,EAAiB,QAEhC5S,EAAAxE,EAAAyE,cAACW,GAAMK,MAAP,OAGRjB,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVnN,MAAM,0BACN2P,QAAS,kBAAM4C,GAAa,KAE5B9S,EAAAxE,EAAAyE,cAACW,GAAMS,KAAP,MACArB,EAAAxE,EAAAyE,cAACsR,GAAA,EAAD,mCACgC,IAC3B2B,EAFL,WAEwBC,IAG5BnT,EAAAxE,EAAAyE,cAACuQ,GAAA,EAAD,CAAQC,OAAQoC,GACZ7S,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,uBACVwC,QAAS,kBAAM4C,GAAa,KAFhC,SAMA9S,EAAAxE,EAAAyE,cAAA,SAAI1G,EAAQhD,MACZyJ,EAAAxE,EAAAyE,cAAA,kBAAUtH,EAAU,EAApB,WAA+B+Z,EAAM,GACrC1S,EAAAxE,EAAAyE,cAACwO,GAAD,KACIzO,EAAAxE,EAAAyE,cAACmO,GAAD,KACIpO,EAAAxE,EAAAyE,cAACqS,GAAD,CACI7Z,MAAO,EACP2O,QAAS9T,EAAMkB,GACfmE,QAASA,KAGjBqH,EAAAxE,EAAAyE,cAACmO,GAAD,KACIpO,EAAAxE,EAAAyE,cAACqS,GAAD,CACI7Z,MAAO,EACP2O,QAAS9T,EAAMkB,GACfmE,QAASA,SCjM1B,SAASsb,GAATzX,GAA0B,IAAV7D,EAAU6D,EAAV7D,QAAUmU,EAMjCvB,KAJAhS,EAFiCuT,EAEjCvT,QACAC,EAHiCsT,EAGjCtT,QACAoS,EAJiCkB,EAIjClB,gBACAC,EALiCiB,EAKjCjB,gBAEE1T,EAAYoB,EAAQ/C,UAAUmC,GAPCmR,EAQKC,mBAAS,MARdC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAQ9B6I,EAR8B3I,EAAA,GAQf4I,EARe5I,EAAA,GASrC,IAAK7R,EACD,MAAM,IAAIgL,MAAM,SAAWxK,EAAU,oBA4BzC,SAASub,EAAU9M,EAAS+M,GACxB,IV8CsB3f,EAAIa,EU9CpByR,GV8CgBtS,EU9CS4S,GV8CL/R,EU9Cc8C,GV+ChCK,QAAQmW,GAASna,EAAIa,KU7C7BuW,EAAgB,CAAC/E,SADCC,EAAWqN,GAAa,EAAKrN,EAAWqN,EAAY,EAC3CrN,WAAUnO,UAASzD,KAAM,eAGxD,OACI8K,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAU,WACX1N,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,oBACV6C,SAA4B,OAAlBoC,EACVzC,QAAS,kBAtCzB,SAAiB9I,GACb,IAAM9T,EAAQqb,GAASvH,EAASjP,GACa,IAAzC7E,EAAM6C,OAAO0C,OAAO,SAAC2C,EAAGC,GAAJ,OAAUD,EAAIC,KAGlCnI,EAAM4C,UAAUke,QAAQ,SAAUnE,EAAKxX,GACnCoT,EAAgB,CACZrX,GAAIyb,EACJjb,WAAYwE,EAAQyW,GAAKjb,WAAa,EACtCE,KAAM,0BAEV2W,EAAgB,CACZrX,GAAIyb,EACJhb,OAAQ3B,EAAM2C,WAAWwC,GACzBvD,KAAM,wBAIlB0W,EAAgB,CAACxE,UAASzO,UAASzD,KAAM,cACzC0d,EAAiB,MAmBUyB,CAAQ1B,KAEvB3S,EAAAxE,EAAAyE,cAACW,GAAMkB,MAAP,MALJ,YAMU,IACV9B,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,aACV6C,SAA4B,OAAlBoC,EACVzC,QAAS,WAtBrBtE,EAAgB,CAACxE,QAsBqBuL,EAtBZha,UAASzD,KAAM,kBAwB7B8K,EAAAxE,EAAAyE,cAACW,GAAMgB,OAAP,MALJ,gBAMU,IACV5B,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,aACV6C,SAA4B,OAAlBoC,EACVzC,QAAS,kBAAMgE,EAAUvB,GAAgB,KAEzC3S,EAAAxE,EAAAyE,cAACW,GAAMG,QAAP,MALJ,YAMU,IACVf,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,aACV6C,SAA4B,OAAlBoC,EACVzC,QAAS,kBAAMgE,EAAUvB,EAAe,KAExC3S,EAAAxE,EAAAyE,cAACW,GAAME,UAAP,MALJ,eAQkB,IAArB3I,EAAUd,QACP2I,EAAAxE,EAAAyE,cAAA,oCAEJD,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAWjN,KAAMkN,OACnBxV,EAAUd,OAAS,GAChB2I,EAAAxE,EAAAyE,cAAA,wBAAgBtH,EAAU,EAA1B,YAEJqH,EAAAxE,EAAAyE,cAAA,aACK9H,EAAUd,OAAS,GAChB2I,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,UAAUI,MAAM,OAA9B,KAGA9N,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,cAAcI,MAAM,OAAlC,SAGA9N,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,cAAcI,MAAM,OAAlC,SAGA9N,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,cAAcI,MAAM,OAAlC,UAGA9N,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,gBAAgBI,MAAM,OAApC,aAKP3V,EAAUmC,IAAI,SAAChH,EAAOof,GAAR,OACX1S,EAAAxE,EAAAyE,cAACwS,GAAD,CACI9V,IAAKrJ,EAAMkB,GACXlB,MAAOA,EACPof,IAAKA,EACL/Z,QAASA,EACTga,cAAeA,EACfC,iBAAkBA,SC7G/B,SAAS0B,GAAMvU,GAC1B,IAAMpH,EAAUvE,OAAO2L,EAAMpH,SADImU,EAENvB,KAApBhS,EAF0BuT,EAE1BvT,QAASC,EAFiBsT,EAEjBtT,QAEV2X,EAAaxY,IAAYY,EAAQ/C,UAAUa,OAAS,EACpDiC,EAAaC,EAASC,EAASb,GAC/B,GACAyY,EAAiB1X,OAAOgD,KAAKyU,GAAW9Z,OAPbyS,EAQHC,mBAAS,GARNC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAQ1ByK,EAR0BvK,EAAA,GAQjBwK,EARiBxK,EAAA,GAejC,OANAG,oBACI,WAC2BqK,EAAtBpD,EAAiB,EAAgB,EAAgB,IAEtD,CAACA,IAGDpR,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,CAAMlc,MAAOgc,EAAS9E,SAAU,SAAClX,GAAD,OAAWic,EAAWjc,KAClDyH,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KAAKzU,EAAAxE,EAAAyE,cAACW,GAAMY,KAAP,MAAL,YACAxB,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,CAAKlE,SAA6B,IAAnBa,GACXpR,EAAAxE,EAAAyE,cAACW,GAAMqB,MAAP,MADJ,uBAIJjC,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACgU,GAAD,CAAOtb,QAASA,KAEpBqH,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAAC8R,GAAD,CAAYpZ,QAASA,+BCvBzC,SAAS+b,GAAW3U,GAAO,IAAA+M,EACMvB,KAAtBhS,EADgBuT,EAChBvT,QAASgN,EADOuG,EACPvG,UADOoO,EAGW3X,GADHzD,EAAxB9C,UAAwB8C,EAAb/C,WAFKoe,EAAAlb,OAAAyD,EAAA,EAAAzD,CAAAib,EAAA,GAGhBE,EAHgBD,EAAA,GAGFE,EAHEF,EAAA,GAIvB,OACI5U,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAWjN,KAAMkN,OACpB3N,EAAAxE,EAAAyE,cAAA,+BACAD,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAWjN,KAAMsU,WACjB/U,EAAAxE,EAAAyE,cAAA,MAAI6N,MAAM,OAAV,QACA9N,EAAAxE,EAAAyE,cAAA,MAAI6N,MAAM,OAAV,QACA9N,EAAAxE,EAAAyE,cAAA,MAAI6N,MAAM,OAAV,SACCgH,EAAUxa,IAAI,SAAC/D,EAAM6F,GAAP,OACX4D,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKP,EAAG0R,MAAM,OACbvX,MAIZse,EAAava,IAAI,SAAC8C,EAAewQ,GAAhB,OACdxQ,EAAc9C,IAAI,SAAC+C,EAAU2X,EAAG7V,GAAd,OACda,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKU,EAAS7I,GAAIkZ,UAAWjN,KAAMoN,KAC5B,IAANmH,GACGhV,EAAAxE,EAAAyE,cAAA,MACIyN,UAAW,iBAAmBjN,KAAMmN,KACpCqH,QAAS9V,EAAI9H,OACbyW,MAAM,OAELva,IAAQqa,EAAO,GAAGna,OAAO,OAGlCuM,EAAAxE,EAAAyE,cAAA,MACIyN,UAAWjN,KAAMsN,WACjByE,cAAa5E,EACbE,MAAM,OAELvH,EAAUlJ,EAAS7I,IAAIM,UAL5B,OAMKyR,EAAUlJ,EAAS7I,IAAIO,UAE5BiL,EAAAxE,EAAAyE,cAAA,MACIyN,UAAU,gBACV8E,cAAa0C,KACT3O,EAAUlJ,EAAS7I,IAAIM,UACrByR,EAAUlJ,EAAS7I,IAAIO,SACvB,WAGLxB,IAAQ8J,EAASxH,OAAOpC,OAAO,QAEnC4J,EAAS5G,UAAU6D,IAAI,SAACzE,EAAOuG,GAAR,OACpB4D,EAAAxE,EAAAyE,cAAA,MACItD,IAAKP,EACLsR,UAAU,gBACV8E,cAAa0C,KACT3O,EAAUlJ,EAAS7I,IAAIM,UACrByR,EAAUlJ,EAAS7I,IAAIO,SACvB+f,EAAU1Y,KAGf7I,IAAQsC,GAAOpC,OAAO,iBAY3D,SAAS0hB,GAAgBpV,GAAO,IAAAqV,EACO7J,KAA5BhS,EADqB6b,EACrB7b,QACD6J,EAFsBgS,EACZxJ,gBAETnV,EAAa8C,EAAb9C,UAHqBqT,EAIQC,mBAAS,MAJjBC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAIrBuL,EAJqBrL,EAAA,GAITsL,EAJStL,EAAA,GAM5B,SAASuL,IAAoB,IAAX/gB,EAAW4C,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAN,KACboe,EAAYxI,YAAUqI,GACxB5e,EAAUwB,SAASud,EAAUhhB,KAC7B4O,EAAS,CAAC5O,GAAIghB,EAAUhhB,GAAKU,KAAM,iBACnCogB,EAAc,OAEdlS,EAAS,CAAC5O,GAAIghB,EAAUhhB,GAAKU,KAAM,iBAI3C,SAASugB,EAAOtB,GACZ,IAAM5b,EAAQ9B,EAAU+B,QAAQ6c,GAChCjS,EAAS,CACLyD,SAAUtO,EAAQ4b,EAClBrN,SAAUvO,EACVrD,KAAM,kBAId,OACI8K,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,uCACAD,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAU,WACX1N,EAAAxE,EAAAyE,cAAA,UACIsQ,SAAyB,OAAf8E,EACVnF,QAAS,kBAAMqF,MAFnB,UAMAvV,EAAAxE,EAAAyE,cAAA,UACIsQ,SAAyB,OAAf8E,EACVnF,QAAS,kBAAMuF,GAAQ,KAEvBzV,EAAAxE,EAAAyE,cAACW,GAAMG,QAAP,MAJJ,YAMAf,EAAAxE,EAAAyE,cAAA,UACIsQ,SAAyB,OAAf8E,EACVnF,QAAS,kBAAMuF,EAAO,KAEtBzV,EAAAxE,EAAAyE,cAACW,GAAME,UAAP,MAJJ,cAMAd,EAAAxE,EAAAyE,cAAA,UACIsQ,SAAyB,OAAf8E,EACVnF,QAAS,kBAAMoF,EAAc,QAFjC,SAOJtV,EAAAxE,EAAAyE,cAAA,UACKxJ,EAAU6D,IAAI,SAAC9F,GAAD,OACXwL,EAAAxE,EAAAyE,cAAA,MACItD,IAAKnI,EACLkZ,UAAW2H,IAAe7gB,EAAK,WAAa,IAE3C2G,GAAgB3G,GAAI+B,KAAM,IAC3ByJ,EAAAxE,EAAAyE,cAAA,UACIsQ,SACmB,OAAf8E,GAAuBA,IAAe7gB,EAE1C0b,QAAS,kBAECoF,EADND,IAAe7gB,EACK,KACAA,KAGvB6gB,IAAe7gB,EAAK,OAAS,YAK9CwL,EAAAxE,EAAAyE,cAAA,wCACAD,EAAAxE,EAAAyE,cAAA,UACKvG,OAAOC,OAAOwB,IAAiBb,IAAI,SAAAkC,GAAA,IAAEjG,EAAFiG,EAAEjG,KAAM/B,EAARgI,EAAQhI,GAAR,OAChCwL,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKnI,GACLwL,EAAAxE,EAAAyE,cAAA,QACIyN,UACIjX,EAAUwB,SAASzD,GACb,UACA,YAGT+B,IAEHE,EAAUwB,SAASzD,IACjBwL,EAAAxE,EAAAyE,cAAA,UAAQiQ,QAAS,kBAAMqF,EAAS/gB,KAAhC,YAY5B,IAoBekhB,GApBA,SAAC3V,GAAD,OACXC,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KAAKzU,EAAAxE,EAAAyE,cAACW,GAAMY,KAAP,MAAL,WACAxB,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KAAKzU,EAAAxE,EAAAyE,cAACW,GAAMiB,SAAP,MAAL,yBAEJ7B,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACyU,GAAD,OAEJ1U,EAAAxE,EAAAyE,cAACwU,GAAA,EAAD,KACIzU,EAAAxE,EAAAyE,cAACkV,GAAD,UCjMD,SAASQ,GAAO5V,GAAO,IAC3BxG,EAAWgS,KAAXhS,QACP,OACIyG,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAW3N,EAAM2N,WAClB1N,EAAAxE,EAAAyE,cAAA,UAAK1G,EAAQhD,uECEV,SAASqf,GAAQ7V,GAAO,IAAA+M,EAO/BvB,KALAhS,EAF+BuT,EAE/BvT,QACAC,EAH+BsT,EAG/BtT,QACA+M,EAJ+BuG,EAI/BvG,UACAsF,EAL+BiB,EAK/BjB,gBACAD,EAN+BkB,EAM/BlB,gBAEJc,GAAiBnT,EAAQhD,MARU,IAS5BC,EAAa+C,EAAb/C,UACD2a,EAAY7X,EAAaC,EAASC,EAAShD,EAAUa,OAAS,GAE9Dwe,EAAmB,WACrB,IAAMC,EAAY5b,KAAK1D,GACvB,IAAKsf,EACD,OAAO,EAEX,IAAMxL,EAAUwL,EAAUxb,IACtB,SAAChH,GAAD,OAAWA,EAAM6C,OAAO,GAAK7C,EAAM6C,OAAO,KAE9C,OAAyC,IAAlCuD,OAAOgD,KAAKyU,GAAW9Z,SAAiBiT,EAAQrS,SAAS,GAR3C,GAUnB8d,E7BiJH,SAAyBC,GAC5B,IAAMD,EAAaliB,KAAKoiB,KAAKpiB,KAAKqiB,KAAKF,IACvC,OAAQ5hB,OAAO+hB,SAASJ,GAAeA,EAAa,E6BnJjCK,CAAgB1c,OAAOgD,KAAKlD,GAASnC,QAClDgf,EAAW7f,EAAUa,QAAU0e,EAvBFvZ,EAyB1BqZ,EAKMQ,EACA,CAAC,wCAAwC,GAEzC,CAAC,+BAA+B,GAPhC,CACH,gEACA,GA5BuBzY,EAAAlE,OAAAyD,EAAA,EAAAzD,CAAA8C,EAAA,GAwB5B8Z,EAxB4B1Y,EAAA,GAwBf2Y,EAxBe3Y,EAAA,YAAA4Y,IAAA,OAAAA,EAAA9c,OAAA+c,GAAA,EAAA/c,CAAAgd,GAAAlb,EAAAmb,KAgDnC,SAAAC,IAAA,OAAAF,GAAAlb,EAAAqb,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,WACQ7jB,OAAO8jB,QAAQ,mDADvB,CAAAH,EAAAE,KAAA,eAAAF,EAAAE,KAAA,EAEcjX,EAAMmX,SAAS,KAF7B,OAKQhd,KAAK1D,GAAW4d,QAAQ,SAAU9gB,GAC1BA,EAAM6C,OAAO,GAAK7C,EAAM6C,OAAO,KAAO,GAG1C7C,EAAM4C,UAAUke,QAAQ,SAAUnE,EAAKxX,GACnC,GAAIwX,IAAQlZ,EAAZ,CAD0C,IAInC/B,EAAcuR,EAAU0J,GAAxBjb,WACP6W,EAAgB,CACZrX,GAAIyb,EACJjb,WAAYA,EAAa,EACzBE,KAAM,0BAEV2W,EAAgB,CACZrX,GAAIyb,EACJhb,OAAQ3B,EAAM2C,WAAWwC,GACzBvD,KAAM,2BAIlB0W,EAAgB,CAAC1W,KAAM,mBACU,IAA7BqE,EAAQ/C,UAAUa,QAElBuU,EAAgB,CAAC1W,KAAM,cA7BnC,wBAAA4hB,EAAAK,SAAAP,OAhDmCQ,MAAAC,KAAAjgB,WAkFnC,OACI4I,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAW3N,EAAM2N,WAClB1N,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAG,MACLvX,EAAAxE,EAAAyE,cAACW,GAAMsB,EAAP,MADJ,WAKRlC,EAAAxE,EAAAyE,cAAA,WACAD,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAG,KACLvX,EAAAxE,EAAAyE,cAACW,GAAMqB,MAAP,MADJ,aAIJjC,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAG,cACLvX,EAAAxE,EAAAyE,cAACW,GAAMW,OAAP,MADJ,gBAIJvB,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAG,UACLvX,EAAAxE,EAAAyE,cAACW,GAAMY,KAAP,MADJ,mBAKRxB,EAAAxE,EAAAyE,cAAA,WACAD,EAAAxE,EAAAyE,cAAA,UACKvG,OAAOgD,KAAKlG,GAAW8D,IAAI,SAAC9F,GAAD,OACxBwL,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKnI,GACLwL,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAE,GAAAve,OAAKxE,IAAb,SACOJ,OAAOI,GAAM,QAMpCwL,EAAAxE,EAAAyE,cAAA,WACAD,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACIsQ,UAAWsF,EACX3F,QAzFpB,WAGQmG,IACKljB,OAAO8jB,QAHI,yEAOpBrL,EAAgB,CAAC1W,KAAM,gBAmFP8K,EAAAxE,EAAAyE,cAACW,GAAMa,KAAP,MAJJ,cAKU,IACVzB,EAAAxE,EAAAyE,cAACuX,GAAA,EAAD,CAASC,MAAOnB,GACZtW,EAAAxE,EAAAyE,cAAA,QAAMyN,UAAU,YACV6I,EACAvW,EAAAxE,EAAAyE,cAACW,GAAMC,MAAP,CAAa6M,UAAU,iBACvB1N,EAAAxE,EAAAyE,cAACW,GAAMK,MAAP,CAAayM,UAAU,iBAKrC1N,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACIyN,UAAW,SACX6C,SAA+B,IAArB/Z,EAAUa,OACpB6Y,QA/Ie,kBAAAsG,EAAAY,MAAAC,KAAAjgB,aAiJf4I,EAAAxE,EAAAyE,cAACW,GAAMkB,MAAP,MALJ,uBAQJ9B,EAAAxE,EAAAyE,cAAA,6BACqBzJ,EAAUa,OAD/B,IACwC0e,6BCnJzC,SAAS1f,GAAW0J,GAC/B,OACIC,EAAAxE,EAAAyE,cAACwL,GAAD,CAAoBE,UAAW5L,EAAM4L,WACjC3L,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAWY,KAAOoJ,YACnB1X,EAAAxE,EAAAyE,cAAC0V,GAAD,CAAQjI,UAAWY,KAAOqJ,SAC1B3X,EAAAxE,EAAAyE,cAAC2V,GAAD,CAASlI,UAAWY,KAAOsJ,QAASV,SAAUnX,EAAMmX,WACpDlX,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAWY,KAAOuJ,SACnB7X,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,KACItX,EAAAxE,EAAAyE,cAACkQ,GAAD,CAAc2H,KAAK,MACnB9X,EAAAxE,EAAAyE,cAAC4M,GAAD,CAAYiL,KAAK,eACjB9X,EAAAxE,EAAAyE,cAAC8X,GAAD,CAAQD,KAAK,WACb9X,EAAAxE,EAAAyE,cAACqU,GAAD,CAAOwD,KAAK,iBCjBrB,SAASE,GAAejY,GAAO,IAAAkY,EACbpN,KADaqN,EAAAxe,OAAAyD,EAAA,EAAAzD,CAAAue,EAAA,GACnCE,EADmCD,EAAA,GACzB9U,EADyB8U,EAAA,GAAApO,EAEEC,mBAAS,IAFXC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAEnCsO,EAFmCpO,EAAA,GAEnBqO,EAFmBrO,EAAA,GAAAkB,EAGNnB,oBAAS,GAHHoB,EAAAzR,OAAAyD,EAAA,EAAAzD,CAAAwR,EAAA,GAGnCoN,EAHmCnN,EAAA,GAGvBoN,EAHuBpN,EAAA,GAmB1C,OAfAuB,GAAiB,mBAgBb1M,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,UACIiQ,QAAS,kBAAMqI,GAAc,KAE7BvY,EAAAxE,EAAAyE,cAACW,GAAMa,KAAP,MAHJ,mBAKE/H,OAAOgD,KAAKyb,GAAU9gB,OAAS,EAEjC2I,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,kCACAD,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,kBACAD,EAAAxE,EAAAyE,cAAA,uBAEHvG,OAAOC,OAAOwe,GAAU7d,IAAI,SAAAkC,GAAA,IAAEjG,EAAFiG,EAAEjG,KAAM/B,EAARgI,EAAQhI,GAAR,OACzBwL,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKnI,GACLwL,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAI/iB,GACL+B,IAGTyJ,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACIK,aAAA,gBAAAtH,OAAuBzC,EAAvB,UACAmX,UAAU,eACVnN,MAAK,gBAAAvH,OAAazC,EAAb,UACL2Z,QACI,kBAAM9M,EAAS,CAAC5O,KAAIU,KAAM,eAG9B8K,EAAAxE,EAAAyE,cAACW,GAAMkB,MAAP,aAOtB9B,EAAAxE,EAAAyE,cAAA,sCAEFD,EAAAxE,EAAAyE,cAACuQ,GAAA,EAAD,CAAQC,OAAQ6H,GACZtY,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVwC,QAAS,kBAAMqI,GAAc,KAFjC,SAMAvY,EAAAxE,EAAAyE,cAAA,QAAMqP,SAzDlB,SAAwBL,GACpBA,EAAMC,iBACN9L,EAAS,CACL7M,KAAM6hB,EACNljB,KAAM,gBAEVmjB,EAAkB,MAoDNrY,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,uCACAD,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,gBAAf,SACAvP,EAAAxE,EAAAyE,cAAA,SACI1J,KAAK,eACLiiB,YAAY,kBACZhJ,UAAU,EACVta,KAAK,OACLxB,MAAO0kB,EACP3I,SAvExB,SAAuBR,GACnBoJ,EAAkBpJ,EAAMc,OAAOrc,UAuEZ,IACHsM,EAAAxE,EAAAyE,cAAA,SACIyN,UAAU,iBACVxY,KAAK,SACLxB,MAAM,eC/ElC,IASe+kB,GATS,SAAC1Y,GAAD,OACpBC,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAU,eACV3N,EAAM2L,wCCSAgN,GAjBC,kBACZ1Y,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAWY,KAAOqK,QAAU,YAC/B3Y,EAAAxE,EAAAyE,cAAA,KAAGyN,UAAWY,KAAOsK,eAArB,oEAEK,IACD5Y,EAAAxE,EAAAyE,cAAA,QAAMO,KAAK,MAAMsT,eAAA,GAAjB,gBAHJ,OAKI9T,EAAAxE,EAAAyE,cAAA,KACIyN,UAAWY,KAAOuK,cAClBC,KAAK,mDAFT,kBALJ,OCGOC,GANE,SAAChZ,GAAD,OACbC,EAAAxE,EAAAyE,cAAA,OAAKuS,cAAY,OACbxS,EAAAxE,EAAAyE,cAAA,8BCKO,SAAS+Y,GAAQjZ,GAAO,IAAAkY,EACEpN,KADFqN,EAAAxe,OAAAyD,EAAA,EAAAzD,CAAAue,EAAA,GAC5BE,EAD4BD,EAAA,GAClBe,EADkBf,EAAA,GAAAvI,EAEA/E,KAFAgF,EAAAlW,OAAAyD,EAAA,EAAAzD,CAAAiW,EAAA,GAE5BnW,EAF4BoW,EAAA,GAEnB/D,EAFmB+D,EAAA,GAAA9F,EAGXC,mBAAS,IAHEC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAG5BoP,EAH4BlP,EAAA,GAGtBmP,EAHsBnP,EAAA,GAAA2G,EAIA7F,KAJAsO,EAAA1f,OAAAyD,EAAA,EAAAzD,CAAAiX,EAAA,GAI5B5H,EAJ4BqQ,EAAA,GAInBC,EAJmBD,EAAA,GAKnC1M,GAAiB,WAEjB,IAAM4M,EAAanH,kBACf,iBAAO,CAACpJ,UAASvP,UAAS2e,aAC1B,CAACpP,EAASoP,EAAU3e,IAQxB,SAAS+f,EAASC,GACdP,EAAiB,CAAC7W,MAAOoX,EAAK3Q,YAAa3T,KAAM,eACjDmkB,EAAgB,CAACjX,MAAOoX,EAAKzQ,QAAS7T,KAAM,eAC5C2W,EAAgB,CAACzJ,MAAOoX,EAAKhgB,QAAStE,KAAM,eAC5C/B,OAAOsmB,MAAM,gBAuBjB,OAjCAtP,oBACI,WACIgP,EAAQO,KAAKC,UAAUL,EAAY,KAAM,KAE7C,CAACA,IA8BDtZ,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,YACID,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,6BADJ,yCAGID,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAU,aAAjB,IACM,IACF1N,EAAAxE,EAAAyE,cAAA,SACI+P,QAA8B,IAArBjH,EAAQ5D,SACjBjQ,KAAK,QACLua,SAAU,kBAAM4J,EAAgB,CAC5BzV,OAAQ,WACR1O,KAAM,aACNxB,MAAO,QAInBsM,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAU,aAAjB,OACM,IACF1N,EAAAxE,EAAAyE,cAAA,SACI+P,QAA8B,KAArBjH,EAAQ5D,SACjBjQ,KAAK,QACLua,SAAU,kBAAM4J,EAAgB,CAC5BzV,OAAQ,WACR1O,KAAM,aACNxB,MAAO,WAM3BsM,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,6BACAD,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,KACI2Z,SAAS,qBACTd,KACI,yBACEe,mBAAmBH,KAAKC,UAAUL,KAJ5C,sBAUJtZ,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,QAAf,mBACAvP,EAAAxE,EAAAyE,cAAA,SACIzL,GAAG,OACH+B,KAAK,OACLrB,KAAK,OACLua,SAlEhB,SAAoBR,GAChBA,EAAMC,iBACN,IAAM4K,EAAS,IAAIC,WAEnBD,EAAOE,OAAS,SAAUC,GACtB,IAAMT,EAAOS,EAAGlK,OAAO5Z,OAEvBojB,EADmBG,KAAKQ,MAAMV,KAGlCM,EAAOK,WAAWlL,EAAMG,cAAcgL,MAAM,IAC5CnL,EAAMG,cAAc1b,MAAQ,OA2DxBsM,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,mCACAD,EAAAxE,EAAAyE,cAAA,UAAQiQ,QA3DpB,SAAwBjB,GACpBA,EAAMC,iBACNqK,EAASvO,MAyDD,qBAEJhL,EAAAxE,EAAAyE,cAAA,QAAMqP,SA9Ed,SAAoBL,GAChBA,EAAMC,iBAENqK,EADmBG,KAAKQ,MAAMhB,MA6EtBlZ,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,8CAGAD,EAAAxE,EAAAyE,cAAA,YACIyN,UAAU,OACV2M,KAAM,GACN9jB,KAAK,aACL+jB,KAAM,GACNC,YAAY,EACZ7mB,MAAOwlB,EACPzJ,SAAU,SAACR,GAAD,OAAWkK,EAAQlK,EAAMG,cAAc1b,UAErDsM,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAO/K,KAAK,SAASxB,MAAM,qCCpHpC,SAAS8mB,GAAThe,GAMZ,IALC7E,EAKD6E,EALC7E,SACA6B,EAIDgD,EAJChD,QACAqS,EAGDrP,EAHCqP,gBACA9C,EAEDvM,EAFCuM,QACAsQ,EACD7c,EADC6c,gBAEMthB,EAASyB,EAAQ7B,GADxBmS,EAE2CC,mBACtClQ,EAAmBlC,EAAUoR,EAAQ8H,aAH1C7G,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GAEQ2Q,EAFRzQ,EAAA,GAEuB0Q,EAFvB1Q,EAAA,GAMC0C,GAAiB,gBADG3U,EAAUA,EAAOjD,UAAY,IAAMiD,EAAOhD,SAAW,KAGzE,IAAM4lB,EAAYxI,kBACd,kBAAMzY,OAAOgD,KAAKlD,GAASpB,OACvB,SAAC5D,GAAD,OAASimB,EAAcxiB,SAASzD,IAAOA,IAAOmD,KAElD,CAAC6B,EAAS7B,EAAU8iB,IAZzBvP,EAc+CnB,mBAAS4Q,EAAU,IAdlExP,EAAAzR,OAAAyD,EAAA,EAAAzD,CAAAwR,EAAA,GAcQ0P,EAdRzP,EAAA,GAcyB0P,EAdzB1P,EAAA,GAkCC,SAAS2P,EAAa7L,GAClBA,EAAMC,iBADmB,IAAAC,EAEyBF,EAAMG,cAAjDta,EAFkBqa,EAElBra,UAAWC,EAFOoa,EAEPpa,SAAUC,EAFHma,EAEGna,WAAYC,EAFfka,EAEela,OACxC4W,EAAgB,CACZ/W,UAAWA,EAAUpB,MACrBc,GAAImD,EACJ5C,SAAUA,EAASrB,MACnBsB,WAAYZ,OAAOY,EAAWtB,OAC9BuB,OAAQb,OAAOa,EAAOvB,OACtBwB,KAAM,eAGd,OAxBAiV,oBACI,WACIuQ,EAAiB7gB,EAAmBlC,EAAUoR,EAAQ8H,cAE1D,CAAC9H,EAAQ8H,WAAYlZ,IAEzBwS,oBACI,WACI0Q,EAAmBF,EAAU,KAEjC,CAACE,EAAoBF,IAcpB5iB,EAIDiI,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAWY,KAAOyM,YACnB/a,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAG,MAAKvX,EAAAxE,EAAAyE,cAACW,GAAMM,YAAP,MAAd,SACAlB,EAAAxE,EAAAyE,cAAA,yBACiBlI,EAAOjD,UADxB,IACoCiD,EAAOhD,UAE3CiL,EAAAxE,EAAAyE,cAAA,QAAMwP,SAAUqL,EAAcxL,SAAUwL,GACpC9a,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,aAAf,cACAvP,EAAAxE,EAAAyE,cAAA,SACI+a,aAAcjjB,EAAOjD,UACrByB,KAAK,YACLrB,KAAK,UAGb8K,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,YAAf,aACAvP,EAAAxE,EAAAyE,cAAA,SACI+a,aAAcjjB,EAAOhD,SACrBwB,KAAK,WACLrB,KAAK,UAGb8K,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,cAAf,kBACAvP,EAAAxE,EAAAyE,cAAA,SACI+a,aAAc/mB,OAAO8D,EAAO/C,YAC5BuB,KAAK,aACLrB,KAAK,YAGb8K,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,UAAf,UACAvP,EAAAxE,EAAAyE,cAAA,SACI+a,aAAc/mB,OAAO8D,EAAO9C,QAC5BsB,KAAK,SACLrB,KAAK,YAGb8K,EAAAxE,EAAAyE,cAAA,SACID,EAAAxE,EAAAyE,cAAA,SAAOsP,QAAQ,WAAf,YACAvP,EAAAxE,EAAAyE,cAAA,SACI1J,KAAK,UACLrB,KAAK,SACLxB,MAAOH,IAAQkE,EAAQM,EAAO/C,aAAavB,OAAO,MAClDwnB,UAAQ,MAIpBjb,EAAAxE,EAAAyE,cAAA,8BACAD,EAAAxE,EAAAyE,cAAA,UACKwa,EAAcngB,IAAI,SAAC2V,GAAD,OACfjQ,EAAAxE,EAAAyE,cAAA,MAAItD,IAAKsT,GACJzW,EAAQyW,GAAKnb,UADlB,IAC8B0E,EAAQyW,GAAKlb,SACvCiL,EAAAxE,EAAAyE,cAAA,UACIib,cAAA,YAAAliB,OAC1BQ,EAAQyW,GAAKnb,UADa,KAAAkE,OACAQ,EAAQyW,GAAKlb,SADb,qBAEA2Y,UAAU,eACVnN,MAAK,UAAAvH,OAAYQ,EAAQyW,GAAKnb,UAAzB,OAAAkE,OAC/BQ,EAAQyW,GAAKlb,UACamb,QAAS,kBACLmJ,EAAgB,CACZvf,KAAM,CAACnC,EAAUsY,GACjB/a,KAAM,qBAId8K,EAAAxE,EAAAyE,cAACW,GAAMkB,MAAP,UAIc,IAAzB2Y,EAAcpjB,QACX2I,EAAAxE,EAAAyE,cAAA,mBAGRD,EAAAxE,EAAAyE,cAAA,QAAMqP,SA7Gd,SAAkBL,GACdA,EAAMC,iBACNmK,EAAgB,CACZvf,KAAM,CAACnC,EAAUijB,GACjB1lB,KAAM,qBA0GF8K,EAAAxE,EAAAyE,cAAA,gBACID,EAAAxE,EAAAyE,cAAA,qCACAD,EAAAxE,EAAAyE,cAAA,UACI+T,OAAQ,SAAC/E,GAAD,OACJ4L,EAAmB5L,EAAMc,OAAOrc,SAGnCinB,EAAUrgB,IAAI,SAAC2V,GAAD,OACXjQ,EAAAxE,EAAAyE,cAAA,UAAQtD,IAAKsT,EAAKvc,MAAOuc,GACpBzW,EAAQyW,GAAKnb,UADlB,IAC8B0E,EAAQyW,GAAKlb,aAGzC,IACViL,EAAAxE,EAAAyE,cAAA,SAAO/K,KAAK,SAASxB,MAAM,WA3FhCsM,EAAAxE,EAAAyE,cAAA,yBCpDA,SAASkb,GAAT3e,GAIZ,IAHChD,EAGDgD,EAHChD,QACAqS,EAEDrP,EAFCqP,gBACAwN,EACD7c,EADC6c,gBACDvP,EACqCC,oBAAS,GAD9CC,EAAAtQ,OAAAyD,EAAA,EAAAzD,CAAAoQ,EAAA,GACQwO,EADRtO,EAAA,GACoBuO,EADpBvO,EAAA,GAEC0C,GAAiB,WAUjB,OACI1M,EAAAxE,EAAAyE,cAAA,WACID,EAAAxE,EAAAyE,cAAA,UAAQiQ,QAAS,kBAAMqI,GAAc,KACjCvY,EAAAxE,EAAAyE,cAACW,GAAMoB,SAAP,MADJ,qBAGAhC,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAWY,KAAOX,OACrB3N,EAAAxE,EAAAyE,cAAA,gCACAD,EAAAxE,EAAAyE,cAAA,aACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,MAAIqQ,QAAS,GAAb,QACAtQ,EAAAxE,EAAAyE,cAAA,oBACAD,EAAAxE,EAAAyE,cAAA,qBACAD,EAAAxE,EAAAyE,cAAA,wBAGRD,EAAAxE,EAAAyE,cAAA,aAAQvG,OAAOC,OAAOH,GAASc,IAAI,SAACvC,GAAD,OAC/BiI,EAAAxE,EAAAyE,cAAA,MAAItD,IAAK5E,EAAOvD,IACZwL,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,iBACT3V,EAAOjD,WAEZkL,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,iBACT3V,EAAOhD,UAEZiL,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,iBAAiB3V,EAAO9C,QACtC+K,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAU,iBAAiB3V,EAAO/C,YACtCgL,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UAEIK,aAAA,UAAAtH,OAAsBjB,EAAOjD,UAA7B,KAAAkE,OAA0CjB,EAAOhD,UACjD2Y,UAAU,0BAEVnN,MAAK,UAAAvH,OAAYjB,EAAOjD,UAAnB,KAAAkE,OAAgCjB,EAAOhD,UAC5Cmb,QAAS,SAACjB,GAAD,OAzCnB,SAAUA,EAAOza,GAC/Bya,EAAMC,iBACN,IAAMkM,EAAU,mCACV5hB,EAAQhF,GAAIM,UAAY,IAAM0E,EAAQhF,GAAIO,SAAW,IACvD5B,OAAO8jB,QAAQmE,KACfvP,EAAgB,CAACrX,KAAIU,KAAM,aAC3BmkB,EAAgB,CAAC7kB,KAAIU,KAAM,sBAmCammB,CAAUpM,EAAOlX,EAAOvD,MAE5CwL,EAAAxE,EAAAyE,cAACW,GAAMkB,MAAP,OACM,IACV9B,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAMC,GAAItjB,OAAO8D,EAAOvD,KAAxB,OAEIwL,EAAAxE,EAAAyE,cAACsR,GAAA,EAAD,KACK,IAAKxZ,EAAOjD,UADjB,IAC6BiD,EAAOhD,UAClB,IAClBiL,EAAAxE,EAAAyE,cAACW,GAAMO,aAAP,aAOpBnB,EAAAxE,EAAAyE,cAACuQ,GAAA,EAAD,CAAQC,OAAQ6H,GACZtY,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,QACVwC,QAAS,kBAAMqI,GAAc,KAFjC,SAMAvY,EAAAxE,EAAAyE,cAAC2O,GAAD,CAAWxL,SAAUyI,MC3EtB,SAASyP,GAAQvb,GAAO,IAAA4P,EACA/E,KADAgF,EAAAlW,OAAAyD,EAAA,EAAAzD,CAAAiW,EAAA,GAC5BnW,EAD4BoW,EAAA,GACnB/D,EADmB+D,EAAA,GAAAe,EAEA7F,KAFAsO,EAAA1f,OAAAyD,EAAA,EAAAzD,CAAAiX,EAAA,GAG7B4K,EAAa,CAACxS,QAHeqQ,EAAA,GAGNC,gBAHMD,EAAA,GAGW5f,UAASqS,mBACvD,OACI7L,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAQkE,SAAS,WACbxb,EAAAxE,EAAAyE,cAACkb,GAADzhB,OAAAwG,OAAA,CAAY4X,KAAK,KAAQyD,IACzBvb,EAAAxE,EAAAyE,cAACua,GAAD9gB,OAAAwG,OAAA,CAAY4X,KAAK,aAAgByD,6BCmC9BE,GA3CA,SAAC1b,GAAD,OACXC,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAWY,KAAOoN,QACnB1b,EAAAxE,EAAAyE,cAAA,SAAOyN,UAAWY,KAAOqN,MACrB3b,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAAA,UACIyN,UAAU,iBACVwC,QAAS,kB5BmB7B/G,GAAaqB,SAASQ,GAASjC,SAC/BO,GAAYkB,SAASQ,GAASxR,SAC9B+P,GAAaiB,SAASQ,GAASnC,kBAC/B1V,OAAOsmB,MAAM,uB4BxBG,oCAKU,IANd,cASAzZ,EAAAxE,EAAAyE,cAAA,UACID,EAAAxE,EAAAyE,cAACW,GAAMI,YAAP,MADJ,6BAIAhB,EAAAxE,EAAAyE,cAAA,gDAKRD,EAAAxE,EAAAyE,cAAA,MAAIyN,UAAWY,KAAO/N,OAClBP,EAAAxE,EAAAyE,cAAA,QAAM6T,eAAa,GAAnB,UAAkC,IADtC,kBAEmB9T,EAAAxE,EAAAyE,cAAA,wCAEnBD,EAAAxE,EAAAyE,cAAA,UAAQyN,UAAW,WAAaY,KAAOsN,QACnC5b,EAAAxE,EAAAyE,cAAA,oEAC6D,IACzDD,EAAAxE,EAAAyE,cAAA,KAAG6Y,KAAK,mDAAR,4DAIJ9Y,EAAAxE,EAAAyE,cAAA,KAAGQ,MAAO,CAACob,UAAW,UAAtB,4BAC8B,IAC1B7b,EAAAxE,EAAAyE,cAAA,KAAG6Y,KAAK,wBAAR,SAFJ,IAE8C,IAC1C9Y,EAAAxE,EAAAyE,cAAA,QAAMQ,MAAO,CAACqb,SAAU,YACpB9b,EAAAxE,EAAAyE,cAACW,GAAMU,WAAP,MADJ,IACyBtB,EAAAxE,EAAAyE,cAACW,GAAMc,MAAP,qBCnBrCqa,UAASC,KACTC,GAAUC,YAAcH,IA6CbI,OAzCf,WAEI,OADAzP,GAAiB,0BAEb1M,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAU,OACX1N,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAkB2E,QAASA,IACvBjc,EAAAxE,EAAAyE,cAAA,UAAQyN,UAAU,UACd1N,EAAAxE,EAAAyE,cAAA,OAAKyN,UAAW0O,aACZpc,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAM5J,UAAW2O,QAAM9E,GAAG,YAA1B,eAGAvX,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAM5J,UAAW2O,QAAM9E,GAAG,WAA1B,WAGAvX,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAM5J,UAAW2O,QAAM9E,GAAG,WAA1B,WAGAvX,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,CAAM5J,UAAW2O,QAAM9E,GAAG,KAA1B,WAKRvX,EAAAxE,EAAAyE,cAAA,QAAMyN,UAAU,WACZ1N,EAAAxE,EAAAyE,cAACqX,EAAA,EAAD,KACItX,EAAAxE,EAAAyE,cAACyb,GAAD,CAAQ5D,KAAK,MACb9X,EAAAxE,EAAAyE,cAACyX,GAAD,CAAiBI,KAAK,YAClB9X,EAAAxE,EAAAyE,cAAC+X,GAAD,CAAgBF,KAAK,MACrB9X,EAAAxE,EAAAyE,cAACqc,GAAD,CAAYxE,KAAK,kBAErB9X,EAAAxE,EAAAyE,cAACqb,GAAD,CAASxD,KAAK,cACd9X,EAAAxE,EAAAyE,cAAC+Y,GAAD,CAASlB,KAAK,YACd9X,EAAAxE,EAAAyE,cAACsc,GAAD,CAAUC,SAAO,OAI7Bxc,EAAAxE,EAAAyE,cAAA,UAAQyN,UAAU,UACd1N,EAAAxE,EAAAyE,cAAC0Y,GAAD,0BCzDhB8D,EAASC,OACL1c,EAAAxE,EAAAyE,cAAC4R,EAAA,WAAD,KAAY7R,EAAAxE,EAAAyE,cAAC0c,GAAD,OACZ/P,SAASgQ,eAAe,ShD2HtB,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAM1S,KAAK,SAAC2S,GAClCA,EAAaC,mCiDpInBC,EAAAC,QAAA,CAAkBxP,MAAA,sBAAAoH,UAAA,0BAAAlH,IAAA,oBAAAE,WAAA,2BAAAH,KAAA,0CCAlBsP,EAAAC,QAAA,CAAkBd,KAAA,kBAAAD,SAAA,2CCAlBc,EAAAC,QAAA,CAAkBzF,WAAA,+BAAAC,OAAA,2BAAAC,QAAA,4BAAAC,QAAA,iDCAlBqF,EAAAC,QAAA,CAAkBzB,OAAA,uBAAAC,KAAA,qBAAAC,OAAA,uBAAArb,MAAA,2CCAlB2c,EAAAC,QAAA,CAAkBxP,MAAA,qBAAAoG,aAAA,iDCAlBmJ,EAAAC,QAAA,CAAkBxP,MAAA,uBAAAoN,WAAA,4BAAAqC,SAAA,+CCAlBF,EAAAC,QAAA,CAAkBxE,QAAA,yBAAAC,cAAA,+BAAAC,cAAA,6+OCAlBqE,EAAAC,QAAA,CAAkBzO,OAAA,wBAAAH,MAAA","file":"static/js/main.9e3a6140.chunk.js","sourcesContent":["/* eslint-disable */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets;\n      // see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import numeral from \"numeral\";\n\n// let's make a custom numeral format. I don't really know how this works.\nnumeral.register(\"format\", \"fraction\", {\n    // eslint-disable-next-line no-unused-vars\n    format: function (value, format, roundingFunction) {\n        const whole = Math.floor(value);\n        const remainder = value - whole;\n        const fraction = (function () {\n            switch (remainder) {\n            case 0.25:\n                return \"\";\n            case 0.5:\n                return \"\";\n            case 0.75:\n                return \"\";\n            default:\n                return \"\";\n            }\n        }());\n        const stringedWhole = (\n            (whole === 0 && remainder)\n            ? \"\"\n            : String(whole)\n        );\n        return stringedWhole + fraction;\n    },\n    regexps: {\n        format: /(1\\/2)/,\n        unformat: /(1\\/2)/\n    },\n    unformat: function (value) {\n        // TODO: This doesn't do anything currently\n        return Number(value);\n    }\n});\n","import t from \"tcomb\";\n\nconst Id = t.refinement(\n    t.String,\n    (id) => /^[A-Za-z0-9_-]{21}$/.test(id),\n    \"NanoId\"\n);\nexport {Id};\n\nconst AvoidPair = t.tuple([Id, Id], \"AvoidPair\");\nexport {AvoidPair};\n\nconst Player = t.interface(\n    {\n        firstName: t.String,\n        id: Id,\n        lastName: t.String,\n        matchCount: t.Number,\n        rating: t.Number,\n        type: t.String // used for CSS styling etc\n    },\n    \"Player\"\n);\nexport {Player};\n\nconst PlayerStats = t.interface(\n    {\n        avoidList: t.list(Id),\n        colorBalance: t.Number,\n        dueColor: t.maybe(t.Number),\n        hasHadBye: t.Boolean,\n        id: Id,\n        isDueBye: t.Boolean,\n        opponentHistory: t.list(Id),\n        profile: Player,\n        rating: t.Number,\n        score: t.Number,\n        upperHalf: t.Boolean\n    },\n    \"PlayerStats\"\n);\nexport {PlayerStats};\n\nconst Match = t.interface(\n    {\n        id: Id,\n        newRating: t.tuple([t.Number, t.Number]),\n        origRating: t.tuple([t.Number, t.Number]),\n        playerIds: t.tuple([Id, Id]),\n        result: t.tuple([t.Number, t.Number])\n    },\n    \"Match\"\n);\nexport {Match};\n\nconst RoundList = t.list(t.list(Match), \"Round list\");\nexport {RoundList};\n\nconst Tournament = t.interface(\n    {\n        byeQueue: t.list(t.String),\n        id: Id,\n        name: t.String,\n        playerIds: t.list(t.String),\n        roundList: RoundList,\n        tieBreaks: t.list(t.Number)\n    },\n    \"Tournament\"\n);\nexport {Tournament};\n\nconst ScoreCalulator = t.func(\n    [Id, t.list(Match)],\n    t.Number,\n    \"ScoreCalulator\"\n);\nexport {ScoreCalulator};\n\nconst Standing = t.interface(\n    {\n        id: Id,\n        score: t.Number,\n        tieBreaks: t.list(t.Number)\n    },\n    \"Standing\"\n);\nexport {Standing};\n","const BLACK = 1;\nexport {BLACK};\nconst WHITE = 0;\nexport {WHITE};\nconst DUMMY_ID = \"________DUMMY________\";\nexport {DUMMY_ID};\n","// These factories are mainly useful as a shortcut to provide default values.\nimport {Match, Player, Tournament} from \"./types\";\nimport nanoid from \"nanoid\";\n\nexport function createMatch(importObj) {\n    return Match({\n        id: importObj.id || nanoid(),\n        newRating: importObj.newRating,\n        origRating: importObj.origRating,\n        playerIds: importObj.playerIds,\n        result: importObj.result || [0, 0]\n    });\n}\n\nexport function createPlayer(importObj = {}) {\n    return Player({\n        firstName: importObj.firstName || \"\",\n        id: importObj.id || nanoid(),\n        lastName: importObj.lastName || \"\",\n        matchCount: importObj.matchCount || 0,\n        rating: importObj.rating || 0,\n        type: importObj.type || \"person\" // used for CSS styling etc.\n    });\n}\n\nexport function createTournament(importObj) {\n    return Tournament({\n        byeQueue: importObj.byeQueue || [],\n        id: importObj.id || nanoid(),\n        name: importObj.name || \"\",\n        playerIds: importObj.playerIds || [],\n        roundList: importObj.roundList || [],\n        tieBreaks: importObj.tieBreaks || [0, 1, 2, 3]\n    });\n}\n","import {\n    AvoidPair,\n    Id,\n    Match,\n    Player,\n    PlayerStats,\n    RoundList,\n    ScoreCalulator,\n    Standing,\n    Tournament\n} from \"./types\";\nimport {BLACK, DUMMY_ID, WHITE} from \"./constants\";\nimport {createMatch, createPlayer, createTournament} from \"./factories\";\n\nconst dummyPlayer = createPlayer({\n    firstName: \"Bye\",\n    id: DUMMY_ID,\n    lastName: \"Player\",\n    type: \"dummy\"\n});\n\nconst missingPlayer = (id) => createPlayer({\n    firstName: \"Anonymous\",\n    id: id,\n    lastName: \"Player\",\n    type: \"missing\"\n});\n\nexport {\n    AvoidPair,\n    BLACK,\n    DUMMY_ID,\n    Id,\n    Match,\n    Player,\n    PlayerStats,\n    RoundList,\n    ScoreCalulator,\n    Standing,\n    Tournament,\n    WHITE,\n    createMatch,\n    createPlayer,\n    createTournament,\n    dummyPlayer,\n    missingPlayer\n};\n","import {BLACK, WHITE} from \"../data-types\";\nimport EloRank from \"elo-rank\";\nimport t from \"tcomb\";\n\nexport function kFactor(matchCount) {\n    const ne = t.Number(matchCount) || 1;\n    return (800 / ne);\n}\n\nexport function calcNewRatings(origRatings, matchCounts, result) {\n    t.tuple([t.Number, t.Number])(origRatings);\n    t.tuple([t.Number, t.Number])(matchCounts);\n    t.tuple([t.Number, t.Number])(result);\n    const whiteElo = new EloRank(kFactor(matchCounts[WHITE]));\n    const blackElo = new EloRank(kFactor(matchCounts[BLACK]));\n    const FLOOR = 100;\n    const scoreExpected = [\n        whiteElo.getExpected(origRatings[WHITE], origRatings[BLACK]),\n        blackElo.getExpected(origRatings[BLACK], origRatings[WHITE])\n    ];\n    const newRating = [\n        whiteElo.updateRating(\n            scoreExpected[WHITE],\n            result[WHITE],\n            origRatings[WHITE]\n        ),\n        blackElo.updateRating(\n            scoreExpected[BLACK],\n            result[BLACK],\n            origRatings[BLACK]\n        )\n    ];\n    return newRating.map((rating) => (rating < FLOOR) ? FLOOR : rating);\n}\n","import {\n    AvoidPair,\n    DUMMY_ID,\n    Id,\n    Match,\n    Player,\n    RoundList,\n    Standing,\n    Tournament,\n    dummyPlayer,\n    missingPlayer\n} from \"../data-types\";\nimport {assoc} from \"ramda\";\nimport t from \"tcomb\";\n/*******************************************************************************\n * Player functions\n ******************************************************************************/\nconst isNotDummy = (playerId) => playerId !== DUMMY_ID;\nexport {isNotDummy};\n\nexport function areScoresEqual(standing1, standing2) {\n    Standing(standing1);\n    Standing(standing2);\n    // Check if any of them aren't equal\n    if (standing1.score !== standing2.score) {\n        return false;\n    }\n    // Check if any tie-break values are not equal\n    return !(\n        standing1.tieBreaks.reduce(\n            (acc, value, i) => acc.concat(value !== standing2.tieBreaks[i]),\n            []\n        ).includes(true)\n    );\n}\n\n/**\n * Retrive a specific player from a list or object.\n * @param playerList This can either be typed as `[Player1, Player1]` or\n * `{\"1\": Player, \"2\": Player}`, where `Player1.id` equals its dict key.\n * @param id the `id` property of the desired `Player` object.\n * @returns The desired Player object.\n */\nexport function getPlayerById(playerList, id) {\n    t.union([\n        t.list(Player),\n        t.dict(Id, Player)\n    ])(playerList);\n    if (id === DUMMY_ID) {\n        return dummyPlayer;\n    }\n    const player = (playerList.filter)\n        ? playerList.filter((p) => p.id === id)[0]\n        : playerList[id];\n    return (player) ? player : missingPlayer(id);\n}\n\n/**\n * A replacement for `getPlayerById`, with an emphasis on the indented feature\n * of *maybe* getting a player, *maybe* getting a `dummyPlayer`, or *maybe*\n * getting a missing (deleted) player.\n */\nexport function getPlayerMaybe(playerDict, id) {\n    t.dict(Id, Player)(playerDict);\n    Id(id);\n    if (id === DUMMY_ID) {\n        return dummyPlayer;\n    }\n    const player = playerDict[id];\n    return (player) ? player : missingPlayer(id);\n}\n\n/*******************************************************************************\n * Match functions\n ******************************************************************************/\nconst isNotBye = (match) => !match.playerIds.includes(DUMMY_ID);\nexport {isNotBye};\n\nexport function getMatchesByPlayer(playerId, matchList) {\n    t.list(Match)(matchList);\n    return matchList.filter((match) => match.playerIds.includes(playerId));\n}\n\nexport function getMatchesByPlayerNoByes(playerId, matchList) {\n    t.list(Match)(matchList);\n    return matchList.filter(\n        (match) => match.playerIds.includes(playerId) && isNotBye(match)\n    );\n}\n\nexport function getMatchDetailsForPlayer(playerId, match) {\n    Id(playerId);\n    Match(match);\n    const index = match.playerIds.indexOf(playerId);\n    return {\n        color: index,\n        newRating: match.newRating[index],\n        origRating: match.origRating[index],\n        result: match.result[index]\n    };\n}\n\n/**\n * Flatten a list of rounds to a list of matches.\n */\nexport function rounds2Matches(roundList, roundId = null) {\n    RoundList(roundList);\n    t.maybe(t.Number)(roundId);\n    const rounds = (\n        (roundId === null)\n        ? roundList\n        : roundList.slice(0, roundId + 1)\n    );\n    return rounds.reduce((acc, round) => acc.concat(round), []);\n}\n\nexport function getAllPlayersFromMatches(matchList) {\n    t.list(Match)(matchList);\n    const allPlayers = matchList.reduce(\n        (acc, match) => acc.concat(match.playerIds),\n        []\n    );\n    return Array.from(new Set(allPlayers));\n}\n\n/**\n * Get a list of all of a player's scores from each match.\n */\nexport function getPlayerScoreList(playerId, matchList) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        playerId,\n        matchList,\n    ).map(\n        (match) => getMatchDetailsForPlayer(playerId, match).result\n    );\n}\n\nexport function getPlayerScoreListNoByes(playerId, matchList) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayerNoByes(\n        playerId,\n        matchList\n    ).map(\n        (match) => getMatchDetailsForPlayer(playerId, match).result\n    );\n}\n\n/**\n * This creates a filtered version of `players` with only the players that are\n * not matched for the specified round.\n */\nexport function getUnmatched(tourney, players, roundId) {\n    Tournament(tourney);\n    t.dict(Id, Player)(players);\n    t.Number(roundId);\n    const matchList = tourney.roundList[roundId] || [];\n    const matchedIds = matchList.reduce(\n        (acc, match) => acc.concat(match.playerIds),\n        []\n    );\n    const unmatched = Object.values(players).reduce(\n        (acc, player) => (\n            (matchedIds.includes(player.id))\n            ? acc\n            : assoc(player.id, player, acc)\n        ),\n        {}\n    );\n    return unmatched;\n}\n\n/*******************************************************************************\n * Round functions\n ******************************************************************************/\nexport function calcNumOfRounds(playerCount) {\n    const roundCount = Math.ceil(Math.log2(playerCount));\n    return (Number.isFinite(roundCount)) ? roundCount : 0;\n}\n\n/*******************************************************************************\n * Avoid list functions\n ******************************************************************************/\nexport function getPlayerAvoidList(playerId, avoidList) {\n    t.list(AvoidPair)(avoidList);\n    Id(playerId);\n    return avoidList.filter( // get pairings with the player\n        (pair) => pair.includes(playerId)\n    ).reduce( // Flatten the array\n        (accumulator, pair) => pair.concat(accumulator),\n        []\n    ).filter( // filter out the player's id\n        (id) => id !== playerId\n    );\n}\n\n// TODO: This isn't currently in use, but it probably should be.\nexport function cleanAvoidList(avoidList, playerList) {\n    t.list(AvoidPair)(avoidList);\n    t.list(Player)(playerList);\n    const ids = playerList.map((p) => p.id);\n    return avoidList.filter(\n        (pairs) => (ids.includes(pairs[0]) && ids.includes(pairs[1]))\n    );\n}\n","import {\n    BLACK,\n    DUMMY_ID,\n    Id,\n    Match,\n    ScoreCalulator,\n    WHITE\n} from \"../data-types\";\nimport {\n    getMatchDetailsForPlayer,\n    getMatchesByPlayer,\n    getMatchesByPlayerNoByes,\n    getPlayerScoreList,\n    getPlayerScoreListNoByes,\n    isNotDummy\n} from \"./helpers\";\nimport {\n    init,\n    last,\n    pipe,\n    sort,\n    sum,\n    tail\n} from \"ramda\";\nimport {firstBy} from \"thenby\";\nimport t from \"tcomb\";\n\nexport function getDueColor(playerId, matchList) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    const lastMatch = last(getMatchesByPlayer(playerId, matchList));\n    if (!lastMatch) {\n        return null;\n    }\n    const {color} = getMatchDetailsForPlayer(playerId, lastMatch);\n    return (color === WHITE) ? BLACK : WHITE;\n}\n\nexport function hasHadBye(playerId, matchList) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        playerId,\n        matchList\n    ).reduce(\n        (acc, match) => acc.concat(match.playerIds),\n        []\n    ).includes(DUMMY_ID);\n}\n\nexport function getPlayersByOpponent(opponentId, matchList) {\n    Id(opponentId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        opponentId,\n        matchList\n    ).reduce(\n        (acc, match) => acc.concat(match.playerIds),\n        []\n    ).filter(\n        (playerId) => playerId !== opponentId\n    );\n}\n\n/**\n * Used for `modifiedMedian` and `solkoff`.\n */\nfunction getOpponentScores(playerId, matchList) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    const scores = getPlayersByOpponent(\n        playerId,\n        matchList\n    ).filter(\n        isNotDummy\n    ).map(\n        (opponent) => getPlayerScore(opponent, matchList)\n    );\n    return scores;\n}\n\n/*******************************************************************************\n * The main scoring methods\n ******************************************************************************/\nconst getPlayerScore = ScoreCalulator.of(\n    // named functions are better for debugging\n    function _getPlayerScore(playerId, matchList) {\n        const scoreList = getPlayerScoreList(playerId, matchList);\n        return sum(scoreList);\n    }\n);\nexport {getPlayerScore};\n\n/**\n * The player's cumulative score.\n */\nconst getCumulativeScore = ScoreCalulator.of(\n    // named functions are better for debugging\n    function _getCumulativeScore(playerId, matchList) {\n        const scoreList = getPlayerScoreListNoByes(\n            playerId,\n            matchList\n        ).reduce( // turn the regular score list into a \"running\" score list\n            (acc, score) => acc.concat([last(acc) + score]),\n            [0]\n        );\n        return sum(scoreList);\n    }\n);\n\n/**\n * Get the cumulative scores of a player's opponents.\n */\nconst getCumulativeOfOpponentScore = ScoreCalulator.of(\n    // named functions are better for debugging\n    function _getCumulativeOfOpponentScore(playerId, matchList) {\n        const oppScores = getPlayersByOpponent(\n            playerId,\n            matchList\n        ).filter(\n            isNotDummy\n        ).map(\n            (id) => getCumulativeScore(id, matchList)\n        );\n        return sum(oppScores);\n    }\n);\n\n/**\n * Calculate a player's color balance. A negative number means they played as\n * white more. A positive number means they played as black more.\n */\nconst getColorBalanceScore = ScoreCalulator.of(\n    // named functions are better for debugging\n    function _getColorBalanceScore(playerId, matchList) {\n        const colorList = getMatchesByPlayerNoByes(\n            playerId,\n            matchList\n        ).reduce(\n            (acc, match) => (\n                (match.playerIds[WHITE] === playerId)\n                ? acc.concat(-1) // White = -1\n                : acc.concat(1) // Black = +1\n            ),\n            [0]\n        );\n        return sum(colorList);\n    }\n);\nexport {getColorBalanceScore};\n\n/**\n * Gets the modified median factor defined in USCF  34E1\n */\nconst getModifiedMedianScore = ScoreCalulator.of(\n    // named functions are better for debugging\n    function _getModifiedMedianScore(playerId, matchList) {\n        const scores = getOpponentScores(playerId, matchList);\n        return pipe(\n            sort((a, b) => a - b),\n            init,\n            tail,\n            sum\n        )(scores);\n    }\n);\n\nconst getSolkoffScore = ScoreCalulator.of(\n    // named functions are better for debugging\n    function _getSolkoffScore(playerId, matchList) {\n        const scoreList = getOpponentScores(playerId, matchList);\n        return sum(scoreList);\n    }\n);\n\nconst tieBreakMethods = {\n    0: {\n        func: getModifiedMedianScore,\n        id: 0,\n        name: \"Modified median\"\n    },\n    1: {\n        func: getSolkoffScore,\n        id: 1,\n        name: \"Solkoff\"\n    },\n    2: {\n        func: getCumulativeScore,\n        id: 2,\n        name: \"Cumulative score\"\n    },\n    3: {\n        func: getCumulativeOfOpponentScore,\n        id: 3,\n        name: \"Cumulative of opposition\"\n    },\n    4: {\n        func: getColorBalanceScore,\n        id: 4,\n        name: \"Most black\"\n    }\n};\nObject.freeze(tieBreakMethods);\nexport {tieBreakMethods};\n\n/**\n * Create a function to sort the standings. This dynamically creates a `thenBy`\n * function based on the list of desired tiebreak sort methods.\n * @returns A function to be used with a list of standings and `sort()`.\n */\nexport function createTieBreakSorter(selectedTiebreakMethods) {\n    return Object.keys(selectedTiebreakMethods).reduce(\n        (acc, key) => (\n            acc.thenBy(\n                (standing1, standing2) => (\n                    standing2.tieBreaks[key] - standing1.tieBreaks[key]\n                )\n            )\n        ),\n        firstBy((standing1, standing2) => standing2.score - standing1.score)\n    );\n}\n","import {\n    AvoidPair,\n    Id,\n    Match,\n    Player,\n    PlayerStats,\n    RoundList,\n    Standing\n} from \"../data-types\";\nimport {\n    add,\n    append,\n    defaultTo,\n    last,\n    lensIndex,\n    lensProp,\n    over,\n    pipe,\n    sort\n} from \"ramda\";\nimport {\n    areScoresEqual,\n    getAllPlayersFromMatches,\n    getMatchDetailsForPlayer,\n    getMatchesByPlayer,\n    getPlayerAvoidList,\n    isNotDummy,\n    rounds2Matches\n} from \"./helpers\";\nimport {\n    createTieBreakSorter,\n    getColorBalanceScore,\n    getDueColor,\n    getPlayerScore,\n    getPlayersByOpponent,\n    hasHadBye,\n    tieBreakMethods\n} from \"./scoring\";\nimport t from \"tcomb\";\n/**\n * Sort the standings by score, see USCF tie-break rules from  34.\n * @returns {[Standing[], string[]]} The standings and the list of method used\n */\nexport function createStandingList(methods, roundList, roundId) {\n    t.list(t.Number)(methods);\n    t.list(t.Array)(roundList);\n    t.maybe(t.Number)(roundId);\n    const matchList = rounds2Matches(roundList, roundId);\n    const selectedTieBreaks = methods.map((i) => tieBreakMethods[i]);\n    const tieBreakNames = selectedTieBreaks.map((m) => m.name);\n    // Get a flat list of all of the players and their scores.\n    const standings = getAllPlayersFromMatches(\n        matchList\n    ).map(\n        (id) => Standing({\n            id,\n            score: getPlayerScore(id, matchList),\n            tieBreaks: selectedTieBreaks.map(({func}) => func(id, matchList))\n        })\n    );\n    const sortFunc = createTieBreakSorter(selectedTieBreaks);\n    const standingsSorted = sort(sortFunc, standings);\n    return [standingsSorted, tieBreakNames];\n}\n\n/**\n * Sort the standings by score, see USCF tie-break rules from  34.\n * example: `[[Dale, Audrey], [Pete], [Bob]]`\n * Dale and Audrey are tied for first, Pete is 2nd, Bob is 3rd.\n * @returns {[Standing[][], string[]]} The standings and the list of method used\n */\nexport function createStandingTree(methods, roundList, roundId = null) {\n    t.list(t.Number)(methods);\n    RoundList(roundList);\n    t.maybe(t.Number)(roundId);\n    const [\n        standingsFlat,\n        tieBreakNames\n    ] = createStandingList(methods, roundList, roundId);\n    const standingsFlatNoByes = standingsFlat.filter(isNotDummy);\n    const standingsTree = standingsFlatNoByes.reduce(\n        /** @param {Standing[][]} acc*/\n        function assignStandingsToTree(acc, standing, i, orig) {\n            const prevStanding = orig[i - 1];\n            const isNewRank = (\n                // Always make a new rank for the first player\n                (i === 0) ? true : !areScoresEqual(standing, prevStanding)\n            );\n            if (isNewRank) {\n                return append([standing], acc);\n            }\n            // If this player has the same score as the last, list them together\n            return over(lensIndex(acc.length - 1), append(standing), acc);\n        },\n        []\n    );\n    return [standingsTree, tieBreakNames];\n}\n\n/**\n * @returns {PlayerStats}\n */\nexport function createPlayerStats({\n    avoidList,\n    id,\n    players,\n    roundList,\n    roundId\n}) {\n    Id(id);\n    t.Number(roundId);\n    t.dict(Id, Player)(players);\n    t.list(AvoidPair)(avoidList);\n    RoundList(roundList);\n    const matches = rounds2Matches(roundList, roundId);\n    return PlayerStats({\n        avoidList: getPlayerAvoidList(id, avoidList),\n        colorBalance: getColorBalanceScore(id, matches),\n        dueColor: getDueColor(id, matches),\n        hasHadBye: hasHadBye(id, matches),\n        id: id, // is this shortcut necessary?\n        isDueBye: false,\n        opponentHistory: getPlayersByOpponent(id, matches),\n        profile: players[id],\n        rating: players[id].rating, // is this shortcut necessary?\n        score: getPlayerScore(id, matches),\n        upperHalf: false\n    });\n}\n\n/**\n * NOTE: these params are flipped. Should others be flipped too?\n * @returns {Object.<string, number>} {opponentId: result}\n */\nfunction getResultsByOpponent(matchList, playerId) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    const matches = getMatchesByPlayer(playerId, matchList);\n    return matches.reduce(\n        function (acc, match) {\n            const opponent = match.playerIds.filter(\n                (id) => id !== playerId\n            )[0];\n            const {result} = getMatchDetailsForPlayer(playerId, match);\n            // This sets a default result of 0 and then adds the existing\n            // result. Most of the time, this would be the same as using\n            // `set()` with the result, but if two players play each other\n            // multiple times then the total results will be displayed.\n            return over(\n                lensProp(opponent),\n                pipe(defaultTo(0), add(result)),\n                acc\n            );\n        },\n        {}\n    );\n}\nexport {getResultsByOpponent};\n\n/**\n * NOTE: these params are flipped. Should others be flipped too?\n */\nfunction getPerformanceRatings(matchList, playerId) {\n    Id(playerId);\n    t.list(Match)(matchList);\n    const matches = getMatchesByPlayer(playerId, matchList);\n    const firstMatch = matches[0];\n    const lastMatch = last(matches);\n    return [\n        getMatchDetailsForPlayer(playerId, firstMatch).origRating,\n        getMatchDetailsForPlayer(playerId, lastMatch).newRating\n    ];\n}\nexport {getPerformanceRatings};\n","// This file is a work in progress. The weighting for the ratings needs to be\n// tweaked a lot, and the pairing function itself needs to be cleaned up and\n// made more reusable.\nimport {\n    AvoidPair,\n    DUMMY_ID,\n    Id,\n    Player,\n    PlayerStats,\n    RoundList\n} from \"../data-types\";\nimport {\n    add,\n    assoc,\n    curry,\n    filter,\n    findLastIndex,\n    lensIndex,\n    map,\n    over,\n    pipe,\n    reverse,\n    sort,\n    splitAt,\n    view\n} from \"ramda\";\nimport blossom from \"edmonds-blossom\";\nimport {createPlayerStats} from \"./factories\";\nimport {firstBy} from \"thenby\";\nimport t from \"tcomb\";\n\nconst priority = (value) => (condition) => condition ? value : 0;\nconst divisiblePriority = (value) => (divider) => value / divider;\n\n// TODO: These probably need to be tweaked a lot.\n/**\n * @constant avoidMeetingTwicePriority The weight given to avoid players\n * meeting twice. This same weight is given to avoid matching players on each\n * other's \"avoid\" list. This is the highest priority. (USCF  27A1)\n */\nconst avoidMeetingTwice = priority(20);\n/**\n * @constant sameScoresPriority The weight given to match players with\n * equal scores. This gets divided against the difference between each players'\n * scores, plus one. For example, players with scores `1` and `3` would have\n * this priority divided by `3`. Players with scores `0` and `3` would have this\n * priority divided by `4`. Players with equal scores would divide it by `1`,\n * leaving it unchanged. (USCF  27A2)\n */\nconst sameScores = divisiblePriority(16);\n\n/**\n * @constant differentHalfPriority The weight given to match players in lower\n * versus upper halves. This is only applied to players being matched within\n * the same score group. (USCF  27A3)\n */\nconst differentHalf = priority(2);\n/**\n * @constant differentDueColorPriority The weight given to match players with\n * opposite due colors. (USCF  27A4 and  27A5)\n */\nconst differentDueColor = priority(1);\n\nconst maxPriority = pipe(\n    add(differentHalf(true)),\n    add(differentDueColor(true)),\n    add(sameScores(1)),\n    add(avoidMeetingTwice(true))\n)(0);\nexport {maxPriority};\n\n/**\n * @returns {number}\n */\nexport function calcPairIdeal(player1, player2) {\n    PlayerStats(player1);\n    PlayerStats(player2);\n    if (player1.id === player2.id) {\n        return 0;\n    }\n    const metBefore = player1.opponentHistory.includes(player2.id);\n    const mustAvoid = player1.avoidList.includes(player2.id);\n    return pipe(\n        add(differentHalf(\n            player1.upperHalf !== player2.upperHalf\n            && player1.score === player2.score\n        )),\n        add(differentDueColor(\n            player1.dueColor === null\n            || player1.dueColor !== player2.dueColor\n        )),\n        add(sameScores(Math.abs(player1.score - player2.score) + 1)),\n        add(avoidMeetingTwice(!metBefore && !mustAvoid))\n    )(0);\n}\n\n/**\n * Determine which players are in the upper and lower halves of their score\n * groups.\n * This function does not sort the list. The list should be sorted first.\n */\nexport function setUpperHalves(playerStatsList) {\n    t.list(PlayerStats)(playerStatsList);\n    const splitInHalf = (list) => splitAt(list.length / 2, list);\n    return playerStatsList.reduce(\n        function (acc, player, ignore, src) {\n            const upperHalfIds = pipe(\n                filter((a) => a.score === player.score),\n                splitInHalf,\n                view(lensIndex(0)),\n                map((a) => a.id)\n            )(src);\n            const isUpperHalf = upperHalfIds.includes(player.id);\n            return acc.concat([assoc(\"upperHalf\", isUpperHalf, player)]);\n        },\n        []\n    );\n}\n\nfunction setByePlayer(byeQueue, playerStatsList) {\n    t.list(t.Number)(byeQueue);\n    t.list(PlayerStats)(playerStatsList);\n    // if the list is even, just return it.\n    if (playerStatsList.length % 2 === 0) {\n        return playerStatsList;\n    }\n    const hasNotHadBye = playerStatsList.filter(\n        (p) => !p.hasHadBye\n    ).map((p) => p.id);\n    const nextByeSignup = byeQueue.filter((id) => hasNotHadBye.includes(id))[0];\n    const indexOfDueBye = (\n        (nextByeSignup)\n        // Assign the bye to the next person who signed up.\n        ? findLastIndex((p) => p.id === nextByeSignup, playerStatsList)\n        // Assign a bye to the lowest-rated player in the lowest score group.\n        // Because the list is sorted, the last player is the lowest.\n        // (USCF  29L2.)\n        : findLastIndex((p) => !p.hasHadBye, playerStatsList)\n    );\n    // In the impossible situation that *everyone* has played a bye round\n    // previously, then just pick the last player.\n    const index = (\n        (indexOfDueBye === -1)\n        ? playerStatsList.length - 1\n        : indexOfDueBye\n    );\n    return over(\n        lensIndex(index),\n        assoc(\"isDueBye\", true),\n        playerStatsList\n    );\n}\n\n/**\n * Sort the data so matchups default to order by score and rating.\n */\nexport function sortPlayersForPairing(playerStatsList) {\n    t.list(PlayerStats)(playerStatsList);\n    return sort(\n        firstBy(\n            (a, b) => b.score - a.score\n        ).thenBy(\n            (a, b) => b.rating - a.rating\n        ),\n        playerStatsList\n    );\n}\n\n/**\n * Creates pairings according to the rules specified in USCF  27,  28,\n * and  29. This is a work in progress and does not account for all of the\n * rules yet.\n */\nexport default function pairPlayers({\n    players,\n    roundId,\n    roundList,\n    avoidList,\n    byeQueue\n}) {\n    t.Number(roundId);\n    t.dict(Id, Player)(players);\n    t.list(t.Number)(byeQueue);\n    RoundList(roundList);\n    t.list(AvoidPair)(avoidList);\n    const playerIds = Object.keys(players);\n    const playerStatsList = pipe(\n        map((id) => (\n            createPlayerStats({\n                avoidList,\n                id,\n                players,\n                roundId,\n                roundList\n            })\n        )),\n        sortPlayersForPairing,\n        setUpperHalves,\n        curry(setByePlayer)(byeQueue)\n    )(playerIds);\n    // Turn the data into blossom-compatible input.\n    const potentialMatches = playerStatsList.filter(\n        (p) => !p.isDueBye\n    ).reduce(\n        function (acc, player1, ignore, src) {\n            const playerMatches = src.map(\n                (player2) => [\n                    playerIds.indexOf(player1.id),\n                    playerIds.indexOf(player2.id),\n                    calcPairIdeal(player1, player2)\n                ]\n            );\n            return acc.concat(playerMatches);\n        },\n        []\n    );\n    // Feed all of the potential matches to Edmonds-blossom and let the\n    // algorithm work its magic. This returns an array where each index is the\n    // ID of one player and each value is the ID of the matched player.\n    const blossomResults = blossom(potentialMatches);\n    // Translate those IDs into actual pairs of player Ids.\n    const reducedResults = blossomResults.reduce(\n        function (acc, p1Index, p2Index) {\n            // Filter out unmatched players. Blossom will automatically include\n            // their missing IDs in its results.\n            if (p1Index !== -1) {\n                // const p1 = playerStatsList.filter((p) => p.id === p1Id)[0];\n                // const p2 = playerStatsList.filter((p) => p.id === p2Id)[0];\n                // Translate the indices into ID strings\n                const p1Id = playerIds[p1Index];\n                const p2Id = playerIds[p2Index];\n                const p1 = playerStatsList.filter((p) => p.id === p1Id)[0];\n                const p2 = playerStatsList.filter((p) => p.id === p2Id)[0];\n                // const ideal = potentialMatches.filter(\n                //     (pair) => pair[0] === p1Id && pair[1] === p2Id\n                // )[0][2];\n                // Blossom returns a lot of redundant matches. Check that this\n                // matchup wasn't already added.\n                const matched = acc.map((pair) => pair[0]);\n                if (!matched.includes(p1) && !matched.includes(p2)) {\n                    return acc.concat([[p1, p2]]);\n                }\n            }\n            return acc;\n        },\n        []\n    );\n    // Sort by net score and rating for board placement.\n    const sortedResults = sort(\n        firstBy((pair1, pair2) => (\n            pair2[0].score + pair2[1].score - pair1[0].score - pair1[1].score\n        )).thenBy((pair1, pair2) => (\n            pair2[0].rating + pair2[1].rating\n            - pair1[0].rating - pair1[1].rating\n        )),\n        reducedResults\n    );\n    const matches = sortedResults.map(\n        function (pair) {\n            const player1 = pair[0];\n            const player2 = pair[1];\n            const match = [player1.id, player2.id];\n            if (player1.colorBalance < player2.colorBalance) {\n                return reverse(match);\n            }\n            return match;\n        }\n    );\n    // The bye match always gets added last so the the numbering isn't affected.\n    const byePlayer = playerStatsList.filter((p) => p.isDueBye)[0];\n    if (byePlayer) {\n        return matches.concat([[byePlayer.id, DUMMY_ID]]);\n    }\n    return matches;\n}\n","import Alert from \"react-feather/dist/icons/alert-circle\";\nimport ArrowDown from \"react-feather/dist/icons/arrow-down\";\nimport ArrowUp from \"react-feather/dist/icons/arrow-up\";\nimport ArrowUpLeft from \"react-feather/dist/icons/arrow-up-left\";\nimport Check from \"react-feather/dist/icons/check\";\nimport ChevronLeft from \"react-feather/dist/icons/chevron-left\";\nimport ChevronRight from \"react-feather/dist/icons/chevron-right\";\nimport Edit from \"react-feather/dist/icons/edit\";\nimport Info from \"react-feather/dist/icons/info\";\nimport Javascript from \"simple-icons/icons/javascript\";\nimport Layers from \"react-feather/dist/icons/layers\";\nimport List from \"react-feather/dist/icons/list\";\nimport Plus from \"react-feather/dist/icons/plus\";\nimport React from \"react\";\nimport ReactIcon from \"simple-icons/icons/react\";\nimport Repeat from \"react-feather/dist/icons/repeat\";\nimport Settings from \"react-feather/dist/icons/settings\";\nimport Trash from \"react-feather/dist/icons/trash-2\";\nimport UserMinus from \"react-feather/dist/icons/user-minus\";\nimport UserPlus from \"react-feather/dist/icons/user-plus\";\nimport Users from \"react-feather/dist/icons/users\";\nimport X from \"react-feather/dist/icons/x\";\n\nconst simpleIcon = (icon) => (props) => (\n    <span\n        dangerouslySetInnerHTML={{__html: icon.svg}}\n        aria-label={icon.title}\n        role=\"img\"\n        style={{fill: \"#\" + icon.hex}}\n        {...props}\n    />\n);\n\nexport default {\n    Alert,\n    ArrowDown,\n    ArrowUp,\n    ArrowUpLeft,\n    Check,\n    ChevronLeft,\n    ChevronRight,\n    Edit,\n    Info,\n    Javascript: simpleIcon(Javascript),\n    Layers,\n    List,\n    Plus,\n    React: simpleIcon(ReactIcon),\n    Repeat,\n    Settings,\n    Trash,\n    UserMinus,\n    UserPlus,\n    Users,\n    X\n};\n","import {assoc, dissoc} from \"ramda\";\nimport {createPlayer, createTournament} from \"../../data-types\";\nimport nanoid from \"nanoid\";\nimport t from \"tcomb\";\n\nconst ActionLoadState = t.interface({\n    state: t.Any\n});\nconst ActionDelItem = t.interface({\n    id: t.String\n});\nconst ActionAddItem = t.interface({\n    item: t.Any\n});\nconst ActionAddTourney = t.interface({\n    name: t.String\n});\nconst AdctionAddPlayer = t.interface({\n    firstName: t.String,\n    lastName: t.String,\n    rating: t.Number\n});\nconst ActionTypes = t.union([\n    ActionLoadState,\n    ActionDelItem,\n    ActionAddItem,\n    AdctionAddPlayer,\n    ActionAddTourney\n]);\nActionTypes.dispatch = function (x) {\n    const typeToConstructor = {\n        \"ADD_ITEM\": ActionAddItem,\n        \"ADD_PLAYER\": AdctionAddPlayer,\n        \"ADD_TOURNEY\": ActionAddTourney,\n        \"DEL_ITEM\": ActionDelItem,\n        \"LOAD_STATE\": ActionLoadState\n    };\n    return typeToConstructor[x.type];\n};\n\nexport default function genericDbReducer(state, action) {\n    ActionTypes(action);\n    const nextId = nanoid();\n    switch (action.type) {\n    case \"ADD_ITEM\":\n        console.warn(\"Use a more specific action instead, please.\");\n        return assoc(nextId, action.item, state);\n    case \"ADD_TOURNEY\":\n        return assoc(\n            nextId,\n            createTournament({id: nextId, name: action.name}),\n            state\n        );\n    case \"ADD_PLAYER\":\n        return assoc(\n            nextId,\n            createPlayer({\n                firstName: action.firstName,\n                id: nextId,\n                lastName: action.lastName,\n                rating: action.rating\n            }),\n            state\n        );\n    case \"DEL_ITEM\":\n        // If using the player DB, be sure to delete avoid-pairs too.\n        return dissoc(action.id, state);\n    case \"LOAD_STATE\":\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type\");\n    }\n}\n","import {AvoidPair, Id} from \"../../data-types\";\nimport {append, assoc, filter, lensProp, over} from \"ramda\";\nimport t from \"tcomb\";\n\nconst ActionLoadState = t.interface({\n    state: t.Any\n});\nconst ActionSetOption = t.interface({\n    option: t.String,\n    value: t.union([\n        t.Number,\n        t.list(AvoidPair)\n    ])\n});\nconst ActionAvoidPair = t.interface({\n    pair: AvoidPair\n});\nconst ActionAvoidSingle = t.interface({\n    id: Id\n});\nconst ActionTypes = t.union([\n    ActionLoadState,\n    ActionAvoidPair,\n    ActionAvoidSingle\n]);\nActionTypes.dispatch = function (x) {\n    const typeToConstructor = {\n        \"ADD_AVOID_PAIR\": ActionAvoidPair,\n        \"DEL_AVOID_PAIR\": ActionAvoidPair,\n        \"DEL_AVOID_SINGLE\": ActionAvoidSingle,\n        \"LOAD_STATE\": ActionLoadState,\n        \"SET_OPTION\": ActionSetOption\n    };\n    return typeToConstructor[x.type];\n};\n\nexport default function optionsReducer(state, action) {\n    ActionTypes(action);\n    switch (action.type) {\n    case \"ADD_AVOID_PAIR\":\n        return over(\n            lensProp(\"avoidPairs\"),\n            append(action.pair),\n            state\n        );\n    case \"DEL_AVOID_PAIR\":\n        return over(\n            lensProp(\"avoidPairs\"),\n            filter((pair) => !(\n                pair.includes(action.pair[0]) && pair.includes(action.pair[1])\n            )),\n            state\n        );\n    case \"DEL_AVOID_SINGLE\":\n        // call this when you delete a player ID\n        // TODO: make the avoidPairs list smartly auto-clean itself\n        return over(\n            lensProp(\"avoidPairs\"),\n            filter((pair) => !pair.includes(action.id)),\n            state\n        );\n    case \"SET_OPTION\":\n        return assoc(\n            action.option,\n            action.value,\n            state\n        );\n    case \"LOAD_STATE\":\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type.\");\n    }\n}\n\n","import {Id, createPlayer} from \"../../data-types\";\nimport {\n    assoc,\n    dissoc,\n    lensPath,\n    lensProp,\n    mergeLeft,\n    over,\n    set\n} from \"ramda\";\nimport nanoid from \"nanoid\";\nimport t from \"tcomb\";\n\nconst ActionSetPlayer = t.interface({\n    firstName: t.String,\n    id: Id,\n    lastName: t.String,\n    matchCount: t.Number,\n    rating: t.Number\n});\nconst ActionAddPlayer = t.interface({\n    firstName: t.String,\n    lastName: t.String,\n    rating: t.Number\n});\nconst ActionDelPlayer = t.interface({\n    id: Id\n});\nconst ActionSetMatchcount = t.interface({\n    id: Id,\n    matchCount: t.Number\n});\nconst ActionSetRating = t.interface({\n    id: Id,\n    rating: t.Number\n});\nconst ActionLoadState = t.interface({state: t.Any});\nconst ActionTypes = t.union([\n    ActionSetPlayer,\n    ActionAddPlayer,\n    ActionDelPlayer,\n    ActionSetMatchcount,\n    ActionSetRating,\n    ActionLoadState\n]);\nActionTypes.dispatch = function (x) {\n    const typeToConstructor = {\n        \"ADD_PLAYER\": ActionAddPlayer,\n        \"DEL_PLAYER\": ActionDelPlayer,\n        \"LOAD_STATE\": ActionLoadState,\n        \"SET_PLAYER\": ActionSetPlayer,\n        \"SET_PLAYER_MATCHCOUNT\": ActionSetMatchcount,\n        \"SET_PLAYER_RATING\": ActionSetRating\n    };\n    return typeToConstructor[x.type];\n};\n\nexport default function playersReducer(state, action) {\n    ActionTypes(action);\n    const nextId = nanoid();\n    switch (action.type) {\n    case \"ADD_PLAYER\":\n        return assoc(\n            nextId,\n            createPlayer({\n                firstName: action.firstName,\n                id: nextId,\n                lastName: action.lastName,\n                rating: action.rating\n            }),\n            state\n        );\n    case \"SET_PLAYER\":\n        return over(\n            lensProp(action.id),\n            mergeLeft(\n                {\n                    firstName: action.firstName,\n                    lastName: action.lastName,\n                    matchCount: action.matchCount,\n                    rating: action.rating\n                }\n            ),\n            state\n        );\n    case \"DEL_PLAYER\":\n        // You should delete all avoid-pairs with the id too.\n        return dissoc(\n            lensPath(action.id),\n            state\n        );\n    case \"SET_PLAYER_MATCHCOUNT\":\n        return set(\n            lensPath([action.id, \"matchCount\"]),\n            action.matchCount,\n            state\n        );\n    case \"SET_PLAYER_RATING\":\n        return set(\n            lensPath([action.id, \"rating\"]),\n            action.rating,\n            state\n        );\n    case \"LOAD_STATE\":\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type\");\n    }\n}\n","// TODO: this file needs to be replaced with something more organized.\nimport {\n    AvoidPair,\n    BLACK,\n    DUMMY_ID,\n    Id,\n    Player,\n    Tournament,\n    WHITE,\n    createMatch\n} from \"../../data-types\";\nimport {getPlayerMaybe, pairPlayers} from \"../../pairing-scoring\";\nimport {assoc} from \"ramda\";\nimport t from \"tcomb\";\n\nexport function autoPair({\n    avoidList,\n    byeValue,\n    players,\n    roundId,\n    tourney\n}) {\n    t.list(AvoidPair)(avoidList);\n    t.Number(byeValue);\n    Tournament(tourney);\n    t.dict(Id, Player)(players);\n    t.Number(roundId);\n    const roundList = tourney.roundList;\n    const pairs = pairPlayers({\n        avoidList: avoidList,\n        byeQueue: tourney.byeQueue,\n        players,\n        roundId,\n        roundList\n    });\n    console.log(\"pairs\", pairs);\n    console.log(\"players\", players);\n    const getPlayer = (id) => getPlayerMaybe(players, id); // curry\n    const newMatchList = pairs.map(\n        (idsPair) => (\n            createMatch({\n                newRating: [\n                    getPlayer(idsPair[WHITE]).rating,\n                    getPlayer(idsPair[BLACK]).rating\n                ],\n                origRating: [\n                    getPlayer(idsPair[WHITE]).rating,\n                    getPlayer(idsPair[BLACK]).rating\n                ],\n                playerIds: [idsPair[WHITE], idsPair[BLACK]]\n            })\n        )\n    );\n    return newMatchList.reduce(\n        // Set match results for bye matches\n        function (acc, match) {\n            if (match.playerIds[WHITE] === DUMMY_ID) {\n                return acc.concat([assoc(\"result\", [0, byeValue], match)]);\n            }\n            if (match.playerIds[BLACK] === DUMMY_ID) {\n                return acc.concat([assoc(\"result\", [byeValue, 0], match)]);\n            }\n            return acc.concat([match]);\n        },\n        []\n    );\n}\n\nexport function manualPair(pair, byeValue) {\n    t.tuple([Player, Player])(pair);\n    const match = createMatch({\n        newRating: [pair[WHITE].rating, pair[BLACK].rating],\n        origRating: [pair[WHITE].rating, pair[BLACK].rating],\n        playerIds: [pair[WHITE].id, pair[BLACK].id]\n    });\n    if (pair[WHITE].id === DUMMY_ID) {\n        return assoc(\"result\", [0, byeValue], match);\n    }\n    if (pair[BLACK].id === DUMMY_ID) {\n        return assoc(\"result\", [byeValue, 0], match);\n    }\n    return match;\n}\n","import {AvoidPair, Id, Player} from \"../../data-types\";\nimport {\n    __,\n    append,\n    assoc,\n    concat,\n    filter,\n    findIndex,\n    lensPath,\n    lensProp,\n    mergeRight,\n    move,\n    over,\n    pipe,\n    propEq,\n    remove,\n    reverse,\n    set\n} from \"ramda\";\nimport {autoPair, manualPair} from \"./match-functions\";\nimport t from \"tcomb\";\n\nconst ActionAddRound = t.interface({});\nconst ActionDelLastRound = t.interface({});\nconst ActionAddRemoveTieBreak = t.interface({\n    id: t.Number\n});\nconst ActionMoveTieBreak = t.interface({\n    newIndex: t.Number,\n    oldIndex: t.Number\n});\nconst ActionSetTourneyPlayers = t.interface({\n    playerIds: t.list(Id)\n});\nconst ActionSetByeQueue = t.interface({\n    byeQueue: t.list(Id)\n});\nconst ActionAutoPair = t.interface({\n    avoidList: t.list(AvoidPair),\n    byeValue: t.Number,\n    players: t.dict(Id, Player),\n    roundId: t.Number\n});\nconst ActionManualPair = t.interface({\n    byeValue: t.Number,\n    pair: t.tuple([Player, Player]),\n    roundId: t.Number\n});\nconst ActionSetMatchResult = t.interface({\n    matchId: t.String,\n    newRating: t.tuple([t.Number, t.Number]),\n    result: t.tuple([t.Number, t.Number]),\n    roundId: t.Number\n});\nconst ActionEditMatch = t.interface({\n    matchId: t.String,\n    roundId: t.Number\n});\nconst ActionMoveMatch = t.interface({\n    newIndex: t.Number,\n    oldIndex: t.Number,\n    roundId: t.Number\n});\nconst ActionLoadState = t.interface({\n    state: t.Any\n});\nconst ActionTypes = t.union([\n    ActionAddRound,\n    ActionDelLastRound,\n    ActionAddRemoveTieBreak,\n    ActionAddRemoveTieBreak,\n    ActionMoveTieBreak,\n    ActionSetTourneyPlayers,\n    ActionSetByeQueue,\n    ActionAutoPair,\n    ActionManualPair,\n    ActionSetMatchResult,\n    ActionEditMatch,\n    ActionMoveMatch\n]);\nActionTypes.dispatch = function (action) {\n    const typeToConstructor = {\n        \"ADD_ROUND\": ActionAddRound,\n        \"ADD_TIEBREAK\": ActionAddRemoveTieBreak,\n        \"AUTO_PAIR\": ActionAutoPair,\n        \"DEL_LAST_ROUND\": ActionDelLastRound,\n        \"DEL_MATCH\": ActionEditMatch,\n        \"DEL_TIEBREAK\": ActionAddRemoveTieBreak,\n        \"MANUAL_PAIR\": ActionManualPair,\n        \"MOVE_MATCH\": ActionMoveMatch,\n        \"MOVE_TIEBREAK\": ActionMoveTieBreak,\n        \"SET_BYE_QUEUE\": ActionSetByeQueue,\n        \"SET_MATCH_RESULT\": ActionSetMatchResult,\n        \"SET_STATE\": ActionLoadState,\n        \"SET_TOURNEY_PLAYERS\": ActionSetTourneyPlayers,\n        \"SWAP_COLORS\": ActionEditMatch\n    };\n    return typeToConstructor[action.type];\n};\n\nexport default function tournamentReducer(state, action) {\n    ActionTypes(action);\n    switch (action.type) {\n    case \"ADD_ROUND\":\n        return over(\n            lensProp(\"roundList\"),\n            append([]),\n            state\n        );\n    case \"DEL_LAST_ROUND\":\n        return over(\n            lensProp(\"roundList\"),\n            remove(-1, 1),\n            state\n        );\n    case \"ADD_TIEBREAK\":\n        return over(\n            lensProp(\"tieBreaks\"),\n            append(action.id),\n            state\n        );\n    case \"DEL_TIEBREAK\":\n        return over(\n            lensProp(\"tieBreaks\"),\n            filter((id) => id !== action.id),\n            state\n        );\n    case \"MOVE_TIEBREAK\":\n        return over(\n            lensProp(\"tieBreaks\"),\n            move(action.oldIndex, action.newIndex),\n            state\n        );\n    case \"SET_TOURNEY_PLAYERS\":\n        return assoc(\n            \"playerIds\",\n            action.playerIds,\n            state\n        );\n    case \"SET_BYE_QUEUE\":\n        return assoc(\n            \"byeQueue\",\n            action.byeQueue,\n            state\n        );\n    case \"AUTO_PAIR\":\n        return over(\n            lensPath([\"roundList\", action.roundId]),\n            concat(\n                __,\n                autoPair({\n                    avoidList: action.avoidList,\n                    byeValue: action.byeValue,\n                    players: action.players,\n                    roundId: action.roundId,\n                    tourney: state\n                })\n            ),\n            state\n        );\n    case \"MANUAL_PAIR\":\n        return over(\n            lensPath([\"roundList\", action.roundId]),\n            append(manualPair(action.pair, action.byeValue)),\n            state\n        );\n    case \"SET_MATCH_RESULT\":\n        return pipe(\n            set(\n                lensPath([\n                    \"roundList\",\n                    action.roundId,\n                    findIndex(\n                        propEq(\"id\", action.matchId),\n                        state.roundList[action.roundId]\n                    ),\n                    \"result\"\n                ]),\n                action.result\n            ),\n            set(\n                lensPath([\n                    \"roundList\",\n                    action.roundId,\n                    findIndex(\n                        propEq(\"id\", action.matchId),\n                        state.roundList[action.roundId]\n                    ),\n                    \"newRating\"\n                ]),\n                action.newRating,\n            ),\n        )(state);\n    case \"DEL_MATCH\":\n        return over(\n            lensPath([\"roundList\", action.roundId]),\n            filter((match) => match.id !== action.matchId),\n            state\n        );\n    case \"SWAP_COLORS\":\n        return over(\n            lensPath([\n                \"roundList\",\n                action.roundId,\n                findIndex(\n                    propEq(\"id\", action.matchId),\n                    state.roundList[action.roundId]\n                )\n            ]),\n            (match) => mergeRight(\n                match,\n                {\n                    newRating: reverse(match.newRating),\n                    origRating: reverse(match.origRating),\n                    playerIds: reverse(match.playerIds),\n                    result: reverse(match.result)\n                }\n            ),\n            state\n        );\n    case \"MOVE_MATCH\":\n        return over(\n            lensPath([\"roundList\", action.roundId]),\n            move(action.oldIndex, action.newIndex),\n            state\n        );\n    case \"SET_STATE\":\n        console.log(\"setting state:\", action.state);\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type \" + action.type);\n    }\n}\n","import {Id, Player, Tournament} from \"../data-types\";\nimport options from \"./options.json\";\nimport players from \"./players.json\";\nimport t from \"tcomb\";\nimport tournaments from \"./tournaments.json\";\n\nt.dict(t.String, Tournament)(tournaments);\nt.dict(Id, Player)(players);\n\nexport default {\n    options,\n    players,\n    tournaments\n};\n","import \"localforage-getitems\";\nimport {genericDbReducer, optionsReducer} from \"./reducers\";\nimport {useEffect, useReducer, useState} from \"react\";\nimport demoData from \"../demo-data\";\nimport {difference} from \"ramda\";\nimport localForage from \"localforage\";\nimport {extendPrototype as removeItemsPrototype} from \"localforage-removeitems\";\nimport {extendPrototype as setItemsPrototype} from \"localforage-setitems\";\n\n/*******************************************************************************\n * Initialize the databases\n ******************************************************************************/\nsetItemsPrototype(localForage);\nremoveItemsPrototype(localForage);\nconst DATABASE_NAME = \"Chessahoochee\";\nconst optionsStore = localForage.createInstance({\n    name: DATABASE_NAME,\n    storeName: \"Options\"\n});\nconst playerStore = localForage.createInstance({\n    name: DATABASE_NAME,\n    storeName: \"Players\"\n});\nconst tourneyStore = localForage.createInstance({\n    name: DATABASE_NAME,\n    storeName: \"Tournaments\"\n});\n\nexport {optionsStore, playerStore, tourneyStore};\n\nexport function loadDemoDB() {\n    optionsStore.setItems(demoData.options);\n    playerStore.setItems(demoData.players);\n    tourneyStore.setItems(demoData.tournaments);\n    window.alert(\"Demo data loaded!\");\n}\n\n/*******************************************************************************\n * Generic database hooks\n ******************************************************************************/\nfunction useAllItemsFromDb(store) {\n    const [items, dispatch] = useReducer(genericDbReducer, {});\n    const [isLoaded, setIsLoaded] = useState(false);\n    useEffect(\n        function loadItemsFromDb() {\n            store.getItems().then(function (results) {\n                console.log(\"loaded items from\", store._config.storeName);\n                dispatch({state: results, type: \"LOAD_STATE\"});\n                setIsLoaded(true);\n            });\n        },\n        [store]\n    );\n    useEffect(\n        function saveChangesToDb() {\n            if (!isLoaded) {\n                return;\n            }\n            store.setItems(items).then(function () {\n                console.log(\"saved items to\", store._config.storeName);\n            });\n            store.keys().then(function (keys) {\n                const deleted = difference(keys, Object.keys(items));\n                if (deleted.length > 0 ) {\n                    store.removeItems(deleted).then(function () {\n                        console.log(\"Deleted \" + deleted.length + \" items.\");\n                    });\n                }\n            });\n        },\n        [store, items, isLoaded]\n    );\n    return [items, dispatch];\n}\n\n/*******************************************************************************\n * Player & tournament wrapper hooks\n ******************************************************************************/\nexport function useAllPlayersDb() {\n    return useAllItemsFromDb(playerStore);\n}\n\nexport function useAllTournamentsDb() {\n    return useAllItemsFromDb(tourneyStore);\n}\n\n/*******************************************************************************\n * Options database hooks\n ******************************************************************************/\nexport function useOptionsDb() {\n    const [options, dispatch] = useReducer(optionsReducer, demoData.options);\n    const [isLoaded, setIsLoaded] = useState(false);\n    useEffect(\n        function initOptionsFromDb() {\n            optionsStore.iterate(function (value, key) {\n                dispatch({option: key, type: \"SET_OPTION\", value: value});\n            }).then(function () {\n                setIsLoaded(true);\n            });\n        },\n        []\n    );\n    useEffect(\n        function writeChangesToDb() {\n            if (!isLoaded) {\n                return;\n            }\n            optionsStore.setItems(options);\n        },\n        [options, isLoaded]\n    );\n    return [options, dispatch];\n}\n","import React, {\n    createContext,\n    useContext,\n    useEffect,\n    useReducer,\n    useState\n} from \"react\";\nimport {\n    getAllPlayersFromMatches,\n    getPlayerMaybe,\n    rounds2Matches\n} from \"../pairing-scoring\";\nimport {playerStore, tourneyStore} from \"./db\";\nimport {playersReducer, tournamentReducer} from \"./reducers\";\nimport PropTypes from \"prop-types\";\nimport {symmetricDifference} from \"ramda\";\n\nconst TournamentContext = createContext(null);\n\nexport function useTournament() {\n    const state = useContext(TournamentContext);\n    return state;\n}\n\nexport function TournamentProvider({children, tourneyId}) {\n    const [tourney, tourneyDispatch] = useReducer(tournamentReducer, {});\n    const [players, playersDispatch] = useReducer(playersReducer, {});\n    const [isTourneyLoaded, setIsTourneyLoaded] = useState(false);\n    const [isPlayersLoaded, setIsPlayersLoaded] = useState(false);\n    useEffect(\n        function initTourneyFromDb() {\n            tourneyStore.getItem(tourneyId).then(function (value) {\n                console.log(\"loaded:\", tourneyId);\n                tourneyDispatch({state: value, type: \"SET_STATE\"});\n                setIsTourneyLoaded(true);\n            });\n        },\n        [tourneyId]\n    );\n    useEffect(\n        function hydrateTourneyPlayersFromDb() {\n            if (!tourney.roundList || !tourney.playerIds) {\n                return; // the tournament hasn't been loaded yet\n            }\n            // Include players who have played matches but left the tournament,\n            // as well as players who are registered but havne't played yet.\n            const allTheIds = getAllPlayersFromMatches(\n                rounds2Matches(tourney.roundList)\n            ).concat(\n                tourney.playerIds\n            );\n            // If there are no ids, update the player state and exit early.\n            if (allTheIds.length === 0) {\n                // This check prevents an infinite loop & memory leak.\n                if (Object.keys(players).length !== 0) {\n                    playersDispatch({state: {}, type: \"LOAD_STATE\"});\n                }\n                setIsPlayersLoaded(true);\n                return;\n            }\n            playerStore.getItems(allTheIds).then(function (values) {\n                // This safeguards against trying to fetch dummy IDs or IDs from\n                // deleted players. If we updated without this condition, then\n                // this `useEffect` would trigger an infinite loop and a memory\n                // leak.\n                const unChangedPlayers = symmetricDifference(\n                    Object.keys(values),\n                    Object.keys(players)\n                );\n                console.log(\"unchanged players:\", unChangedPlayers);\n                if (unChangedPlayers.length !== 0) {\n                    console.log(\"hydrated player data\");\n                    playersDispatch({state: values, type: \"LOAD_STATE\"});\n                }\n                setIsPlayersLoaded(true);\n            }).catch(function (error) {\n                console.error(\"Couldn't load ids:\", allTheIds);\n                console.error(error);\n            });\n        },\n        [tourney.roundList, players, tourney.playerIds]\n    );\n    useEffect(\n        function saveTourneyToDb() {\n            if (!isTourneyLoaded) {\n                return;\n            }\n            tourneyStore.setItem(tourneyId, tourney).catch(function (error) {\n                console.log(\"error saving tourney:\", tourneyId, error);\n            });\n        },\n        [tourneyId, tourney, isTourneyLoaded]\n    );\n    useEffect(\n        function savePlayersToDb() {\n            if (!isPlayersLoaded) {\n                return;\n            }\n            playerStore.setItems(players).then(function (values) {\n                console.log(\"saved player changes to DB:\", values);\n            }).catch(function (error) {\n                console.log(\"couldn't save players to DB:\", error);\n            });\n        },\n        [players, isPlayersLoaded]\n    );\n    const getPlayer = (id) => getPlayerMaybe(players, id); // curry\n    if (!isTourneyLoaded || !isPlayersLoaded) {\n        return <div>Loading...</div>;\n    }\n    return (\n        <TournamentContext.Provider\n            value={{\n                getPlayer,\n                players,\n                playersDispatch,\n                tourney,\n                tourneyDispatch\n            }}\n        >\n            {children}\n        </TournamentContext.Provider>\n    );\n}\nTournamentProvider.propTypes = {\n    children: PropTypes.node.isRequired,\n    tourneyId: PropTypes.string.isRequired\n};\n","import {\n    TournamentProvider,\n    useTournament\n} from \"./tournament-provider\";\nimport {\n    useAllPlayersDb,\n    useAllTournamentsDb,\n    useOptionsDb\n    // usePlayersDb,\n    // useTournamentDb\n} from \"./db\";\nimport {useEffect} from \"react\";\n\nexport function useDocumentTitle(title) {\n    useEffect(\n        function () {\n            const origTitle = document.title;\n            document.title = \"Chessahoochee: \" + title;\n            return function () {\n                document.title = origTitle;\n            };\n        },\n        [title]\n    );\n}\n\nexport {\n    useAllPlayersDb,\n    useAllTournamentsDb,\n    useOptionsDb,\n    useTournament,\n    TournamentProvider\n};\n","import {\n    createStandingList,\n    getPerformanceRatings,\n    getResultsByOpponent,\n    rounds2Matches\n} from \"../../pairing-scoring\";\nimport Icons from \"../icons\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport {assoc} from \"ramda\";\nimport numeral from \"numeral\";\nimport style from \"./scores.module.css\";\nimport {useTournament} from \"../../hooks\";\n\nexport default function Crosstable(props) {\n    const {tourney, getPlayer} = useTournament();\n    const {tieBreaks, roundList} = tourney;\n    const matches = rounds2Matches(roundList);\n    const oppResults = (id) => getResultsByOpponent(matches, id); // curry\n    const [standings] = createStandingList(tieBreaks, roundList);\n    const opponentScores = standings.reduce(\n        (acc, {id}) => assoc(id, oppResults(id), acc),\n        {}\n    );\n\n    function getXScore(player1Id, player2Id) {\n        if (player1Id === player2Id) {\n            return <Icons.X/>;\n        }\n        const result = opponentScores[player1Id][player2Id];\n        if (result === undefined) {\n            return null;\n        }\n        return numeral(result).format(\"1/2\");\n    }\n\n    function getRatingChange(playerId) {\n        const [\n            firstRating,\n            lastRating\n        ] = getPerformanceRatings(matches, playerId);\n        const change = numeral(lastRating - firstRating).format(\"+0\");\n        return `${lastRating}\\xA0(${change})`; // \\xA0 = &nsbp;\n    }\n\n    return (\n        <table className={style.table}>\n            <caption>Crosstable</caption>\n            <tbody>\n                <tr>\n                    <th>Rank</th>\n                    <th>Name</th>\n                    {/* Display a rank as a shorthand for each player. */}\n                    {Object.keys(standings).map((rank) =>\n                        <th key={rank}>\n                            {Number(rank) + 1}\n                        </th>\n                    )}\n                    <th>Score</th>\n                    <th>Rating</th>\n                </tr>\n                {/* Output a row for each player */}\n                {standings.map((standing, index)=>\n                    <tr key={index} className={style.row}>\n                        <th className={style.rank} scope=\"col\">\n                            {index + 1}\n                        </th>\n                        <th className={style.playerName} scope=\"row\">\n                            {getPlayer(standing.id).firstName}&nbsp;\n                            {getPlayer(standing.id).lastName}\n                        </th>\n                        {/* Output a cell for each other player */}\n                        {standings.map((opponent, index2) =>\n                            <td key={index2} className=\"table__number\">\n                                {getXScore(standing.id, opponent.id)}\n                            </td>\n                        )}\n                        {/* Output their score and rating change */}\n                        <td className=\"table__number\">\n                            {numeral(standing.score).format(\"1/2\")}\n                        </td>\n                        <td className=\"table__number\">\n                            {getRatingChange(standing.id)}\n                        </td>\n                    </tr>\n                )}\n            </tbody>\n        </table>\n    );\n}\nCrosstable.propTypes = {\n    tourneyId: PropTypes.string\n};\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport styles from \"./utility.module.css\";\n// import {usePlayers} from \"../state\";\n\nexport const Button = ({children, action}) => (\n    <button onClick={action}>\n        {children}\n    </button>\n);\nButton.propTypes = {\n    action: PropTypes.func.isRequired,\n    children: PropTypes.node.isRequired\n};\n\nexport const BackButton = ({action}) => (\n    <Button action={action}>&lt; Back</Button>\n);\nBackButton.propTypes = {\n    action: PropTypes.func.isRequired\n};\n\nexport const OpenButton = ({action}) => (\n    <Button action={action}>Open &gt;</Button>\n);\nOpenButton.propTypes = {\n    action: PropTypes.func.isRequired\n};\n\nexport function Panel({children, style}) {\n    return (\n        <div className={styles.panel} style={{...style}}>\n            {children}\n        </div>\n    );\n}\nPanel.propTypes = {\n    children: PropTypes.node.isRequired,\n    style: PropTypes.object\n};\n\nexport function PanelContainer(props) {\n    return (\n        <div {...props} className={styles.panels}>\n            {props.children}\n            {/* {React.Children.map(props.children, (child) => child)} */}\n        </div>\n    );\n}\nPanelContainer.propTypes = {\n    children: PropTypes.node.isRequired\n};\n\n// export function PlayerLink({id, firstName, lastName}) {\n//     const {getPlayer} = usePlayers();\n//     const player = getPlayer(id);\n//     const name = (function () {\n//         if (firstName && lastName) {\n//             return player.firstName + \" \" + player.lastName;\n//         } else if (firstName && !lastName) {\n//             return player.firstName;\n//         } else if (!firstName && lastName) {\n//             return player.lastName;\n//         } else {\n//             return null;\n//         }\n//     }());\n//     if (id === DUMMY_ID) { // there's no bye player profile\n//         return name;\n//     }\n//     if (!name) {\n//         return null;\n//     }\n//     return (\n//         <Link to={\"/players/\" + id}>\n//             {firstName && getPlayer(id).firstName}{\" \"}\n//             {lastName && getPlayer(id).lastName}\n//         </Link>\n//     );\n// }\n// PlayerLink.propTypes = {\n//     firstName: PropTypes.bool,\n//     id: PropTypes.number.isRequired,\n//     lastName: PropTypes.bool\n// };\n\n/*******************************************************************************\n * Non-JSX functions\n ******************************************************************************/\nexport function findById(id, list) {\n    return list.filter((x) => x.id === id)[0];\n}\n\nexport function findIndexById(id, list) {\n    return list.indexOf(findById(id, list));\n}\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {assoc} from \"ramda\";\n\nexport default function NewPlayer({dispatch}) {\n    const newPlayerDefault = {firstName: \"\", lastName: \"\", rating: 1200};\n    const [newPlayerData, setNewPlayerdata] = useState(newPlayerDefault);\n\n    const handleSubmit = function (event) {\n        event.preventDefault();\n        const {firstName, lastName, rating} = newPlayerData;\n        setNewPlayerdata(newPlayerDefault);\n        dispatch({firstName, lastName, rating, type: \"ADD_PLAYER\"});\n    };\n\n    const updateField = function (event) {\n        event.preventDefault();\n        const {name, value} = event.currentTarget;\n        setNewPlayerdata((prevState) => assoc(name, value, prevState));\n    };\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <fieldset>\n                <legend>Register a new player</legend>\n                <p>\n                    <label htmlFor=\"firstName\">First name</label>\n                    <input\n                        name=\"firstName\"\n                        type=\"text\"\n                        value={newPlayerData.firstName}\n                        required\n                        onChange={updateField}\n                    />\n                </p>\n                <p>\n                    <label htmlFor=\"lastName\">Last name</label>\n                    <input\n                        name=\"lastName\"\n                        type=\"text\"\n                        value={newPlayerData.lastName}\n                        required\n                        onChange={updateField}\n                    />\n                </p>\n                <p>\n                    <label htmlFor=\"rating\">Rating</label>\n                    <input\n                        name=\"rating\"\n                        type=\"number\"\n                        value={newPlayerData.rating}\n                        required\n                        onChange={updateField}\n                    />\n                </p>\n                <p>\n                    <input type=\"submit\" value=\"Add\"/>\n                </p>\n            </fieldset>\n        </form>\n    );\n}\nNewPlayer.propTypes = {\n    dispatch: PropTypes.func.isRequired\n};\n","import {useAllPlayersDb, useTournament} from \"../../../hooks\";\nimport NewPlayer from \"../../new-player\";\nimport React from \"react\";\n\nexport default function Selecting(props) {\n    const {tourney, tourneyDispatch} = useTournament();\n    const [players, allPlayersDispatch] = useAllPlayersDb();\n\n    function togglePlayer(event) {\n        const id = event.target.value;\n        if (event.target.checked) {\n            tourneyDispatch({\n                playerIds: tourney.playerIds.concat([id]),\n                type: \"SET_TOURNEY_PLAYERS\"\n            });\n        } else {\n            tourneyDispatch({\n                playerIds: tourney.playerIds.filter((pId) => pId !== id),\n                type: \"SET_TOURNEY_PLAYERS\"\n            });\n        }\n    }\n\n    return (\n        <div>\n            <button\n                className=\"micro\"\n                onClick={() => tourneyDispatch({\n                    playerIds: Object.keys(players),\n                    type: \"SET_TOURNEY_PLAYERS\"\n                })}\n            >\n                Select all\n            </button>\n            <button\n                className=\"micro\"\n                onClick={() => tourneyDispatch({\n                    playerIds: [],\n                    type: \"SET_TOURNEY_PLAYERS\"\n                })}\n            >\n                Select none\n            </button>\n            <table>\n                <caption>Select players</caption>\n                <thead>\n                    <tr>\n                        <th>First name</th>\n                        <th>Last name</th>\n                        <th>Select</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {Object.values(players).map(({id, firstName, lastName}) =>\n                        <tr key={id}>\n                            <td>{firstName}</td>\n                            <td>{lastName}</td>\n                            <td>\n                                <input\n                                    checked={tourney.playerIds.includes(id)}\n                                    type=\"checkbox\"\n                                    value={id}\n                                    onChange={togglePlayer}\n                                />\n                            </td>\n                        </tr>\n                    )}\n                </tbody>\n            </table>\n            <NewPlayer dispatch={allPlayersDispatch}/>\n        </div>\n    );\n}\nSelecting.propTypes = {};\n","import {Panel, PanelContainer} from \"../../utility\";\nimport React, {useState} from \"react\";\nimport {hasHadBye, rounds2Matches} from \"../../../pairing-scoring\";\nimport {Dialog} from \"@reach/dialog\";\nimport Icons from \"../../icons\";\nimport Selecting from \"./selecting\";\nimport {useTournament} from \"../../../hooks\";\n\nexport default function PlayerSelect(props) {\n    const {tourney, tourneyDispatch, players} = useTournament();\n    const {playerIds, roundList, byeQueue} = tourney;\n    const dispatch = tourneyDispatch;\n    const [isSelecting, setIsSelecting] = useState(playerIds.length === 0);\n    const matches = rounds2Matches(roundList);\n    return (\n        <PanelContainer>\n            <Panel>\n                <button onClick={() => setIsSelecting(true)}>\n                    <Icons.Edit /> Edit player roster\n                </button>\n                <table>\n                    <caption>Current roster</caption>\n                    <thead>\n                        <tr>\n                            <th colSpan={2}>Name</th>\n                            <th>Options</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {Object.values(players).map(\n                            ({type, id, firstName, lastName}) => (\n                                <tr key={id} className={type + \" player\"}>\n                                    <td>{firstName}</td>\n                                    <td>{lastName}</td>\n                                    <td>\n                                        <button\n                                            disabled={byeQueue.includes(id)}\n                                            onClick={() =>\n                                                dispatch({\n                                                    byeQueue:\n                                                        byeQueue.concat([id]),\n                                                    type: \"SET_BYE_QUEUE\"\n                                                })\n                                            }\n                                        >\n                                            Bye signup\n                                        </button>\n                                    </td>\n                                </tr>\n                            )\n                        )}\n                    </tbody>\n                </table>\n            </Panel>\n            <Panel>\n                <h3>Bye queue</h3>\n                {byeQueue.length === 0 &&\n                    <p>No players have signed up for a bye round.</p>\n                }\n                <ol>\n                    {byeQueue.map((pId) => (\n                        <li\n                            key={pId}\n                            className={\n                                (hasHadBye(pId, matches))\n                                ? \"disabled\"\n                                : \"\"\n                            }\n                        >\n                            {players[pId].firstName}{\" \"}\n                            {players[pId].lastName}\n                            <button\n                                onClick={() =>\n                                    dispatch({\n                                        byeQueue: byeQueue.filter(\n                                            (id) => pId !== id\n                                        ),\n                                        type: \"SET_BYE_QUEUE\"\n                                    })\n                                }\n                            >\n                                Remove\n                            </button>\n                        </li>\n                    ))}\n                </ol>\n            </Panel>\n            <Dialog isOpen={isSelecting}>\n                <button\n                    className=\"micro button-primary\"\n                    onClick={() => setIsSelecting(false)}\n                >\n                    Done\n                </button>\n                <Selecting />\n            </Dialog>\n        </PanelContainer>\n    );\n}\nPlayerSelect.propTypes = {};\n","// this component should eventually replace player-match-info.jsx\nimport {useOptionsDb, useTournament} from \"../../../hooks\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport {createPlayerStats} from \"../../../pairing-scoring\";\n\nexport default function PlayerInfo({playerId, roundId}) {\n    const {tourney, players} = useTournament();\n    const [options] = useOptionsDb();\n    const {\n        profile,\n        rating,\n        score,\n        colorBalance,\n        hasHadBye,\n        opponentHistory,\n        avoidList\n    } = createPlayerStats({\n        avoidList: options.avoidPairs,\n        id: playerId,\n        players,\n        roundId,\n        roundList: tourney.roundList\n    });\n    const prettyBalance = (function () {\n        if (colorBalance < 0) {\n            return \"White +\" + Math.abs(colorBalance);\n        } else if (colorBalance > 0) {\n            return \"Black +\" + colorBalance;\n        } else {\n            return \"Even\";\n        }\n    }());\n    return (\n        <dl className=\"player-card\">\n            <h3>\n                {profile.firstName} {profile.lastName}\n            </h3>\n            <p>Score: {score}</p>\n            <p>Rating: {rating}</p>\n            <p>Color balance: {prettyBalance}</p>\n            <p>Has had a bye round: {hasHadBye ? \"Yes\" : \"No\"}</p>\n            <p>Opponent history:</p>\n            <ol>\n                {opponentHistory.map((opId) => (\n                    <li key={opId}>\n                        {players[opId].firstName}{\" \"}\n                        {players[opId].lastName}\n                    </li>\n                ))}\n            </ol>\n            <p>\n                Players to avoid:\n            </p>\n            <ol>\n                {avoidList.map((pId) => (\n                    <li key={pId}>\n                        {players[pId].firstName} {players[pId].lastName}\n                    </li>\n                ))}\n            </ol>\n        </dl>\n    );\n}\nPlayerInfo.propTypes = {\n    playerId: PropTypes.string,\n    roundId: PropTypes.number\n};\n","import {BLACK, DUMMY_ID, WHITE, dummyPlayer} from \"../../../data-types\";\nimport {assoc, lensIndex, set} from \"ramda\";\nimport Hidden from \"@reach/visually-hidden\";\nimport Icons from \"../../icons\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport {getUnmatched} from \"../../../pairing-scoring\";\nimport {useTournament} from \"../../../hooks\";\n\nexport default function SelectList({roundId, stagedPlayers, setStagedPlayers}) {\n    const {tourney, players} = useTournament();\n    // only use unmatched players if this is the last round.\n    const unmatched = (roundId === tourney.roundList.length - 1)\n        ? getUnmatched(tourney, players, roundId)\n        : {};\n\n    function selectPlayer(id) {\n        if (stagedPlayers[WHITE] === null) {\n            setStagedPlayers(\n                (prevState) => set(lensIndex(WHITE), id, prevState)\n            );\n        } else if (stagedPlayers[BLACK] === null) {\n            setStagedPlayers(\n                (prevState) => set(lensIndex(BLACK), id, prevState)\n            );\n        }\n        // else... nothing happens\n    }\n\n    const unmatchedCount = Object.keys(unmatched).length;\n\n    // make a new list so as not to affect auto-pairing\n    const unmatchedWithDummy = (\n        (unmatchedCount % 2 !== 0)\n        ? assoc(DUMMY_ID, dummyPlayer, unmatched)\n        : unmatched\n    );\n    if (unmatchedCount === 0) {\n        return null;\n    }\n    return (\n        <div>\n            <ul>\n                {Object.values(unmatchedWithDummy).map(\n                    ({id, firstName, lastName}) => (\n                        <li key={id}>\n                            <button\n                                className=\"ghost\"\n                                disabled={\n                                    !stagedPlayers.includes(null)\n                                    || stagedPlayers.includes(id)\n                                }\n                                onClick={() => selectPlayer(id)}\n                            >\n                                <Icons.UserPlus/>\n                                <Hidden>\n                                    Select {firstName} {lastName}\n                                </Hidden>\n                            </button>\n                            {\" \"}\n                            {firstName} {lastName}\n                        </li>\n                    )\n                )}\n            </ul>\n        </div>\n    );\n}\nSelectList.propTypes = {\n    roundId: PropTypes.number,\n    setStagedPlayers: PropTypes.func,\n    stagedPlayers: PropTypes.arrayOf(PropTypes.string)\n};\n","import {BLACK, WHITE} from \"../../../data-types\";\nimport React, {Fragment} from \"react\";\nimport {lensIndex, set} from \"ramda\";\nimport {useOptionsDb, useTournament} from \"../../../hooks\";\nimport Icons from \"../../icons\";\nimport PropTypes from \"prop-types\";\n\nexport default function Stage({\n    roundId,\n    stagedPlayers,\n    setStagedPlayers\n}) {\n    const {tourneyDispatch, players} = useTournament();\n    const dispatch = tourneyDispatch;\n    const [options] = useOptionsDb();\n    const [white, black] = stagedPlayers;\n\n    function unstage(color) {\n        setStagedPlayers((prevState) => set(lensIndex(color), null, prevState));\n    }\n\n    function match() {\n        dispatch({\n            byeValue: options.byeValue,\n            pair: [players[white], players[black]],\n            roundId,\n            type: \"MANUAL_PAIR\"\n        });\n        setStagedPlayers([null, null]);\n    }\n\n    return (\n        <div>\n            <h2>Selected for matching:</h2>\n            <p>\n                White:{\" \"}\n                {white !== null &&\n                    <Fragment>\n                        {players[white].firstName}{\" \"}\n                        {players[white].lastName}{\" \"}\n                        <button onClick={() => unstage(WHITE)}>\n                            <Icons.UserMinus /> Remove\n                        </button>\n                    </Fragment>\n                }\n            </p>\n            <p>\n                Black:{\" \"}\n                {black !== null &&\n                    <Fragment>\n                        {players[black].firstName}{\" \"}\n                        {players[black].lastName}{\" \"}\n                        <button onClick={() => unstage(BLACK)}>\n                            <Icons.UserMinus /> Remove\n                        </button>\n                    </Fragment>\n                }\n            </p>\n            <button\n                disabled={\n                    stagedPlayers.every((id) => id === null)\n                }\n                onClick={() => setStagedPlayers(\n                    (prevState) => ([prevState[BLACK], prevState[WHITE]])\n                )}\n            >\n                <Icons.Repeat/> Swap colors\n            </button>{\" \"}\n            <button\n                disabled={stagedPlayers.includes(null)}\n                onClick={match}\n            >\n                <Icons.Check/> Match selected\n            </button>{\" \"}\n        </div>\n    );\n}\nStage.propTypes = {\n    roundId: PropTypes.number,\n    setStagedPlayers: PropTypes.func,\n    stagedPlayers: PropTypes.arrayOf(PropTypes.string)\n};\n","import {Panel, PanelContainer} from \"../../utility\";\nimport React, {useState} from \"react\";\nimport {\n    calcPairIdeal,\n    createPlayerStats,\n    maxPriority,\n    setUpperHalves,\n    sortPlayersForPairing\n} from \"../../../pairing-scoring\";\nimport {map, pipe} from \"ramda\";\nimport {useOptionsDb, useTournament} from \"../../../hooks\";\nimport {Dialog} from \"@reach/dialog\";\nimport PlayerInfo from \"./player-info\";\nimport PropTypes from \"prop-types\";\nimport SelectList  from \"./select-list\";\nimport Selecting from \"../player-select/selecting\";\nimport Stage from \"./stage\";\nimport {findById} from \"../../utility\";\nimport {getUnmatched} from \"../../../pairing-scoring\";\nimport numeral from \"numeral\";\n\nexport default function PairPicker({roundId}) {\n    const [stagedPlayers, setStagedPlayers] = useState([null, null]);\n    const [options] = useOptionsDb();\n    const {tourney, players, tourneyDispatch} = useTournament();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const statsList = React.useMemo(\n        () => (\n            pipe(\n                Object.values,\n                map((player) => (\n                    createPlayerStats({\n                        avoidList: options.avoidPairs,\n                        id: player.id,\n                        players,\n                        roundId,\n                        roundList: tourney.roundList\n                    })\n                )),\n                sortPlayersForPairing,\n                setUpperHalves\n            )(players)\n        ),\n        [\n            tourney.roundList,\n            roundId,\n            options.avoidPairs,\n            players\n        ]\n    );\n    const matchIdeal = React.useMemo(\n        function () {\n            if (stagedPlayers.includes(null)) {\n                return null;\n            }\n            const player0stats = findById(stagedPlayers[0], statsList);\n            const player1stats = findById(stagedPlayers[1], statsList);\n            const ideal = calcPairIdeal(player0stats, player1stats);\n            return numeral(ideal / maxPriority).format(\"%\");\n        },\n        [stagedPlayers, statsList]\n    );\n    const unmatched = (roundId === tourney.roundList.length - 1)\n        ? getUnmatched(tourney, players, roundId)\n        : {};\n    const unmatchedCount = Object.keys(unmatched).length;\n    return (\n        <div>\n            <div className=\"toolbar\">\n                <button\n                    className=\"button-primary\"\n                    disabled={unmatchedCount === 0}\n                    onClick={() => tourneyDispatch({\n                        avoidList: options.avoidPairs,\n                        byeValue: options.byeValue,\n                        players: unmatched,\n                        roundId,\n                        type: \"AUTO_PAIR\"\n                    })}\n                >\n                    Auto-pair unmatched players\n                </button>{\" \"}\n                <button onClick={() => setIsModalOpen(true)}>\n                    Add or remove players from the roster.\n                </button>\n            </div>\n            <PanelContainer>\n                <Panel>\n                    <SelectList\n                        roundId={roundId}\n                        setStagedPlayers={setStagedPlayers}\n                        stagedPlayers={stagedPlayers}\n                    />\n                </Panel>\n                <Panel>\n                    <Stage\n                        roundId={roundId}\n                        setStagedPlayers={setStagedPlayers}\n                        stagedPlayers={stagedPlayers}\n                    />\n                    <PanelContainer>\n                        {stagedPlayers.map((id) =>\n                            id !== null && (\n                                <Panel key={id}>\n                                    <PlayerInfo\n                                        playerId={id}\n                                        roundId={roundId}\n                                    />\n                                </Panel>\n                            )\n                        )}\n                    </PanelContainer>\n                    Match ideal: {matchIdeal}\n                </Panel>\n            </PanelContainer>\n            <Dialog isOpen={isModalOpen}>\n                <button\n                    className=\"micro\"\n                    onClick={() => setIsModalOpen(false)}\n                >\n                    Done\n                </button>\n                <Selecting />\n            </Dialog>\n        </div>\n    );\n}\nPairPicker.propTypes = {\n    roundId: PropTypes.number,\n    tourneyId: PropTypes.number\n};\n","import {useOptionsDb, useTournament} from \"../../../hooks\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport {createPlayerStats} from \"../../../pairing-scoring\";\nimport {findById} from \"../../utility\";\nimport numeral from \"numeral\";\n\nexport default function PlayerMatchInfo({matchId, color, roundId}) {\n    const {tourney, players, getPlayer} = useTournament();\n    const matchList = tourney.roundList[roundId];\n    const [options] = useOptionsDb();\n    const match = findById(matchId, matchList);\n    const playerData = createPlayerStats({\n        avoidList: options.avoidPairs,\n        id: match.playerIds[color],\n        players,\n        roundId,\n        roundList: tourney.roundList\n    });\n    const colorBalance = playerData.colorBalance;\n    const prettyBalance = (function () {\n        if (colorBalance < 0) {\n            return \"White +\" + Math.abs(colorBalance);\n        } else if (colorBalance > 0) {\n            return \"Black +\" + colorBalance;\n        } else {\n            return \"Even\";\n        }\n    }());\n    return (\n        <dl className=\"player-card\">\n            <h3>\n                {playerData.profile.firstName} {playerData.profile.lastName}\n            </h3>\n            <dt>Score</dt>\n            <dd>{playerData.score}</dd>\n            <dt>Rating</dt>\n            <dd data-testid={`rating-${playerData.id}`}>\n                {match.origRating[color]} (\n                {numeral(\n                    match.newRating[color] - match.origRating[color]\n                ).format(\"+0\")}\n                )\n            </dd>\n            <dt>Color balance</dt>\n            <dd>{prettyBalance}</dd>\n            <dt>Has had a bye round</dt>\n            <dd>{playerData.hasHadBye ? \"Yes\" : \"No\"}</dd>\n            <dt>Opponent history</dt>\n            <dd>\n                <ol>\n                    {playerData.opponentHistory.map((opId) => (\n                        <li key={opId}>\n                            {getPlayer(opId).firstName}{\" \"}\n                            {getPlayer(opId).lastName}\n                        </li>\n                    ))}\n                </ol>\n            </dd>\n        </dl>\n    );\n}\nPlayerMatchInfo.propTypes = {\n    color: PropTypes.number,\n    matchId: PropTypes.string,\n    roundId: PropTypes.number\n};\n","import \"@reach/dialog/styles.css\";\nimport {BLACK, DUMMY_ID, WHITE} from \"../../../data-types\";\nimport {Panel, PanelContainer} from \"../../utility\";\nimport React, {useState} from \"react\";\nimport {Dialog} from \"@reach/dialog\";\nimport Hidden from \"@reach/visually-hidden\";\nimport Icons from \"../../icons\";\nimport PlayerMatchInfo from \"./player-match-info\";\nimport PropTypes from \"prop-types\";\nimport {calcNewRatings} from \"../../../pairing-scoring\";\nimport {useTournament} from \"../../../hooks\";\nimport {winnerSelect} from \"./round.module.css\";\n\nexport default function MatchRow({\n    pos,\n    match,\n    roundId,\n    selectedMatch,\n    setSelectedMatch\n}) {\n    const {\n        tourney,\n        tourneyDispatch,\n        players,\n        getPlayer,\n        playersDispatch\n    } = useTournament();\n    const dispatch = tourneyDispatch;\n    const [openModal, setOpenModal] = useState(false);\n    const resultCode = (function () {\n        if (match.result[0] > match.result[1]) {\n            return \"WHITE\";\n        } else if (match.result[1] > match.result[0]) {\n            return \"BLACK\";\n        } else if (match.result.every((x) => x === 0.5)) {\n            return \"DRAW\";\n        } else {\n            return \"NOTSET\";\n        }\n    }());\n    const whitePlayer = getPlayer(match.playerIds[WHITE]);\n    const blackPlayer = getPlayer(match.playerIds[BLACK]);\n    const whiteName = whitePlayer.firstName + \" \" + whitePlayer.lastName;\n    const blackName = blackPlayer.firstName + \" \" + blackPlayer.lastName;\n\n    function setMatchResult(event) {\n        const result = (function () {\n            switch (event.target.value) {\n            case \"WHITE\":\n                return [1, 0];\n            case \"BLACK\":\n                return [0, 1];\n            case \"DRAW\":\n                return [0.5, 0.5];\n            case \"NOTSET\":\n                return [0, 0];\n            default:\n                throw new Error();\n            }\n        }());\n        const white = players[match.playerIds[WHITE]];\n        const black = players[match.playerIds[BLACK]];\n        const newRating = (\n            (event.currentTarget.value === \"NOTSET\")\n            ? match.origRating\n            : calcNewRatings(\n                match.origRating,\n                [white.matchCount, black.matchCount],\n                result\n            )\n        );\n        playersDispatch({\n            id: white.id,\n            rating: newRating[WHITE],\n            type: \"SET_PLAYER_RATING\"\n        });\n        playersDispatch({\n            id: black.id,\n            rating: newRating[BLACK],\n            type: \"SET_PLAYER_RATING\"\n        });\n        // if the result hasn't been scored yet, increment the matchCount\n        if (match.result.reduce((a, b) => a + b) === 0) {\n            playersDispatch({\n                id: white.id,\n                matchCount: white.matchCount + 1,\n                type: \"SET_PLAYER_MATCHCOUNT\"\n            });\n            playersDispatch({\n                id: black.id,\n                matchCount: black.matchCount + 1,\n                type: \"SET_PLAYER_MATCHCOUNT\"\n            });\n        }\n        dispatch({\n            matchId: match.id,\n            newRating,\n            result,\n            roundId,\n            type: \"SET_MATCH_RESULT\"\n        });\n    }\n\n    return (\n        <tr className={match.id === selectedMatch ? \"selected\" : \"\"}>\n            <th className=\"table__number row__id\" scope=\"row\">{pos + 1}</th>\n            <td\n                className={\"table__player row__player \" + whitePlayer.type}\n                data-testid={`match-${pos}-white`}\n            >\n                {whiteName}{\" \"}\n                {resultCode === \"WHITE\" && (\n                    <span role=\"img\" aria-hidden>\n                        \n                    </span>\n                )}\n            </td>\n            <td\n                className={\"table__player row__player \" + blackPlayer.type}\n                data-testid={`match-${pos}-black`}\n            >\n                {blackName}{\" \"}\n                {resultCode === \"BLACK\" && (\n                    <span role=\"img\" aria-hidden>\n                        \n                    </span>\n                )}\n            </td>\n            <td className=\"data__input row__controls\">\n                <select\n                    className={winnerSelect}\n                    disabled={match.playerIds.includes(DUMMY_ID)}\n                    value={resultCode}\n                    onBlur={setMatchResult}\n                    onChange={setMatchResult}\n                >\n                    <option value=\"NOTSET\">\n                        Select a winner\n                    </option>\n                    <option value=\"WHITE\">\n                        {whiteName} won\n                    </option>\n                    <option value=\"BLACK\">\n                        {blackName} won\n                    </option>\n                    <option value=\"DRAW\">\n                        Draw\n                    </option>\n                </select>\n            </td>\n            <td className=\"data__input row__controls\">\n                {(selectedMatch !== match.id)\n                ? (\n                    <button\n                        className=\"ghost\"\n                        title=\"Edit match\"\n                        onClick={() => setSelectedMatch(match.id)}\n                    >\n                        <Icons.Edit />\n                    </button>\n                ) : (\n                    <button\n                        className=\"ghost\"\n                        title=\"End editing match\"\n                        onClick={() => setSelectedMatch(null)}\n                    >\n                        <Icons.Check />\n                    </button>\n                )}\n                <button\n                    className=\"ghost\"\n                    title=\"Open match information.\"\n                    onClick={() => setOpenModal(true)}\n                >\n                    <Icons.Info />\n                    <Hidden>\n                        View information for match:{\" \"}\n                        {whiteName} versus {blackName}\n                    </Hidden>\n                </button>\n                <Dialog isOpen={openModal}>\n                    <button\n                        className=\"micro button-primary\"\n                        onClick={() => setOpenModal(false)}\n                    >\n                        close\n                    </button>\n                    <p>{tourney.name}</p>\n                    <p>Round {roundId + 1}, match {pos + 1}</p>\n                    <PanelContainer>\n                        <Panel>\n                            <PlayerMatchInfo\n                                color={0}\n                                matchId={match.id}\n                                roundId={roundId}\n                            />\n                        </Panel>\n                        <Panel>\n                            <PlayerMatchInfo\n                                color={1}\n                                matchId={match.id}\n                                roundId={roundId}\n                            />\n                        </Panel>\n                    </PanelContainer>\n                </Dialog>\n            </td>\n        </tr>\n    );\n}\nMatchRow.propTypes = {\n    match: PropTypes.object,\n    pos: PropTypes.number,\n    roundId: PropTypes.number,\n    selectedMatch: PropTypes.string,\n    setSelectedMatch: PropTypes.func,\n    tourneyId: PropTypes.number\n};\n","import React, {useState} from \"react\";\nimport {findById, findIndexById} from \"../../utility\";\nimport Icons from \"../../icons\";\nimport MatchRow from \"./match-row\";\nimport PropTypes from \"prop-types\";\nimport style from \"./round.module.css\";\nimport {useTournament} from \"../../../hooks\";\n\nexport default function Round({roundId}) {\n    const {\n        tourney,\n        players,\n        tourneyDispatch,\n        playersDispatch\n    } = useTournament();\n    const matchList = tourney.roundList[roundId];\n    const [selectedMatch, setSelectedMatch] = useState(null);\n    if (!matchList) {\n        throw new Error(\"Round \" + roundId + \" does not exist.\");\n    }\n    function unMatch(matchId) {\n        const match = findById(matchId, matchList);\n        if (match.result.reduce((a, b) => a + b) !== 0) {\n            // checks if the match has been scored yet & resets the players'\n            // records\n            match.playerIds.forEach(function (pId, color) {\n                playersDispatch({\n                    id: pId,\n                    matchCount: players[pId].matchCount - 1,\n                    type: \"SET_PLAYER_MATCHCOUNT\"\n                });\n                playersDispatch({\n                    id: pId,\n                    rating: match.origRating[color],\n                    type: \"SET_PLAYER_RATING\"\n                });\n            });\n        }\n        tourneyDispatch({matchId, roundId, type: \"DEL_MATCH\"});\n        setSelectedMatch(null);\n    }\n\n    function swapColors(matchId) {\n        tourneyDispatch({matchId, roundId, type: \"SWAP_COLORS\"});\n    }\n\n    function moveMatch(matchId, direction) {\n        const oldIndex = findIndexById(matchId, matchList);\n        const newIndex = (oldIndex + direction >= 0) ? oldIndex + direction : 0;\n        tourneyDispatch({newIndex, oldIndex, roundId, type: \"MOVE_MATCH\"});\n    }\n\n    return (\n        <div>\n            <div className=\"toolbar\">\n                <button\n                    className=\"danger iconButton\"\n                    disabled={selectedMatch === null}\n                    onClick={() => unMatch(selectedMatch)}\n                >\n                    <Icons.Trash /> Unmatch\n                </button>{\" \"}\n                <button\n                    className=\"iconButton\"\n                    disabled={selectedMatch === null}\n                    onClick={() => swapColors(selectedMatch)}\n                >\n                    <Icons.Repeat /> Swap colors\n                </button>{\" \"}\n                <button\n                    className=\"iconButton\"\n                    disabled={selectedMatch === null}\n                    onClick={() => moveMatch(selectedMatch, -1)}\n                >\n                    <Icons.ArrowUp /> Move up\n                </button>{\" \"}\n                <button\n                    className=\"iconButton\"\n                    disabled={selectedMatch === null}\n                    onClick={() => moveMatch(selectedMatch, 1)}\n                >\n                    <Icons.ArrowDown /> Move down\n                </button>\n            </div>\n            {matchList.length === 0 &&\n                <p>No players matched yet.</p>\n            }\n            <table className={style.table}>\n                {matchList.length > 0 &&\n                    <caption>Round {roundId + 1} results</caption>\n                }\n                <tbody>\n                    {matchList.length > 0 &&\n                        <tr>\n                            <th className=\"row__id\" scope=\"col\">\n                                #\n                            </th>\n                            <th className=\"row__player\" scope=\"col\">\n                                White\n                            </th>\n                            <th className=\"row__player\" scope=\"col\">\n                                Black\n                            </th>\n                            <th className=\"row__result\" scope=\"col\">\n                                Result\n                            </th>\n                            <th className=\"row__controls\" scope=\"col\">\n                                Controls\n                            </th>\n                        </tr>\n                    }\n                    {matchList.map((match, pos) => (\n                        <MatchRow\n                            key={match.id}\n                            match={match}\n                            pos={pos}\n                            roundId={roundId}\n                            selectedMatch={selectedMatch}\n                            setSelectedMatch={setSelectedMatch}\n                        />\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\nRound.propTypes = {\n    roundId: PropTypes.number,\n    tourneyId: PropTypes.number\n};\n","import React, {useEffect, useState} from \"react\";\nimport {Tab, TabList, TabPanel, TabPanels, Tabs} from \"@reach/tabs\";\nimport Icons from \"../../icons\";\nimport PairPicker from \"../pair-picker\";\nimport PropTypes from \"prop-types\";\nimport Round from \"./round\";\nimport {getUnmatched} from \"../../../pairing-scoring\";\nimport {useTournament} from \"../../../hooks\";\n\nexport default function Index(props) {\n    const roundId = Number(props.roundId); // Reach Router passes a string.\n    const {tourney, players} = useTournament();\n    // only use unmatched players if this is the last round.\n    const unmatched = (roundId === tourney.roundList.length - 1)\n        ? getUnmatched(tourney, players, roundId)\n        : {};\n    const unmatchedCount = Object.keys(unmatched).length;\n    const [openTab, setOpenTab] = useState(0);\n    useEffect(\n        function () {\n            (unmatchedCount > 0) ? setOpenTab(1) : setOpenTab(0);\n        },\n        [unmatchedCount]\n    );\n    return (\n        <Tabs index={openTab} onChange={(index) => setOpenTab(index)}>\n            <TabList>\n                <Tab><Icons.List/> Matches</Tab>\n                <Tab disabled={unmatchedCount === 0}>\n                    <Icons.Users/> Unmatched players\n                </Tab>\n            </TabList>\n            <TabPanels>\n                <TabPanel>\n                    <Round roundId={roundId}/>\n                </TabPanel>\n                <TabPanel>\n                    <PairPicker roundId={roundId} />\n                </TabPanel>\n            </TabPanels>\n        </Tabs>\n    );\n}\nIndex.propTypes = {\n    path: PropTypes.string,\n    roundId: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n};\n","import React, {useState} from \"react\";\nimport {Tab, TabList, TabPanel, TabPanels, Tabs} from \"@reach/tabs\";\nimport {\n    createStandingTree,\n    tieBreakMethods\n} from \"../../pairing-scoring\";\nimport Icons from \"../icons\";\nimport PropTypes from \"prop-types\";\nimport dashify from \"dashify\";\nimport {defaultTo} from \"ramda\";\nimport numeral from \"numeral\";\nimport style from \"./scores.module.css\";\nimport {useTournament} from \"../../hooks\";\n\nfunction ScoreTable(props) {\n    const {tourney, getPlayer} = useTournament();\n    const {tieBreaks, roundList} = tourney;\n    const [standingTree, tbMethods] = createStandingTree(tieBreaks, roundList);\n    return (\n        <table className={style.table}>\n            <caption>Score detail</caption>\n            <tbody>\n                <tr className={style.topHeader}>\n                    <th scope=\"col\">Rank</th>\n                    <th scope=\"col\">Name</th>\n                    <th scope=\"col\">Score</th>\n                    {tbMethods.map((name, i) => (\n                        <th key={i} scope=\"col\">\n                            {name}\n                        </th>\n                    ))}\n                </tr>\n                {standingTree.map((standingsFlat, rank) =>\n                    standingsFlat.map((standing, j, src) => (\n                        <tr key={standing.id} className={style.row}>\n                            {j === 0 && ( // Only display the rank once\n                                <th\n                                    className={\"table__number \" + style.rank}\n                                    rowSpan={src.length}\n                                    scope=\"row\"\n                                >\n                                    {numeral(rank + 1).format(\"0o\")}\n                                </th>\n                            )}\n                            <th\n                                className={style.playerName}\n                                data-testid={rank}\n                                scope=\"row\"\n                            >\n                                {getPlayer(standing.id).firstName}&nbsp;\n                                {getPlayer(standing.id).lastName}\n                            </th>\n                            <td\n                                className=\"table__number\"\n                                data-testid={dashify(\n                                    getPlayer(standing.id).firstName\n                                    + getPlayer(standing.id).lastName\n                                    + \" score\"\n                                )}\n                            >\n                                {numeral(standing.score).format(\"1/2\")}\n                            </td>\n                            {standing.tieBreaks.map((score, i) => (\n                                <td\n                                    key={i}\n                                    className=\"table__number\"\n                                    data-testid={dashify(\n                                        getPlayer(standing.id).firstName\n                                        + getPlayer(standing.id).lastName\n                                        + tbMethods[i]\n                                    )}\n                                >\n                                    {numeral(score).format(\"1/2\")}\n                                </td>\n                            ))}\n                        </tr>\n                    ))\n                )}\n            </tbody>\n        </table>\n    );\n}\nScoreTable.propTypes = {};\n\nfunction SelectTieBreaks(props) {\n    const {tourney, tourneyDispatch} = useTournament();\n    const dispatch = tourneyDispatch;\n    const {tieBreaks} = tourney;\n    const [selectedTb, setSelectedTb] = useState(null);\n\n    function toggleTb(id = null) {\n        const defaultId = defaultTo(selectedTb);\n        if (tieBreaks.includes(defaultId(id))) {\n            dispatch({id: defaultId(id), type: \"DEL_TIEBREAK\"});\n            setSelectedTb(null);\n        } else {\n            dispatch({id: defaultId(id), type: \"ADD_TIEBREAK\"});\n        }\n    }\n\n    function moveTb(direction) {\n        const index = tieBreaks.indexOf(selectedTb);\n        dispatch({\n            newIndex: index + direction,\n            oldIndex: index,\n            type: \"MOVE_TIEBREAK\"\n        });\n    }\n\n    return (\n        <div>\n            <h3>Selected tiebreak methods</h3>\n            <div className=\"toolbar\">\n                <button\n                    disabled={selectedTb === null}\n                    onClick={() => toggleTb()}\n                >\n                    Toggle\n                </button>\n                <button\n                    disabled={selectedTb === null}\n                    onClick={() => moveTb(-1)}\n                >\n                    <Icons.ArrowUp/> Move up\n                </button>\n                <button\n                    disabled={selectedTb === null}\n                    onClick={() => moveTb(1)}\n                >\n                    <Icons.ArrowDown/> Move down\n                </button>\n                <button\n                    disabled={selectedTb === null}\n                    onClick={() => setSelectedTb(null)}\n                >\n                    Done\n                </button>\n            </div>\n            <ol>\n                {tieBreaks.map((id) => (\n                    <li\n                        key={id}\n                        className={selectedTb === id ? \"selected\" : \"\"}\n                    >\n                        {tieBreakMethods[id].name}{\" \"}\n                        <button\n                            disabled={\n                                selectedTb !== null && selectedTb !== id\n                            }\n                            onClick={() =>\n                                selectedTb === id\n                                    ? setSelectedTb(null)\n                                    : setSelectedTb(id)\n                            }\n                        >\n                            {selectedTb === id ? \"Done\" : \"Edit\"}\n                        </button>\n                    </li>\n                ))}\n            </ol>\n            <h3>Available tiebreak methods</h3>\n            <ol>\n                {Object.values(tieBreakMethods).map(({name, id}) => (\n                    <li key={id}>\n                        <span\n                            className={\n                                tieBreaks.includes(id)\n                                    ? \"enabled\"\n                                    : \"disabled\"\n                            }\n                        >\n                            {name}\n                        </span>\n                        {!tieBreaks.includes(id) && (\n                            <button onClick={() => toggleTb(id)}>\n                                Add\n                            </button>\n                        )}\n                    </li>\n                ))}\n            </ol>\n        </div>\n    );\n}\nSelectTieBreaks.propTypes = {};\n\nconst Scores = (props) => (\n    <Tabs>\n        <TabList>\n            <Tab><Icons.List /> Scores</Tab>\n            <Tab><Icons.Settings /> Edit tiebreak rules</Tab>\n        </TabList>\n        <TabPanels>\n            <TabPanel>\n                <ScoreTable />\n            </TabPanel>\n            <TabPanel>\n                <SelectTieBreaks />\n            </TabPanel>\n        </TabPanels>\n    </Tabs>\n);\nScores.propTypes = {\n    path: PropTypes.string\n};\n\nexport default Scores;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport {useTournament} from \"../../hooks\";\n\nexport default function Header(props) {\n    const {tourney} = useTournament();\n    return (\n        <div className={props.className}>\n            <h1>{tourney.name}</h1>\n        </div>\n    );\n}\nHeader.propTypes = {\n    className: PropTypes.string\n};\n","import {calcNumOfRounds, getUnmatched} from \"../../pairing-scoring\";\nimport {useDocumentTitle, useTournament} from \"../../hooks\";\nimport {DUMMY_ID} from \"../../data-types\";\nimport Icons from \"../icons\";\nimport {Link} from \"@reach/router\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Tooltip from \"@reach/tooltip\";\nimport last from \"ramda/src/last\";\n\nexport default function Sidebar(props) {\n    const {\n        tourney,\n        players,\n        getPlayer,\n        playersDispatch,\n        tourneyDispatch\n    } = useTournament();\n    useDocumentTitle(tourney.name);\n    const {roundList} = tourney;\n    const unmatched = getUnmatched(tourney, players, roundList.length - 1);\n\n    const isNewRoundReady = (function () {\n        const lastRound = last(roundList);\n        if (!lastRound) {\n            return true;\n        }\n        const results = lastRound.map(\n            (match) => match.result[0] + match.result[1]\n        );\n        return Object.keys(unmatched).length === 0 && !results.includes(0);\n    }());\n    const roundCount = calcNumOfRounds(Object.keys(players).length);\n    const isItOver = roundList.length >= roundCount;\n    const [tooltipText, tooltipWarn] = (function () {\n        if (!isNewRoundReady) {\n            return [\n                \"You must complete the last round before beginning a new one.\",\n                true\n            ];\n        } else if (isItOver) {\n            return [\"All necessary rounds have completed.\", true];\n        } else {\n            return [\"Ready to begin a new round.\", false];\n        }\n    }());\n\n    function newRound() {\n        const confirmText = \"All rounds have completed. Are you sure you want \"\n            + \"to begin a new one?\";\n        if (isItOver) {\n            if (!window.confirm(confirmText)) {\n                return;\n            }\n        }\n        tourneyDispatch({type: \"ADD_ROUND\"});\n    }\n\n    async function delLastRound() {\n        if (window.confirm(\"Are you sure you want to delete the last round?\")) {\n            await props.navigate(\".\");\n            // If a match has been scored, then reset it.\n            // Should this logic be somewhere else?\n            last(roundList).forEach(function (match) {\n                if (match.result[0] + match.result[1] === 0) {\n                    return; // Don't change players who haven't scored.\n                }\n                match.playerIds.forEach(function (pId, color) {\n                    if (pId === DUMMY_ID) {\n                        return; // Don't try to set the dummy.\n                    }\n                    const {matchCount} = getPlayer(pId);\n                    playersDispatch({\n                        id: pId,\n                        matchCount: matchCount - 1,\n                        type: \"SET_PLAYER_MATCHCOUNT\"\n                    });\n                    playersDispatch({\n                        id: pId,\n                        rating: match.origRating[color],\n                        type: \"SET_PLAYER_RATING\"\n                    });\n                });\n            });\n            tourneyDispatch({type: \"DEL_LAST_ROUND\"});\n            if (tourney.roundList.length === 1) {\n                // Automatically remake round 1.\n                tourneyDispatch({type: \"ADD_ROUND\"});\n            }\n        }\n    }\n\n    return (\n        <div className={props.className}>\n            <nav>\n                <ul>\n                    <li>\n                        <Link to=\"..\">\n                            <Icons.X/>Close\n                        </Link>\n                    </li>\n                </ul>\n                <hr />\n                <ul>\n                    <li>\n                        <Link to=\".\">\n                            <Icons.Users /> Players\n                        </Link>\n                    </li>\n                    <li>\n                        <Link to=\"crosstable\">\n                            <Icons.Layers /> Crosstable\n                        </Link>\n                    </li>\n                    <li>\n                        <Link to=\"scores\">\n                            <Icons.List /> Score detail\n                        </Link>\n                    </li>\n                </ul>\n                <hr />\n                <ul>\n                    {Object.keys(roundList).map((id) => (\n                        <li key={id}>\n                            <Link to={`${id}`}>\n                            Round {Number(id) + 1}\n                            </Link>\n                        </li>\n                    ))}\n                </ul>\n            </nav>\n            <hr />\n            <ul>\n                <li>\n                    <button\n                        disabled={!isNewRoundReady}\n                        onClick={newRound}\n                    >\n                        <Icons.Plus/> New round\n                    </button>{\" \"}\n                    <Tooltip label={tooltipText}>\n                        <span className=\"helpIcon\">\n                            {(tooltipWarn)\n                            ? <Icons.Alert className=\"status-alert\" />\n                            : <Icons.Check className=\"status-ok\" />\n                            }\n                        </span>\n                    </Tooltip>\n                </li>\n                <li>\n                    <button\n                        className={\"danger\"}\n                        disabled={roundList.length === 0}\n                        onClick={delLastRound}\n                    >\n                        <Icons.Trash /> Remove last round\n                    </button>\n                </li>\n                <li>\n                    Round progress: {roundList.length}/{roundCount}\n                </li>\n            </ul>\n        </div>\n    );\n}\nSidebar.propTypes = {\n    className: PropTypes.string,\n    navigate: PropTypes.func.isRequired\n};\n","import Crosstable from \"./crosstable\";\nimport Header from \"./header\";\nimport PlayerSelect from \"./player-select\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Round from \"./round\";\nimport {Router} from \"@reach/router\";\nimport Scores from \"./scores\";\nimport Sidebar from \"./sidebar\";\nimport {TournamentProvider} from \"../../hooks\";\nimport styles from \"./tournament.module.css\";\n\nexport default function Tournament(props) {\n    return (\n        <TournamentProvider tourneyId={props.tourneyId}>\n            <div className={styles.tournament}>\n                <Header className={styles.header} />\n                <Sidebar className={styles.sidebar} navigate={props.navigate} />\n                <div className={styles.content}>\n                    <Router>\n                        <PlayerSelect path=\"/\" />\n                        <Crosstable path=\"crosstable\" />\n                        <Scores path=\"scores\" />\n                        <Round path=\":roundId\" />\n                    </Router>\n                </div>\n            </div>\n        </TournamentProvider>\n    );\n}\nTournament.propTypes = {\n    children: PropTypes.node,\n    navigate: PropTypes.func,\n    path: PropTypes.string,\n    tourneyId: PropTypes.string\n};\n","import React, {useState} from \"react\";\nimport {useAllTournamentsDb, useDocumentTitle} from \"../../hooks\";\nimport {Dialog} from \"@reach/dialog\";\nimport Icons from \"../icons\";\nimport {Link} from \"@reach/router\";\n\nexport default function TournamentList(props) {\n    const [tourneys, dispatch] = useAllTournamentsDb();\n    const [newTourneyName, setNewTourneyName] = useState(\"\");\n    const [isFormOpen, setIsFormOpen] = useState(false);\n    useDocumentTitle(\"tournament list\");\n\n    function updateNewName(event) {\n        setNewTourneyName(event.target.value);\n    }\n\n    function makeTournament(event) {\n        event.preventDefault();\n        dispatch({\n            name: newTourneyName,\n            type: \"ADD_TOURNEY\"\n        });\n        setNewTourneyName(\"\");\n    }\n\n    return (\n        <div>\n            <button\n                onClick={() => setIsFormOpen(true)}\n            >\n                <Icons.Plus /> Add tournament\n            </button>\n            {(Object.keys(tourneys).length > 0)\n            ?\n            <table>\n                <caption>Tournament list</caption>\n                <tbody>\n                    <tr>\n                        <th>Name</th>\n                        <th>Controls</th>\n                    </tr>\n                    {Object.values(tourneys).map(({name, id}) =>\n                        <tr key={id}>\n                            <td>\n                                <Link to={id}>\n                                    {name}\n                                </Link>\n                            </td>\n                            <td>\n                                <button\n                                    aria-label={`Delete ${name}`}\n                                    className=\"danger ghost\"\n                                    title={`Delete ${name}`}\n                                    onClick={\n                                        () => dispatch({id, type: \"DEL_ITEM\"})\n                                    }\n                                >\n                                    <Icons.Trash />\n                                </button>\n                            </td>\n                        </tr>\n                    )}\n                </tbody>\n            </table>\n            : <p>No tournaments added yet.</p>\n            }\n            <Dialog isOpen={isFormOpen}>\n                <button\n                    className=\"micro\"\n                    onClick={() => setIsFormOpen(false)}\n                >\n                    Close\n                </button>\n                <form onSubmit={makeTournament}>\n                    <fieldset>\n                        <legend>Make a new tournament</legend>\n                        <label htmlFor=\"tourney-name\">Name:</label>\n                        <input\n                            name=\"tourney-name\"\n                            placeholder=\"tournament name\"\n                            required={true}\n                            type=\"text\"\n                            value={newTourneyName}\n                            onChange={updateNewName}\n                        />{\" \"}\n                        <input\n                            className=\"button-primary\"\n                            type=\"submit\"\n                            value=\"Create\"\n                        />\n                    </fieldset>\n                </form>\n            </Dialog>\n        </div>\n    );\n}\n","import Crosstable from \"./crosstable\";\nimport PlayerSelect from \"./player-select\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Round from \"./round\";\nimport Scores from \"./scores\";\nimport Tournament from \"./tournament\";\nimport TournamentList from \"./tournament-list\";\n\nconst TournamentIndex = (props) => (\n    <div className=\"passthrough\">\n        {props.children}\n    </div>\n);\nTournamentIndex.propTypes = {\n    children: PropTypes.node\n};\n\nexport default TournamentIndex;\nexport {Crosstable, PlayerSelect, Round, Scores, Tournament, TournamentList};\n","import React from \"react\";\nimport styles from \"./index.module.css\";\n\nconst Caution = () => (\n    <aside className={styles.caution + \" body-20\"}>\n        <p className={styles.caution__text}>\n            This is beta software. Want to help make it better? Check out the\n            {\" \"}\n            <span role=\"img\" aria-hidden></span>\n            &nbsp;\n            <a\n                className={styles.caution__link}\n                href=\"https://github.com/johnridesabike/chessahoochee\"\n            >\n                Git repository\n            </a>.\n        </p>\n    </aside>\n);\n\nexport default Caution;\n","import React from \"react\";\n\nconst NotFound = (props) => (\n    <div data-testid=\"404\">\n        <p>Page not found.</p>\n    </div>\n);\n\nexport default NotFound;\n","import React, {useEffect, useMemo, useState} from \"react\";\nimport {\n    useAllPlayersDb,\n    useAllTournamentsDb,\n    useDocumentTitle,\n    useOptionsDb\n} from \"../hooks\";\nimport demoData from \"../demo-data\";\n\nexport default function Options(props) {\n    const [tourneys, tourneysDispatch] = useAllTournamentsDb();\n    const [players, playersDispatch] = useAllPlayersDb();\n    const [text, setText] = useState(\"\");\n    const [options, optionsDispatch] = useOptionsDb();\n    useDocumentTitle(\"Options\");\n    // memoize this so the `useEffect` hook syncs with the correct states\n    const exportData = useMemo(\n        () => ({options, players, tourneys}),\n        [options, tourneys, players]\n    );\n    useEffect(\n        function () {\n            setText(JSON.stringify(exportData, null, 4));\n        },\n        [exportData]\n    );\n    function loadData(data) {\n        tourneysDispatch({state: data.tournaments, type: \"LOAD_STATE\"});\n        optionsDispatch({state: data.options, type: \"LOAD_STATE\"});\n        playersDispatch({state: data.players, type: \"LOAD_STATE\"});\n        window.alert(\"Data loaded!\");\n    }\n    function handleText(event) {\n        event.preventDefault();\n        const importData = JSON.parse(text);\n        loadData(importData);\n    }\n    function handleFile(event) {\n        event.preventDefault();\n        const reader = new FileReader();\n        // eslint-disable-next-line fp/no-mutation\n        reader.onload = function (ev) {\n            const data = ev.target.result;\n            const importData = JSON.parse(data);\n            loadData(importData);\n        };\n        reader.readAsText(event.currentTarget.files[0]);\n        event.currentTarget.value = \"\"; // so the filename won't linger onscreen\n    }\n    function reloadDemoData(event) {\n        event.preventDefault();\n        loadData(demoData);\n    }\n    return (\n        <div>\n            <form>\n                <fieldset>\n                    <legend>Bye options</legend>\n                    Select how many points a bye is worth:\n                    <label className=\"monospace\">\n                        1{\" \"}\n                        <input\n                            checked={options.byeValue === 1}\n                            type=\"radio\"\n                            onChange={() => optionsDispatch({\n                                option: \"byeValue\",\n                                type: \"SET_OPTION\",\n                                value: 1\n                            })}\n                        />\n                    </label>\n                    <label className=\"monospace\">\n                        {\" \"}\n                        <input\n                            checked={options.byeValue === 0.5}\n                            type=\"radio\"\n                            onChange={() => optionsDispatch({\n                                option: \"byeValue\",\n                                type: \"SET_OPTION\",\n                                value: 0.5\n                            })}\n                        />\n                    </label>\n                </fieldset>\n            </form>\n            <fieldset>\n                <legend>Manage data</legend>\n                <p>\n                    <a\n                        download=\"chessahoochee.json\"\n                        href={\n                            \"data:application/json,\"\n                            + encodeURIComponent(JSON.stringify(exportData))\n                        }\n                    >\n                        Download all data\n                    </a>\n                </p>\n                <label htmlFor=\"file\">Load data file:</label>\n                <input\n                    id=\"file\"\n                    name=\"file\"\n                    type=\"file\"\n                    onChange={handleFile}\n                />\n            </fieldset>\n            <fieldset>\n                <legend>Reset all changes</legend>\n                <button onClick={reloadDemoData}>Reload demo data</button>\n            </fieldset>\n            <form onSubmit={handleText}>\n                <fieldset>\n                    <legend>\n                        Advanced: manually edit data\n                    </legend>\n                    <textarea\n                        className=\"json\"\n                        cols={50}\n                        name=\"playerdata\"\n                        rows={25}\n                        spellCheck={false}\n                        value={text}\n                        onChange={(event) => setText(event.currentTarget.value)}\n                    />\n                    <p>\n                        <input type=\"submit\" value=\"Load\" />\n                    </p>\n                </fieldset>\n            </form>\n        </div>\n    );\n}\n","import React, {useEffect, useMemo, useState} from \"react\";\nimport {getPlayerAvoidList, kFactor} from \"../../pairing-scoring\";\nimport Icons from \"../icons\";\nimport {Link} from \"@reach/router\";\nimport PropTypes from \"prop-types\";\nimport numeral from \"numeral\";\nimport styles from \"./index.module.css\";\nimport {useDocumentTitle} from \"../../hooks\";\n\nexport default function PlayerInfoBox({\n    playerId,\n    players,\n    playersDispatch,\n    options,\n    optionsDispatch\n}) {\n    const player = players[playerId];\n    const [singAvoidList, setSingAvoidList] = useState(\n        getPlayerAvoidList(playerId, options.avoidPairs)\n    );\n    const playerName = (player) ? player.firstName + \" \" + player.lastName : \"\";\n    useDocumentTitle(\"profile for \" + playerName);\n    // Memoize this so useEffect doesn't cause a memory leak.\n    const unAvoided = useMemo(\n        () => Object.keys(players).filter(\n            (id) => !singAvoidList.includes(id) && id !== playerId\n        ),\n        [players, playerId, singAvoidList]\n    );\n    const [selectedAvoider, setSelectedAvoider] = useState(unAvoided[0]);\n    function avoidAdd(event) {\n        event.preventDefault();\n        optionsDispatch({\n            pair: [playerId, selectedAvoider],\n            type: \"ADD_AVOID_PAIR\"\n        });\n    }\n    useEffect(\n        function () {\n            setSingAvoidList(getPlayerAvoidList(playerId, options.avoidPairs));\n        },\n        [options.avoidPairs, playerId]\n    );\n    useEffect(\n        function () {\n            setSelectedAvoider(unAvoided[0]);\n        },\n        [setSelectedAvoider, unAvoided]\n    );\n    function handleChange(event) {\n        event.preventDefault();\n        const {firstName, lastName, matchCount, rating} = event.currentTarget;\n        playersDispatch({\n            firstName: firstName.value,\n            id: playerId,\n            lastName: lastName.value,\n            matchCount: Number(matchCount.value),\n            rating: Number(rating.value),\n            type: \"SET_PLAYER\"\n        });\n    }\n    if (!player) {\n        return <div>Loading...</div>;\n    }\n    return (\n        <div className={styles.playerInfo}>\n            <Link to=\"..\"><Icons.ChevronLeft /> Back</Link>\n            <h2>\n                Profile for {player.firstName} {player.lastName}\n            </h2>\n            <form onChange={handleChange} onSubmit={handleChange}>\n                <p>\n                    <label htmlFor=\"firstName\">First name</label>\n                    <input\n                        defaultValue={player.firstName}\n                        name=\"firstName\"\n                        type=\"text\"\n                    />\n                </p>\n                <p>\n                    <label htmlFor=\"lastName\">Last name</label>\n                    <input\n                        defaultValue={player.lastName}\n                        name=\"lastName\"\n                        type=\"text\"\n                    />\n                </p>\n                <p>\n                    <label htmlFor=\"matchCount\">Matches played</label>\n                    <input\n                        defaultValue={String(player.matchCount)}\n                        name=\"matchCount\"\n                        type=\"number\"\n                    />\n                </p>\n                <p>\n                    <label htmlFor=\"rating\">Rating</label>\n                    <input\n                        defaultValue={String(player.rating)}\n                        name=\"rating\"\n                        type=\"number\"\n                    />\n                </p>\n                <p>\n                    <label htmlFor=\"Kfactor\">K factor</label>\n                    <input\n                        name=\"kfactor\"\n                        type=\"number\"\n                        value={numeral(kFactor(player.matchCount)).format(\"00\")}\n                        readOnly\n                    />\n                </p>\n            </form>\n            <h3>Players to avoid</h3>\n            <ul>\n                {singAvoidList.map((pId) =>\n                    <li key={pId}>\n                        {players[pId].firstName} {players[pId].lastName}\n                        <button\n                            arial-label={`Remove \n${players[pId].firstName} ${players[pId].lastName} from avoid list.`}\n                            className=\"danger ghost\"\n                            title={`Remove ${players[pId].firstName} \n${players[pId].lastName}`}\n                            onClick={() =>\n                                optionsDispatch({\n                                    pair: [playerId, pId],\n                                    type: \"DEL_AVOID_PAIR\"\n                                })\n                            }\n                        >\n                            <Icons.Trash />\n                        </button>\n                    </li>\n                )}\n                {singAvoidList.length === 0 &&\n                    <li>None</li>\n                }\n            </ul>\n            <form onSubmit={avoidAdd}>\n                <fieldset>\n                    <legend>Add player to avoid</legend>\n                    <select\n                        onBlur={(event) =>\n                            setSelectedAvoider(event.target.value)\n                        }\n                    >\n                        {unAvoided.map((pId) => (\n                            <option key={pId} value={pId}>\n                                {players[pId].firstName} {players[pId].lastName}\n                            </option>\n                        ))}\n                    </select>{\" \"}\n                    <input type=\"submit\" value=\"Add\" />\n                </fieldset>\n            </form>\n        </div>\n    );\n}\nPlayerInfoBox.propTypes = {\n    options: PropTypes.object.isRequired,\n    optionsDispatch: PropTypes.func.isRequired,\n    playerId: PropTypes.string,\n    players: PropTypes.object.isRequired,\n    playersDispatch: PropTypes.func.isRequired\n};\n","import React, {useState} from \"react\";\nimport {Dialog} from \"@reach/dialog\";\nimport Icons from \"../icons\";\nimport {Link} from \"@reach/router\";\nimport NewPlayer from \"../new-player\";\nimport PropTypes from \"prop-types\";\nimport VisuallyHidden from \"@reach/visually-hidden\";\nimport styles from \"./index.module.css\";\nimport {useDocumentTitle} from \"../../hooks\";\n\nexport default function PlayerList({\n    players,\n    playersDispatch,\n    optionsDispatch\n}) {\n    const [isFormOpen, setIsFormOpen] = useState(false);\n    useDocumentTitle(\"Players\");\n    const delPlayer = function (event, id) {\n        event.preventDefault();\n        const message = \"Are you sure you want to delete \"\n            + players[id].firstName + \" \" + players[id].lastName + \"?\";\n        if (window.confirm(message)) {\n            playersDispatch({id, type: \"DEL_ITEM\"});\n            optionsDispatch({id, type: \"DEL_AVOID_SINGLE\"});\n        }\n    };\n    return (\n        <div>\n            <button onClick={() => setIsFormOpen(true)}>\n                <Icons.UserPlus /> Add a new player\n            </button>\n            <table className={styles.table}>\n                <caption>Player roster</caption>\n                <thead>\n                    <tr>\n                        <th colSpan={2}>Name</th>\n                        <th>Rating</th>\n                        <th>Matches</th>\n                        <th>Controls</th>\n                    </tr>\n                </thead>\n                <tbody>{Object.values(players).map((player) =>\n                    <tr key={player.id}>\n                        <td className=\"table__player\">\n                            {player.firstName}\n                        </td>\n                        <td className=\"table__player\">\n                            {player.lastName}\n                        </td>\n                        <td className=\"table__number\">{player.rating}</td>\n                        <td className=\"table__number\">{player.matchCount}</td>\n                        <td>\n                            <button\n                                // eslint-disable-next-line max-len\n                                aria-label={`Delete ${player.firstName} ${player.lastName}`}\n                                className=\"danger iconButton ghost\"\n                                // eslint-disable-next-line max-len\n                                title={`Delete ${player.firstName} ${player.lastName}`}\n                                onClick={(event) => delPlayer(event, player.id)}\n                            >\n                                <Icons.Trash />\n                            </button>{\" \"}\n                            <Link to={String(player.id)}>\n                            Open\n                                <VisuallyHidden>\n                                    {\" \"}{player.firstName} {player.lastName}\n                                </VisuallyHidden>{\" \"}\n                                <Icons.ChevronRight />\n                            </Link>\n                        </td>\n                    </tr>\n                )}\n                </tbody>\n            </table>\n            <Dialog isOpen={isFormOpen}>\n                <button\n                    className=\"micro\"\n                    onClick={() => setIsFormOpen(false)}\n                >\n                    Close\n                </button>\n                <NewPlayer dispatch={playersDispatch} />\n            </Dialog>\n        </div>\n    );\n}\nPlayerList.propTypes = {\n    optionsDispatch: PropTypes.func.isRequired,\n    players: PropTypes.object.isRequired,\n    playersDispatch: PropTypes.func.isRequired\n};\n","import {useAllPlayersDb, useOptionsDb} from \"../../hooks\";\nimport PlayerInfo from \"./info-box\";\nimport PlayerList from \"./player-list\";\nimport React from \"react\";\nimport {Router} from \"@reach/router\";\n\nexport default function Players(props) {\n    const [players, playersDispatch] = useAllPlayersDb();\n    const [options, optionsDispatch] = useOptionsDb();\n    const childProps = {options, optionsDispatch, players, playersDispatch};\n    return (\n        <Router basepath=\"players\">\n            <PlayerList path=\"/\" {...childProps} />\n            <PlayerInfo path=\":playerId\" {...childProps} />\n        </Router>\n    );\n}\nPlayers.propTypes = {};\n\nexport {PlayerInfo, PlayerList};\n","import Icons from \"./icons\";\nimport React from \"react\";\nimport {loadDemoDB} from \"../hooks/db\";\nimport styles from \"./splash.module.css\";\n\nconst Splash = (props) => (\n    <div className={styles.splash}>\n        <aside className={styles.hint}>\n            <ol>\n                <li>\n                    <button\n                        className=\"button-primary\"\n                        onClick={() => loadDemoDB()}\n                    >\n                        Click here to load the demo data\n                    </button>{\" \"}\n                    (optional)\n                </li>\n                <li>\n                    <Icons.ArrowUpLeft />\n                    Select a menu item above.\n                </li>\n                <li>\n                    Start creating your tournaments!\n                </li>\n            </ol>\n        </aside>\n        <h1 className={styles.title}>\n            <span aria-hidden={true}></span>{\" \"}\n            Chessahoochee: <small>a chess tournament app</small>\n        </h1>\n        <footer className={\"body-20 \" + styles.footer}>\n            <p>\n                This is an early, proof-of-concept chess tournament app.{\" \"}\n                <a href=\"https://github.com/johnridesabike/chessahoochee\">\n                    Suggetions, bug reports, and contributions are welcome.\n                </a>\n            </p>\n            <p style={{textAlign: \"right\"}}>\n                Built with JavaScript and{\" \"}\n                <a href=\"https://reactjs.org/\">React</a>.{\" \"}\n                <span style={{fontSize: \"1.125em\"}}>\n                    <Icons.Javascript /> <Icons.React />\n                </span>\n            </p>\n        </footer>\n    </div>\n);\nexport default Splash;\n","// import \"@reach/tabs/styles.css\";\nimport \"@reach/tooltip/styles.css\";\nimport \"side-effects\";\nimport {\n    Link,\n    LocationProvider,\n    Router,\n    createHistory\n} from \"@reach/router\";\nimport TournamentIndex, {\n    Tournament,\n    TournamentList\n} from \"./components/tournament\";\nimport {link, mainMenu} from \"./App.module.css\";\nimport Caution from \"./components/caution\";\nimport NotFound from \"./components/404\";\nimport Options from \"./components/options\";\nimport Players from \"./components/players\";\nimport React from \"react\";\nimport Splash from \"./components/splash\";\nimport createHashSource from \"hash-source\";\nimport {useDocumentTitle} from \"./hooks\";\n// These are just for deploying to GitHub pages.\nlet source = createHashSource();\nlet history = createHistory(source);\n\n// const electron = window.require(\"electron\");\n\nfunction App() {\n    useDocumentTitle(\"a chess tournament app\");\n    return (\n        <div className=\"app\">\n            <LocationProvider history={history}>\n                <header className=\"header\">\n                    <nav className={mainMenu}>\n                        <Link className={link} to=\"tourneys\">\n                            Tournaments\n                        </Link>\n                        <Link className={link} to=\"players\">\n                            Players\n                        </Link>\n                        <Link className={link} to=\"options\">\n                            Options\n                        </Link>\n                        <Link className={link} to=\"/\">\n                            About\n                        </Link>\n                    </nav>\n                </header>\n                <main className=\"content\">\n                    <Router>\n                        <Splash path=\"/\" />\n                        <TournamentIndex path=\"tourneys\">\n                            <TournamentList path=\"/\" />\n                            <Tournament path=\":tourneyId/*\" />\n                        </TournamentIndex>\n                        <Players path=\"players/*\" />\n                        <Options path=\"options\" />\n                        <NotFound default />\n                    </Router>\n                </main>\n            </LocationProvider>\n            <footer className=\"footer\">\n                <Caution />\n            </footer>\n        </div>\n    );\n}\n\nexport default App;\n","import \"./index.css\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport React, {StrictMode} from \"react\";\nimport App from \"./App\";\nimport ReactDOM from \"react-dom\";\n\nReactDOM.render(\n    <StrictMode><App /></StrictMode>,\n    document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"scores_table__22BFZ\",\"topHeader\":\"scores_topHeader__2RVRR\",\"row\":\"scores_row__bmBzX\",\"playerName\":\"scores_playerName__3ghv9\",\"rank\":\"scores_rank__3AxBb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"link\":\"App_link__TB6Cl\",\"mainMenu\":\"App_mainMenu__3u0XV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tournament\":\"tournament_tournament__2nSxH\",\"header\":\"tournament_header__9nZzI\",\"sidebar\":\"tournament_sidebar__21G-s\",\"content\":\"tournament_content__1mdG3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"splash\":\"splash_splash__37_vi\",\"hint\":\"splash_hint__2lVJb\",\"footer\":\"splash_footer__2Z__A\",\"title\":\"splash_title__Cm7sw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"round_table__2JmnE\",\"winnerSelect\":\"round_winnerSelect__317oT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"players_table__yk6rK\",\"playerInfo\":\"players_playerInfo__nGWwZ\",\"controls\":\"players_controls__1rlpj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"caution\":\"caution_caution__17Bbq\",\"caution__text\":\"caution_caution__text__2ptRS\",\"caution__link\":\"caution_caution__link__X_K5Y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panels\":\"utility_panels__LN75I\",\"panel\":\"utility_panel__2GOiH\"};"],"sourceRoot":""}