{"version":3,"sources":["components/about.jsx","components/404.jsx","components/icons.jsx","state/helpers.js","data-types/constants.js","data-types/types.js","data-types/factories.js","data-types/index.js","pairing-scoring/ratings.js","pairing-scoring/helpers.js","pairing-scoring/scoring.js","pairing-scoring/factories.js","pairing-scoring/pairing.js","state/player-state.js","state/match-functions.js","state/tourneys-state.js","state/options-state.js","components/tournament/tournament.jsx","components/tournament/list.jsx","components/tournament/index.jsx","components/players/info-box.jsx","components/utility.jsx","components/players/new-player.jsx","components/players/list.jsx","components/players/index.jsx","components/tournament/scores.jsx","components/tournament/player-select/selecting.jsx","components/tournament/player-select/index.jsx","components/tournament/crosstable.jsx","components/tournament/round/player-match-info.jsx","components/tournament/round/match-row.jsx","components/tournament/round/round.jsx","components/tournament/pair-picker/select-list.jsx","components/tournament/pair-picker/stage.jsx","components/tournament/pair-picker/player-info.jsx","components/tournament/pair-picker/index.jsx","components/tournament/round/index.jsx","components/options.jsx","components/caution/index.jsx","side-effects.js","App.jsx","serviceWorker.js","index.jsx","components/tournament/scores.module.css","components/tournament/tournament.module.css","components/tournament/round/round.module.css","App.module.css","components/caution/index.module.css","components/utility.module.css"],"names":["About","props","react_default","a","createElement","data-testid","href","NotFound","icons","Alert","ArrowDown","ArrowUp","Check","ChevronLeft","ChevronRight","Edit","Info","Layers","List","Plus","Repeat","Settings","Trash","UserMinus","UserPlus","Users","X","localStorageOrDefault","key","defaultValue","value","JSON","parse","localStorage","getItem","setItem","stringify","BLACK","WHITE","DUMMY_ID","AvoidList","t","list","tuple","Number","Player","interface","id","firstName","String","lastName","rating","matchCount","type","PlayerStats","profile","score","dueColor","maybe","colorBalance","opponentHistory","upperHalf","Boolean","avoidList","hasHadBye","isDueBye","Match","players","result","origRating","newRating","RoundList","Tournament","name","tieBreaks","byeQueue","roundList","ScoreCalulator","func","Standing","createMatch","importObj","createPlayer","arguments","length","undefined","dummyPlayer","missingPlayer","kFactor","isNotDummy","playerId","getPlayerById","playerList","player","filter","p","isNotBye","match","includes","getMatchesByPlayer","matchList","getMatchDetailsForPlayer","index","indexOf","color","rounds2Matches","roundId","slice","reduce","acc","round","concat","calcNumOfRounds","playerCount","rounds","Math","ceil","log2","isFinite","getPlayerAvoidList","pair","accumulator","getDueColor","lastMatch","last","getPlayersByOpponent","opponentId","getOpponentScores","map","opponent","getPlayerScore","of","scoreList","getPlayerScoreList","sum","getCumulativeScore","getPlayerScoreListNoByes","getCumulativeOfOpponentScore","oppScores","getColorBalanceScore","colorList","tieBreakMethods","scores","pipe","sort","b","init","tail","Object","freeze","createStandingList","methods","Array","selectedTieBreaks","i","tieBreakNames","m","standings","allPlayers","from","Set","getAllPlayersFromMatches","method","sortFunc","ignore","thenBy","standing1","standing2","firstBy","createStandingTree","_createStandingList","_createStandingList2","slicedToArray","standingsFlat","standing","orig","prevStanding","append","over","lensIndex","createPlayerStats","_ref","playerDataSource","matches","priority","condition","avoidMeetingTwice","sameScores","divider","differentHalf","differentDueColor","maxPriority","add","calcPairIdeal","player1","player2","metBefore","mustAvoid","abs","setUpperHalves","playerStatsList","splitInHalf","splitAt","src","isUpperHalf","view","assoc","setByePlayer","hasNotHadBye","nextByeSignup","indexOfDueBye","findLastIndex","sortPlayersForPairing","defaultPlayers","demoPlayers","avoid","ActionSetPlayer","ActionAddPlayer","ActionDelPlayer","ActionSetMatchcount","ActionSetRating","ActionAvoidPair","ActionLoadState","state","Any","ActionTypes","union","playersReducer","action","getNextId","head","inc","lensPath","findIndex","propEq","mergeLeft","set","Error","dispatch","x","SET_PLAYER","ADD_PLAYER","DEL_PLAYER","SET_PLAYER_MATCHCOUNT","SET_PLAYER_RATING","ADD_AVOID_PAIR","DEL_AVOID_PAIR","LOAD_STATE","PlayerContext","createContext","usePlayers","_useContext","useContext","_useContext2","playerState","playerDispatch","getPlayer","curry","PlayersProvider","loadedData","_useReducer","useReducer","_useReducer2","useEffect","Provider","children","autoPair","tourney","unPairedPlayers","byeValue","playerIds","potentialMatches","playerMatches","reducedResults","blossom","p1Id","p2Id","p1","p2","ideal","matched","pair1","pair2","reverse","byePlayer","pairPlayers","join","ActionAddTourney","ActionDelTourney","ActionAddRound","tourneyId","ActionDelLastRound","ActionAddRemoveTieBreak","ActionMoveTieBreak","oldIndex","newIndex","ActionSetTourneyPlayers","ActionSetByeQueue","ActionAutoPair","unpairedPlayers","ActionManualPair","ActionSetMatchResult","matchId","ActionEditMatch","ActionMoveMatch","tourneysReducer","remove","move","__","manualPair","mergeRight","ADD_TOURNEY","DEL_TOURNEY","ADD_ROUND","DEL_LAST_ROUND","ADD_TIEBREAK","DEL_TIEBREAK","MOVE_TIEBREAK","SET_TOURNEY_PLAYERS","SET_BYE_QUEUE","AUTO_PAIR","MANUAL_PAIR","SET_MATCH_RESULT","DEL_MATCH","SWAP_COLORS","MOVE_MATCH","TournamentContext","useTournaments","useTournament","tourneys","useRound","_useTournament","_useTournament2","unmatched","difference","TournamentProvider","defaultTourneyList","ActionSetByeValue","reducer","SET_BYE_VALUE","OptionsContext","useOptions","OptionsProvider","defaultOptions","_usePlayers","isNewRoundReady","useMemo","lastRound","matchedPlayers","unMatchedPlayers","pId","results","origTitle","document","title","isItOver","_ref2","tooltipText","tooltipWarn","_delLastRound","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","window","confirm","navigate","forEach","stop","apply","this","className","styles","tournament","header","es","to","sidebar","keys","onClick","disabled","tooltip_es","label","toolbarItem","content","TournamentList","_useTournaments","_useTournaments2","_useState","useState","_useState2","newTourneyName","setNewTourneyName","aria-label","onSubmit","event","preventDefault","placeholder","onChange","target","required","TournamentIndex","PlayerInfoBox","singAvoidList","setSingAvoidList","unAvoided","_useState3","_useState4","selectedAvoider","setSelectedAvoider","handleChange","_event$currentTarget","currentTarget","readOnly","numeral","format","arial-label","avoidAdd","onBlur","Panel","_ref4","style","objectSpread","panel","PanelContainer","assign","panels","React","Children","child","PlayerLink","_ref5","findById","NewPlayer","newPlayerDefault","newPlayerData","setNewPlayerdata","updateField","prevState","PlayerList","delPlayer","visually_hidden_es","Players","ScoreTable","_useTournament2$","_createStandingTree","_createStandingTree2","standingTree","tbMethods","table","topHeader","scope","rank","j","row","rowSpan","playerName","dashify","SelectTieBreaks","_useTournament3","_useTournament4","selectedTb","setSelectedTb","toggleTb","defaultId","defaultTo","moveTb","direction","Scores","_ref3","tabs_es","Selecting","togglePlayer","checked","PlayerSelect","isSelecting","setIsSelecting","dialog_es","isOpen","Crosstable","_useMemo","opponentResults","lensProp","_useMemo2","opponentScores","getRatingChange","_getPerformanceRating","firstMatch","getPerformanceRatings","_getPerformanceRating2","firstRating","lastRating","change","index2","player1Id","player2Id","getXScore","PlayerMatchInfo","_useRound","playerData","prettyBalance","opId","MatchRow","pos","selectedMatch","setSelectedMatch","openModal","setOpenModal","resultCode","every","whiteName","blackName","setMatchResult","white","black","origRatings","matchCounts","whiteElo","EloRank","blackElo","scoreExpected","getExpected","updateRating","calcNewRatings","role","aria-hidden","winnerSelect","Round","moveMatch","toolbar","unMatch","SelectList","stagedPlayers","setStagedPlayers","_useOptions","isModalOpen","setIsModalOpen","unmatchedWithDummy","Stage","_stagedPlayers","unstage","react","PlayerInfo","_createPlayerStats","PairPicker","statsList","matchIdeal","Index","openTab","setOpenTab","Options","tourneysDispatch","_useOptions2","options","optionsDispatch","text","setText","exportData","loadData","data","alert","encodeURIComponent","download","reader","FileReader","onload","ev","readAsText","files","defaultTourneys","rows","cols","spellCheck","Caution","caution","caution__text","caution__link","register","regexps","unformat","roundingFunction","whole","floor","remainder","fraction","source","createHashSource","history","createHistory","App","link","path","tournament_Tournament","tournament_scores","about","_404","default","noThrow","location","hostname","ReactDOM","render","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister","module","exports"],"mappings":"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","file":"static/js/main.664fedd5.chunk.js","sourcesContent":["import React from \"react\";\n\nconst About = (props) => (\n    <p data-testid=\"about\">\n        This is an early, proof-of-concept, demo of a\n        chess tournament manager.{\" \"}\n        <a href=\"https://github.com/johnridesabike/chessahoochee\">\n            You can find out more here.\n        </a>\n    </p>\n);\n\nexport default About;\n","import React from \"react\";\n\nconst NotFound = (props) => (\n    <div data-testid=\"404\">\n        <p>Page not found.</p>\n    </div>\n);\n\nexport default NotFound;\n","import Alert from \"react-feather/dist/icons/alert-circle\";\nimport ArrowDown from \"react-feather/dist/icons/arrow-down\";\nimport ArrowUp from \"react-feather/dist/icons/arrow-up\";\nimport Check from \"react-feather/dist/icons/check\";\nimport ChevronLeft from \"react-feather/dist/icons/chevron-left\";\nimport ChevronRight from \"react-feather/dist/icons/chevron-right\";\nimport Edit from \"react-feather/dist/icons/edit\";\nimport Info from \"react-feather/dist/icons/info\";\nimport List from \"react-feather/dist/icons/list\";\nimport Plus from \"react-feather/dist/icons/plus\";\nimport Repeat from \"react-feather/dist/icons/repeat\";\nimport Trash from \"react-feather/dist/icons/trash-2\";\nimport UserMinus from \"react-feather/dist/icons/user-minus\";\nimport UserPlus from \"react-feather/dist/icons/user-plus\";\nimport Users from \"react-feather/dist/icons/users\";\nimport X from \"react-feather/dist/icons/x\";\nimport Layers from \"react-feather/dist/icons/layers\";\nimport Settings from \"react-feather/dist/icons/settings\";\n\nexport default {\n    Alert,\n    ArrowDown,\n    ArrowUp,\n    Check,\n    ChevronLeft,\n    ChevronRight,\n    Edit,\n    Info,\n    Layers,\n    List,\n    Plus,\n    Repeat,\n    Settings,\n    Trash,\n    UserMinus,\n    UserPlus,\n    Users,\n    X\n};\n","/**\n * @template {object} T\n * @param {string} key\n * @param {T} defaultValue\n * @returns {T}\n */\nexport function localStorageOrDefault(key, defaultValue) {\n    if (process.env.NODE_ENV === \"test\") {\n        return defaultValue; // don't store values during tests\n    }\n    const value = JSON.parse(localStorage.getItem(key)) || defaultValue;\n    localStorage.setItem(key, JSON.stringify(value));\n    return value;\n}\n","const BLACK = 1;\nexport {BLACK};\nconst WHITE = 0;\nexport {WHITE};\nconst DUMMY_ID = -1;\nexport {DUMMY_ID};\n","import t from \"tcomb\";\n\nconst AvoidList = t.list(t.tuple([t.Number, t.Number]));\nexport {AvoidList};\n\nconst Player = t.interface(\n    {\n        id: t.Number,\n        firstName: t.String,\n        lastName: t.String,\n        rating: t.Number,\n        matchCount: t.Number,\n        type: t.String // used for CSS styling etc\n    },\n    \"Player\"\n);\nexport {Player};\n\nconst PlayerStats = t.interface(\n    {\n        profile: Player,\n        id: t.Number,\n        score: t.Number,\n        dueColor: t.maybe(t.Number),\n        colorBalance: t.Number,\n        opponentHistory: t.list(t.Number),\n        upperHalf: t.Boolean,\n        rating: t.Number,\n        avoidList: t.list(t.Number),\n        hasHadBye: t.Boolean,\n        isDueBye: t.Boolean\n    },\n    \"PlayerStats\"\n);\nexport {PlayerStats};\n\nconst Match = t.interface(\n    {\n        id: t.String,\n        players: t.tuple([t.Number, t.Number]),\n        result: t.tuple([t.Number, t.Number]),\n        origRating: t.tuple([t.Number, t.Number]),\n        newRating: t.tuple([t.Number, t.Number])\n    },\n    \"Match\"\n);\nexport {Match};\n\nconst RoundList = t.list(t.list(Match));\nexport {RoundList};\n\nconst Tournament = t.interface(\n    {\n        name: t.String,\n        tieBreaks: t.list(t.Number),\n        byeQueue: t.list(t.Number),\n        players: t.list(t.Number),\n        roundList: t.list(t.list(Match))\n    },\n    \"Tournament\"\n);\nexport {Tournament};\n\nconst ScoreCalulator = t.func(\n    [t.Number, t.list(Match)],\n    t.Number,\n    \"ScoreCalulator\"\n);\nexport {ScoreCalulator};\n\nconst Standing = t.interface(\n    {\n        id: t.Number,\n        score: t.Number,\n        tieBreaks: t.list(t.Number)\n    },\n    \"Standing\"\n);\nexport {Standing};\n","import {Player, Match, Tournament} from \"./types\";\n\nexport function createMatch(importObj) {\n    return Match({\n        id: importObj.id,\n        players: importObj.players,\n        result: importObj.result || [0, 0],\n        origRating: importObj.origRating,\n        newRating: importObj.newRating\n    });\n}\n\nexport function createPlayer(importObj = {}) {\n    return Player({\n        id: importObj.id || 0,\n        type: importObj.type || \"person\", // used for CSS styling etc.\n        firstName: importObj.firstName || \"\",\n        lastName: importObj.lastName || \"\",\n        rating: importObj.rating || 0,\n        matchCount: importObj.matchCount || 0\n    });\n}\n\nexport function createTournament(importObj) {\n    return Tournament({\n        name: importObj.name || \"\",\n        tieBreaks: importObj.tieBreaks || [0, 1, 2, 3],\n        byeQueue: importObj.byeQueue || [],\n        players: importObj.players || [],\n        roundList: importObj.roundList || []\n    });\n}\n","import {BLACK, WHITE, DUMMY_ID} from \"./constants\";\nimport {createPlayer, createMatch, createTournament} from \"./factories\";\nimport {\n    AvoidList,\n    Match,\n    Player,\n    PlayerStats,\n    RoundList,\n    ScoreCalulator,\n    Standing,\n    Tournament\n} from \"./types\";\n\nconst dummyPlayer = createPlayer({\n    id: DUMMY_ID,\n    firstName: \"Bye\",\n    lastName: \"Player\",\n    type: \"dummy\"\n});\n\nconst missingPlayer = (id) => createPlayer({\n    id: id,\n    firstName: \"Anonymous\",\n    lastName: \"Player\",\n    type: \"missing\"\n});\n\nexport {\n    AvoidList,\n    BLACK,\n    DUMMY_ID,\n    Match,\n    Player,\n    PlayerStats,\n    RoundList,\n    ScoreCalulator,\n    Standing,\n    Tournament,\n    WHITE,\n    createMatch,\n    createPlayer,\n    createTournament,\n    dummyPlayer,\n    missingPlayer\n};\n","import EloRank from \"elo-rank\";\nimport t from \"tcomb\";\nimport {WHITE, BLACK} from \"../data-types\";\n\nexport function kFactor(matchCount) {\n    const ne = t.Number(matchCount) || 1;\n    return (800 / ne);\n}\n\n/**\n * @returns {[number, number]}\n */\nexport function calcNewRatings(origRatings, matchCounts, result) {\n    t.tuple([t.Number, t.Number])(origRatings);\n    t.tuple([t.Number, t.Number])(matchCounts);\n    t.tuple([t.Number, t.Number])(result);\n    const whiteElo = new EloRank(kFactor(matchCounts[WHITE]));\n    const blackElo = new EloRank(kFactor(matchCounts[BLACK]));\n    const FLOOR = 100;\n    const scoreExpected = [\n        whiteElo.getExpected(origRatings[WHITE], origRatings[BLACK]),\n        blackElo.getExpected(origRatings[BLACK], origRatings[WHITE])\n    ];\n    const newRating = [\n        whiteElo.updateRating(\n            scoreExpected[WHITE],\n            result[WHITE],\n            origRatings[WHITE]\n        ),\n        blackElo.updateRating(\n            scoreExpected[BLACK],\n            result[BLACK],\n            origRatings[BLACK]\n        )\n    ];\n    return newRating.map(\n        (rating) => (rating < FLOOR) ? FLOOR : rating\n    );\n}\n","import t from \"tcomb\";\nimport {\n    AvoidList,\n    DUMMY_ID,\n    Match,\n    Player,\n    RoundList,\n    Standing,\n    dummyPlayer,\n    missingPlayer\n} from \"../data-types\";\n/*******************************************************************************\n * Player functions\n ******************************************************************************/\nconst isNotDummy = (playerId) => playerId !== DUMMY_ID;\nexport {isNotDummy};\n\nexport function areScoresEqual(standing1, standing2) {\n    Standing(standing1);\n    Standing(standing2);\n    // Check if any of them aren't equal\n    if (standing1.score !== standing2.score) {\n        return false;\n    }\n    // Check if any tie-break values are not equal\n    return !(\n        standing1.tieBreaks.reduce(\n            (acc, value, i) => acc.concat(value !== standing2.tieBreaks[i]),\n            []\n        ).includes(true)\n    );\n}\n\nexport function getPlayerById(playerList, id) {\n    if (id === DUMMY_ID) {\n        return dummyPlayer;\n    }\n    const player = playerList.filter((p) => p.id === id)[0];\n    return (player) ? player : missingPlayer(id);\n}\n\n/*******************************************************************************\n * Match functions\n ******************************************************************************/\nconst isNotBye = (match) => !match.players.includes(DUMMY_ID);\nexport {isNotBye};\n\nfunction getMatchesByPlayer(playerId, matchList) {\n    t.list(Match)(matchList);\n    return matchList.filter((match) => match.players.includes(playerId));\n}\nexport {getMatchesByPlayer};\n\nfunction getMatchDetailsForPlayer(playerId, match) {\n    t.Number(playerId);\n    Match(match);\n    const index = match.players.indexOf(playerId);\n    return {\n        color: index,\n        newRating: match.newRating[index],\n        origRating: match.origRating[index],\n        result: match.result[index]\n    };\n}\nexport {getMatchDetailsForPlayer};\n\n/**\n * Flatten a list of rounds to a list of matches.\n */\nexport function rounds2Matches(roundList, roundId = null) {\n    RoundList(roundList);\n    t.maybe(t.Number)(roundId);\n    const rounds = (\n        (roundId === null)\n        ? roundList\n        : roundList.slice(0, roundId + 1)\n    );\n    return rounds.reduce((acc, round) => acc.concat(round), []);\n}\n\n\n/**\n * @returns {number[]}\n */\nexport function getAllPlayersFromMatches(matchList) {\n    t.list(Match)(matchList);\n    const allPlayers = matchList.reduce(\n        (acc, match) => acc.concat(match.players),\n        []\n    );\n    return Array.from(new Set(allPlayers));\n}\n\n/**\n * Get a list of all of a player's scores from each match.\n */\nexport function getPlayerScoreList(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        playerId,\n        matchList,\n    ).map(\n        (match) => getMatchDetailsForPlayer(playerId, match).result\n    );\n}\n\n/**\n * TODO: Maybe merge this with the other function?\n * @returns {number[]}\n */\nexport function getPlayerScoreListNoByes(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        playerId,\n        matchList\n    ).filter(\n        isNotBye\n    ).map(\n        (match) => getMatchDetailsForPlayer(playerId, match).result\n    );\n}\n\n/*******************************************************************************\n * Round functions\n ******************************************************************************/\nexport function calcNumOfRounds(playerCount) {\n    const rounds = Math.ceil(Math.log2(playerCount));\n    return (Number.isFinite(rounds)) ? rounds : 0;\n}\n\n/*******************************************************************************\n * Avoid list functions\n ******************************************************************************/\nexport function getPlayerAvoidList(playerId, avoidList) {\n    AvoidList(avoidList);\n    t.Number(playerId);\n    return avoidList.filter( // get pairings with the player\n        (pair) => pair.includes(playerId)\n    ).reduce( // Flatten the array\n        (accumulator, pair) => pair.concat(accumulator),\n        []\n    ).filter( // filter out the player's id\n        (id) => id !== playerId\n    );\n}\n\nexport function cleanAvoidList(avoidList, playerList) {\n    AvoidList(avoidList);\n    t.list(Player)(playerList);\n    const ids = playerList.map((p) => p.id);\n    return avoidList.filter(\n        (pairs) => (ids.includes(pairs[0]) && ids.includes(pairs[1]))\n    );\n}\n","// TODO: Clean this up. Refactor unnecessary functions, etc.\nimport {\n    init,\n    last,\n    pipe,\n    sort,\n    sum,\n    tail\n} from \"ramda\";\nimport {firstBy} from \"thenby\";\nimport t from \"tcomb\";\nimport {\n    BLACK,\n    DUMMY_ID,\n    Match,\n    ScoreCalulator,\n    WHITE\n} from \"../data-types\";\nimport {\n    getMatchesByPlayer,\n    getMatchDetailsForPlayer,\n    isNotBye,\n    isNotDummy,\n    getPlayerScoreList,\n    getPlayerScoreListNoByes\n} from \"./helpers\";\n\n/**\n * @returns {typeof WHITE | typeof BLACK?}\n */\n\nexport function getDueColor(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    const lastMatch = last(getMatchesByPlayer(playerId, matchList));\n    if (!lastMatch) {\n        return null;\n    }\n    const {color} = getMatchDetailsForPlayer(playerId, lastMatch);\n    return (color === WHITE) ? BLACK : WHITE;\n}\n\n/**\n * @returns {boolean}\n */\nfunction hasHadBye(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        playerId,\n        matchList\n    ).reduce(\n        (acc, match) => acc.concat(match.players),\n        []\n    ).includes(DUMMY_ID);\n}\nexport {hasHadBye};\n\n/**\n * @returns {number[]}\n */\nexport function getPlayersByOpponent(opponentId, matchList) {\n    t.Number(opponentId);\n    t.list(Match)(matchList);\n    return getMatchesByPlayer(\n        opponentId,\n        matchList\n    ).reduce(\n        (acc, match) => acc.concat(match.players),\n        []\n    ).filter(\n        (playerId) => playerId !== opponentId\n    );\n}\n\n/**\n * Used for `modifiedMedian` and `solkoff`.\n * @returns {number[]}\n */\nfunction getOpponentScores(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    const scores = getPlayersByOpponent(\n        playerId,\n        matchList\n    ).filter(\n        isNotDummy\n    ).map(\n        (opponent) => getPlayerScore(opponent, matchList)\n    );\n    return scores;\n}\n\n/*******************************************************************************\n * The main scoring methods\n ******************************************************************************/\n/**\n * @returns {number}\n */\nconst getPlayerScore = ScoreCalulator.of(\n    function (playerId, matchList) {\n        const scoreList = getPlayerScoreList(playerId, matchList);\n        return sum(scoreList);\n    }\n);\nexport {getPlayerScore};\n\n/**\n * The player's cumulative score.\n * @returns {number}\n */\nconst getCumulativeScore = ScoreCalulator.of(\n    function (playerId, matchList) {\n        const scoreList = getPlayerScoreListNoByes(\n            playerId,\n            matchList\n        ).reduce( // turn the regular score list into a \"running\" score list\n            (acc, score) => acc.concat([last(acc) + score]),\n            [0]\n        );\n        return sum(scoreList);\n    }\n);\n\n/**\n * Get the cumulative scores of a player's opponents.\n * @returns {number}\n */\nconst getCumulativeOfOpponentScore = ScoreCalulator.of(\n    function (playerId, matchList) {\n        const oppScores = getPlayersByOpponent(\n            playerId,\n            matchList\n        ).filter(\n            isNotDummy\n        ).map(\n            (id) => getCumulativeScore(id, matchList)\n        );\n        return sum(oppScores);\n    }\n);\n\n/**\n * Calculate a player's color balance. A negative number means they played as\n * white more. A positive number means they played as black more.\n * @returns {number}\n */\nconst getColorBalanceScore = ScoreCalulator.of(\n    function (playerId, matchList) {\n        const colorList = getMatchesByPlayer(\n            playerId,\n            matchList\n        ).filter(\n            isNotBye\n        ).reduce(\n            (acc, match) => (\n                (match.players[WHITE] === playerId)\n                ? acc.concat(-1) // White = -1\n                : acc.concat(1) // Black = +1\n            ),\n            [0]\n        );\n        return sum(colorList);\n    }\n);\nexport {getColorBalanceScore};\n\n/**\n * Gets the modified median factor defined in USCF  34E1\n * @returns {number}\n */\nconst getModifiedMedianScore = ScoreCalulator.of(\n    function (playerId, matchList) {\n        const scores = getOpponentScores(playerId, matchList);\n        return pipe(\n            sort((a, b) => a - b),\n            init,\n            tail,\n            sum\n        )(scores);\n    }\n);\n\n/**\n * @returns {number}\n */\nconst getSolkoffScore = ScoreCalulator.of(\n    function (playerId, matchList) {\n        const scoreList = getOpponentScores(playerId, matchList);\n        return sum(scoreList);\n    }\n);\n\nconst tieBreakMethods = [\n    {\n        name: \"Modified median\",\n        func: getModifiedMedianScore\n    },\n    {\n        name: \"Solkoff\",\n        func: getSolkoffScore\n    },\n    {\n        name: \"Cumulative score\",\n        func: getCumulativeScore\n    },\n    {\n        name: \"Cumulative of opposition\",\n        func: getCumulativeOfOpponentScore\n    },\n    {\n        name: \"Most black\",\n        func: getColorBalanceScore\n    }\n];\nObject.freeze(tieBreakMethods);\nexport {tieBreakMethods};\n\n/**\n * Create a function to sort the standings. This dynamically creates a `thenBy`\n * function based on the desired tiebreak sort methods.\n * @returns A function to be used with a list of standings and `sort()`.\n */\nexport function createTieBreakSorter(tieBreaks) {\n    return tieBreaks.reduce(\n        (acc, ignore, index) => (\n            acc.thenBy(\n                (standing1, standing2) => (\n                    standing2.tieBreaks[index] - standing1.tieBreaks[index]\n                )\n            )\n        ),\n        firstBy((standing1, standing2) => standing2.score - standing1.score)\n    );\n}\n","import t from \"tcomb\";\nimport {\n    add,\n    append,\n    defaultTo,\n    last,\n    lensIndex,\n    lensProp,\n    over,\n    pipe,\n    sort\n} from \"ramda\";\nimport {\n    AvoidList,\n    Match,\n    Player,\n    PlayerStats,\n    RoundList,\n    Standing\n} from \"../data-types\";\nimport {\n    areScoresEqual,\n    getAllPlayersFromMatches,\n    getMatchesByPlayer,\n    getPlayerAvoidList,\n    getPlayerById,\n    getMatchDetailsForPlayer,\n    isNotDummy,\n    rounds2Matches\n} from \"./helpers\";\nimport {\n    createTieBreakSorter,\n    getDueColor,\n    getColorBalanceScore,\n    getPlayerScore,\n    getPlayersByOpponent,\n    hasHadBye,\n    tieBreakMethods\n} from \"./scoring\";\n/**\n * Sort the standings by score, see USCF tie-break rules from  34.\n * @returns {[typeof Standing[], string[]]} The standings and the list of method used\n */\nexport function createStandingList(methods, roundList, roundId) {\n    t.list(t.Number)(methods);\n    t.list(t.Array)(roundList);\n    t.maybe(t.Number)(roundId);\n    const matchList = rounds2Matches(roundList, roundId);\n    const selectedTieBreaks = methods.map((i) => tieBreakMethods[i]);\n    const tieBreakNames = selectedTieBreaks.map((m) => m.name);\n    // Get a flat list of all of the players and their scores.\n    const standings = getAllPlayersFromMatches(\n        matchList\n    ).filter(\n        isNotDummy\n    ).map(\n        (id) => Standing({\n            id,\n            score: getPlayerScore(id, matchList),\n            tieBreaks: selectedTieBreaks.map(\n                (method) => method.func(id, matchList)\n            )\n        })\n    );\n    const sortFunc = createTieBreakSorter(selectedTieBreaks);\n    const standingsSorted = sort(sortFunc, standings);\n    return [standingsSorted, tieBreakNames];\n}\n\n/**\n * Sort the standings by score, see USCF tie-break rules from  34.\n * example: `[[Dale, Audrey], [Pete], [Bob]]`\n * Dale and Audrey are tied for first, Pete is 2nd, Bob is 3rd.\n * @returns {[Standing[][], string[]]} The standings and the list of method used\n */\nexport function createStandingTree(methods, roundList, roundId = null) {\n    t.list(t.Number)(methods);\n    RoundList(roundList);\n    t.maybe(t.Number)(roundId);\n    const [\n        standingsFlat,\n        tieBreakNames\n    ] = createStandingList(methods, roundList, roundId);\n    const standingsTree = standingsFlat.reduce(\n        /** @param {Standing[][]} acc*/\n        function (acc, standing, i, orig) {\n            const prevStanding = orig[i - 1];\n            const isNewRank = (\n                (i === 0)\n                ? true // Always make a new rank for the first player\n                : !areScoresEqual(standing, prevStanding)\n            );\n            if (isNewRank) {\n                return append([standing], acc);\n            }\n            // If this player has the same score as the last, list them together\n            return over(lensIndex(acc.length - 1), append(standing), acc);\n        },\n        []\n    );\n    return [standingsTree, tieBreakNames];\n}\n\n/**\n * @returns {PlayerStats}\n */\nexport function createPlayerStats({\n    id,\n    playerDataSource,\n    avoidList,\n    roundList,\n    roundId\n}) {\n    t.Number(id);\n    t.Number(roundId);\n    t.list(Player)(playerDataSource);\n    AvoidList(avoidList);\n    RoundList(roundList);\n    const player = getPlayerById(playerDataSource, id);\n    const matches = rounds2Matches(roundList, roundId);\n    return PlayerStats({\n        profile: player,\n        rating: player.rating, // is this shortcut necessary?\n        id: id, // is this shortcut necessary?\n        score: getPlayerScore(id, matches),\n        dueColor: getDueColor(id, matches),\n        colorBalance: getColorBalanceScore(id, matches),\n        opponentHistory: getPlayersByOpponent(id, matches),\n        upperHalf: false,\n        avoidList: getPlayerAvoidList(id, avoidList),\n        hasHadBye: hasHadBye(id, matches),\n        isDueBye: false\n    });\n}\n\n/**\n * @returns {Object.<string, number>} {opponentId: result}\n */\nfunction getResultsByOpponent(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    const matches = getMatchesByPlayer(playerId, matchList);\n    return matches.reduce(\n        function (acc, match) {\n            const opponent = match.players.filter(\n                (id) => id !== playerId\n            )[0];\n            const {result} = getMatchDetailsForPlayer(playerId, match);\n            // This sets a default result of 0 and then adds the existing\n            // result. Most of the time, this would be the same as using\n            // `set()` with the result, but if two players play each other\n            // multiple times then the total results will be displayed.\n            return over(\n                lensProp(String(opponent)),\n                pipe(defaultTo(0), add(result)),\n                acc\n            );\n        },\n        {}\n    );\n}\nexport {getResultsByOpponent};\n\nfunction getPerformanceRatings(playerId, matchList) {\n    t.Number(playerId);\n    t.list(Match)(matchList);\n    const matches = getMatchesByPlayer(playerId, matchList);\n    const firstMatch = matches[0];\n    const lastMatch = last(matches);\n    return [\n        getMatchDetailsForPlayer(playerId, firstMatch).origRating,\n        getMatchDetailsForPlayer(playerId, lastMatch).newRating\n    ];\n}\nexport {getPerformanceRatings};\n","// This file is a work in progress. The weighting for the ratings needs to be\n// tweaked a lot, and the pairing function itself needs to be cleaned up and\n// made more reusable.\nimport {firstBy} from \"thenby\";\nimport {\n    add,\n    assoc,\n    curry,\n    filter,\n    findLastIndex,\n    lensIndex,\n    map,\n    pipe,\n    over,\n    reverse,\n    splitAt,\n    sort,\n    view\n} from \"ramda\";\nimport blossom from \"edmonds-blossom\";\nimport t from \"tcomb\";\nimport {createPlayerStats} from \"./factories\";\nimport {\n    AvoidList,\n    DUMMY_ID,\n    Player,\n    PlayerStats,\n    RoundList\n} from \"../data-types\";\n\nconst priority = (value) => (condition) => condition ? value : 0;\nconst divisiblePriority = (value) => (divider) => value / divider;\n/**\n * TODO: These probably need to be tweaked a lot.\n */\n/**\n * @constant avoidMeetingTwicePriority The weight given to avoid players\n * meeting twice. This same weight is given to avoid matching players on each\n * other's \"avoid\" list. This is the highest priority. (USCF  27A1)\n */\nconst avoidMeetingTwice = priority(20);\n/**\n * @constant sameScoresPriority The weight given to match players with\n * equal scores. This gets divided against the difference between each players'\n * scores, plus one. For example, players with scores `1` and `3` would have\n * this priority divided by `3`. Players with scores `0` and `3` would have this\n * priority divided by `4`. Players with equal scores would divide it by `1`,\n * leaving it unchanged. (USCF  27A2)\n */\nconst sameScores = divisiblePriority(16);\n\n/**\n * @constant differentHalfPriority The weight given to match players in lower\n * versus upper halves. This is only applied to players being matched within\n * the same score group. (USCF  27A3)\n */\nconst differentHalf = priority(2);\n/**\n * @constant differentDueColorPriority The weight given to match players with\n * opposite due colors. (USCF  27A4 and  27A5)\n */\nconst differentDueColor = priority(1);\n\nconst maxPriority = pipe(\n    add(differentHalf(true)),\n    add(differentDueColor(true)),\n    add(sameScores(1)),\n    add(avoidMeetingTwice(true))\n)(0);\nexport {maxPriority};\n\n/**\n * @returns {number}\n */\nexport function calcPairIdeal(player1, player2) {\n    PlayerStats(player1);\n    PlayerStats(player2);\n    if (player1.id === player2.id) {\n        return 0;\n    }\n    const metBefore = player1.opponentHistory.includes(player2.id);\n    const mustAvoid = player1.avoidList.includes(player2.id);\n    return pipe(\n        add(differentHalf(\n            player1.upperHalf !== player2.upperHalf\n            && player1.score === player2.score\n        )),\n        add(differentDueColor(\n            player1.dueColor === null\n            || player1.dueColor !== player2.dueColor\n        )),\n        add(sameScores(Math.abs(player1.score - player2.score) + 1)),\n        add(avoidMeetingTwice(!metBefore && !mustAvoid))\n    )(0);\n}\n\n/**\n * Determine which players are in the upper and lower halves of their score\n * groups.\n * This function does not sort the list. The list should be sorted first.\n */\nexport function setUpperHalves(playerStatsList) {\n    t.list(PlayerStats)(playerStatsList);\n    const splitInHalf = (list) => splitAt(list.length / 2, list);\n    return playerStatsList.reduce(\n        function (acc, player, ignore, src) {\n            const upperHalfIds = pipe(\n                filter((a) => a.score === player.score),\n                splitInHalf,\n                view(lensIndex(0)),\n                map((a) => a.id)\n            )(src);\n            const isUpperHalf = upperHalfIds.includes(player.id);\n            return acc.concat([assoc(\"upperHalf\", isUpperHalf, player)]);\n        },\n        []\n    );\n}\n\nfunction setByePlayer(byeQueue, playerStatsList) {\n    t.list(t.Number)(byeQueue);\n    t.list(PlayerStats)(playerStatsList);\n    // if the list is even, just return it.\n    if (playerStatsList.length % 2 === 0) {\n        return playerStatsList;\n    }\n    const hasNotHadBye = playerStatsList.filter(\n        (p) => !p.hasHadBye\n    ).map((p) => p.id);\n    const nextByeSignup = byeQueue.filter((id) => hasNotHadBye.includes(id))[0];\n    const indexOfDueBye = (\n        (nextByeSignup)\n        // Assign the bye to the next person who signed up.\n        ? findLastIndex((p) => p.id === nextByeSignup, playerStatsList)\n        // Assign a bye to the lowest-rated player in the lowest score group.\n        // Because the list is sorted, the last player is the lowest.\n        // (USCF  29L2.)\n        : findLastIndex((p) => !p.hasHadBye, playerStatsList)\n    );\n    // In the impossible situation that *everyone* has played a bye round\n    // previously, then just pick the last player.\n    const index = (\n        (indexOfDueBye === -1)\n        ? playerStatsList.length - 1\n        : indexOfDueBye\n    );\n    return over(\n        lensIndex(index),\n        assoc(\"isDueBye\", true),\n        playerStatsList\n    );\n}\n\n/**\n * Sort the data so matchups default to order by score and rating.\n */\nexport function sortPlayersForPairing(playerStatsList) {\n    t.list(PlayerStats)(playerStatsList);\n    return sort(\n        firstBy(\n            (a, b) => b.score - a.score\n        ).thenBy(\n            (a, b) => b.rating - a.rating\n        ),\n        playerStatsList\n    );\n}\n\n/**\n * Creates pairings according to the rules specified in USCF  27,  28,\n * and  29. This is a work in progress and does not account for all of the\n * rules yet.\n */\nexport default function pairPlayers({\n    playerIds,\n    roundId,\n    roundList,\n    playerDataSource,\n    avoidList,\n    byeQueue\n}) {\n    t.list(t.Number)(playerIds);\n    t.Number(roundId);\n    t.list(Player)(playerDataSource);\n    t.list(t.Number)(byeQueue);\n    RoundList(roundList);\n    AvoidList(avoidList);\n    const playerStatsList = pipe(\n        map((id) => (\n            createPlayerStats({\n                id,\n                playerDataSource,\n                avoidList,\n                roundList,\n                roundId\n            })\n        )),\n        sortPlayersForPairing,\n        setUpperHalves,\n        curry(setByePlayer)(byeQueue)\n    )(playerIds);\n    // Turn the data into blossom-compatible input.\n    const potentialMatches = playerStatsList.filter(\n        (p) => !p.isDueBye\n    ).reduce(\n        function (acc, player1, ignore, src) {\n            const playerMatches = src.map(\n                (player2) => [\n                    player1.id,\n                    player2.id,\n                    calcPairIdeal(player1, player2)\n                ]\n            );\n            return acc.concat(playerMatches);\n        },\n        []\n    );\n    // Feed all of the potential matches to Edmonds-blossom and let the\n    // algorithm work its magic. This returns an array where each index is the\n    // ID of one player and each value is the ID of the matched player.\n    const blossomResults = blossom(potentialMatches);\n    // Translate those IDs into actual pairs of players.\n    /** @type {[PlayerStats, PlayerStats, number][]} */\n    const reducedResults = blossomResults.reduce(\n        function (acc, p1Id, p2Id) {\n            // Filter out unmatched players. Blossom will automatically include\n            // their missing IDs in its results.\n            if (p1Id !== -1) {\n                const p1 = playerStatsList.filter((p) => p.id === p1Id)[0];\n                const p2 = playerStatsList.filter((p) => p.id === p2Id)[0];\n                const ideal = potentialMatches.filter(\n                    (pair) => pair[0] === p1Id && pair[1] === p2Id\n                )[0][2];\n                // Blossom returns a lot of redundant matches. Check that this\n                // matchup wasn't already added.\n                const matched = acc.map((pair) => pair[0]);\n                if (!matched.includes(p1) && !matched.includes(p2)) {\n                    return acc.concat([[p1, p2, ideal]]);\n                }\n            }\n            return acc;\n        },\n        []\n    );\n    // Sort by net score and rating for board placement.\n    const sortedResults = sort(\n        firstBy((pair1, pair2) => (\n            pair2[0].score + pair2[1].score - pair1[0].score - pair1[1].score\n        )).thenBy((pair1, pair2) => (\n            pair2[0].rating + pair2[1].rating\n            - pair1[0].rating - pair1[1].rating\n        )),\n        reducedResults\n    );\n    const matches = sortedResults.map(\n        function (pair) {\n            const player1 = pair[0];\n            const player2 = pair[1];\n            const match = [player1.id, player2.id];\n            if (player1.colorBalance < player2.colorBalance) {\n                return reverse(match);\n            }\n            return match;\n        }\n    );\n    // The bye match always gets added last so the the numbering isn't affected.\n    const byePlayer = playerStatsList.filter((p) => p.isDueBye)[0];\n    if (byePlayer) {\n        return matches.concat([[byePlayer.id, DUMMY_ID]]);\n    }\n    return matches;\n}\n","import {\n    createContext,\n    createElement,\n    useContext,\n    useReducer,\n    useEffect\n} from \"react\";\nimport {\n    append,\n    assoc,\n    curry,\n    head,\n    inc,\n    lensPath,\n    lensIndex,\n    filter,\n    findIndex,\n    map,\n    mergeLeft,\n    over,\n    pipe,\n    propEq,\n    set,\n    sort\n} from \"ramda\";\nimport t from \"tcomb\";\nimport {localStorageOrDefault} from \"./helpers\";\nimport {getPlayerById} from \"../pairing-scoring\";\nimport {createPlayer} from \"../data-types\";\nimport demoPlayers from \"./demo-players.json\";\n\nconst defaultPlayers = {\n    players: demoPlayers.playerList.map((p) => createPlayer(p)),\n    avoid: demoPlayers.avoidList\n};\n\nconst ActionSetPlayer = t.interface({\n    firstName: t.String,\n    lastName: t.String,\n    rating: t.Number,\n    matchCount: t.Number,\n    id: t.Number\n});\nconst ActionAddPlayer = t.interface({\n    firstName: t.String,\n    lastName: t.String,\n    rating: t.Number\n});\nconst ActionDelPlayer = t.interface({\n    id: t.Number\n});\nconst ActionSetMatchcount = t.interface({\n    id: t.Number,\n    matchCount: t.Number\n});\nconst ActionSetRating = t.interface({\n    id: t.Number,\n    rating: t.Number\n});\nconst ActionAvoidPair = t.interface({\n    pair: t.tuple([t.Number, t.Number])\n});\nconst ActionLoadState = t.interface({state: t.Any});\nconst ActionTypes = t.union([\n    ActionSetPlayer,\n    ActionAddPlayer,\n    ActionDelPlayer,\n    ActionSetMatchcount,\n    ActionSetRating,\n    ActionAvoidPair,\n    ActionLoadState\n]);\nActionTypes.dispatch = function (x) {\n    const typeToConstructor = {\n        \"SET_PLAYER\": ActionSetPlayer,\n        \"ADD_PLAYER\": ActionAddPlayer,\n        \"DEL_PLAYER\": ActionDelPlayer,\n        \"SET_PLAYER_MATCHCOUNT\": ActionSetMatchcount,\n        \"SET_PLAYER_RATING\": ActionSetRating,\n        \"ADD_AVOID_PAIR\": ActionAvoidPair,\n        \"DEL_AVOID_PAIR\": ActionAvoidPair,\n        \"LOAD_STATE\": ActionLoadState\n    };\n    return typeToConstructor[x.type];\n};\n\n/**\n * @param {typeof defaultPlayers} state\n * @param {PlayerAction} action\n */\nfunction playersReducer(state, action ) {\n    ActionTypes(action);\n    const getNextId = pipe(map((p) => p.id), sort((a, b) => b - a), head, inc);\n    switch (action.type) {\n    case \"ADD_PLAYER\":\n        return over(\n            lensPath([\"players\"]),\n            append(createPlayer({\n                firstName: action.firstName,\n                lastName: action.lastName,\n                rating: action.rating,\n                id: getNextId(state.players)\n            })),\n            state\n        );\n    case \"SET_PLAYER\":\n        return assoc(\n            \"players\",\n            over(\n                lensIndex(findIndex(propEq(\"id\", action.id), state.players)),\n                mergeLeft(\n                    {\n                        firstName: action.firstName,\n                        lastName: action.lastName,\n                        rating: action.rating,\n                        matchCount: action.matchCount\n                    }\n                ),\n                state.players\n            ),\n            state\n        );\n    case \"DEL_PLAYER\":\n        return pipe(\n            over(\n                lensPath([\"avoid\"]),\n                filter((pair) => !pair.includes(action.id)),\n            ),\n            over(\n                lensPath([\"players\"]),\n                filter((p) => p.id !== action.id),\n            )\n        )(state);\n    case \"SET_PLAYER_MATCHCOUNT\":\n        return set(\n            lensPath([\n                \"players\",\n                findIndex(propEq(\"id\", action.id), state.players),\n                \"matchCount\"\n            ]),\n            action.matchCount,\n            state\n        );\n    case \"SET_PLAYER_RATING\":\n        return set(\n            lensPath([\n                \"players\",\n                findIndex(propEq(\"id\", action.id), state.players),\n                \"rating\"\n            ]),\n            action.rating,\n            state\n        );\n    // Avoid\n    case \"ADD_AVOID_PAIR\":\n        return over(\n            lensPath([\"avoid\"]),\n            append(action.pair),\n            state\n        );\n    case \"DEL_AVOID_PAIR\":\n        return over(\n            lensPath([\"avoid\"]),\n            filter((pair) => !(\n                pair.includes(action.pair[0])\n                && pair.includes(action.pair[1])\n            )),\n            state\n        );\n    case \"LOAD_STATE\":\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type\");\n    }\n}\n\nconst PlayerContext = createContext(null);\n\nexport function usePlayers() {\n    const [playerState, playerDispatch] = useContext(PlayerContext);\n    const getPlayer = curry(getPlayerById)(playerState.players);\n    return {playerState, playerDispatch, getPlayer};\n}\n\nexport function PlayersProvider(props) {\n    const loadedData = localStorageOrDefault(\"players\", defaultPlayers);\n    const [state, dispatch] = useReducer(playersReducer, loadedData);\n    useEffect(\n        function () {\n            localStorage.setItem(\"players\", JSON.stringify(state));\n        },\n        [state]\n    );\n    return (\n        createElement(\n            PlayerContext.Provider,\n            {value: [state, dispatch]},\n            props.children\n        )\n    );\n}\n","import {curry, assoc} from \"ramda\";\nimport {BLACK, WHITE, DUMMY_ID, createMatch} from \"../data-types\";\nimport {getPlayerById, pairPlayers} from \"../pairing-scoring\";\n\nexport function autoPair(\n    tourney,\n    playerState,\n    roundId,\n    unPairedPlayers,\n    byeValue\n) {\n    const roundList = tourney.roundList;\n    const getPlayer = curry(getPlayerById)(playerState.players);\n    const pairs = pairPlayers({\n        playerIds: unPairedPlayers,\n        roundId,\n        roundList,\n        playerDataSource: playerState.players,\n        avoidList: playerState.avoid,\n        byeQueue: tourney.byeQueue\n    });\n    const newMatchList = pairs.map(\n        (pair) => createMatch({\n            id: pair.join(\"-\"),\n            players: [pair[WHITE], pair[BLACK]],\n            origRating: [\n                getPlayer(pair[WHITE]).rating,\n                getPlayer(pair[BLACK]).rating\n            ],\n            newRating: [\n                getPlayer(pair[WHITE]).rating,\n                getPlayer(pair[BLACK]).rating\n            ]\n        })\n    );\n    return newMatchList.reduce(\n        // Set match results for bye matches\n        function (acc, match) {\n            if (match.players[WHITE] === DUMMY_ID) {\n                return acc.concat([assoc(\"result\", [0, byeValue], match)]);\n            }\n            if (match.players[BLACK] === DUMMY_ID) {\n                return acc.concat([assoc(\"result\", [byeValue, 0], match)]);\n            }\n            return acc.concat([match]);\n        },\n        []\n    );\n}\n\nexport function manualPair(players, pair, byeValue) {\n    const getPlayer = curry(getPlayerById)(players);\n    const match = createMatch({\n        id: pair.join(\"-\"),\n        players: [pair[WHITE], pair[BLACK]],\n        origRating: [\n            getPlayer(pair[WHITE]).rating,\n            getPlayer(pair[BLACK]).rating\n        ],\n        newRating: [\n            getPlayer(pair[WHITE]).rating,\n            getPlayer(pair[BLACK]).rating\n        ]\n    });\n    if (pair[WHITE] === DUMMY_ID) {\n        return assoc(\"result\", [0, byeValue], match);\n    }\n    if (pair[BLACK] === DUMMY_ID) {\n        return assoc(\"result\", [byeValue, 0], match);\n    }\n    return match;\n}\n","import {\n    createContext,\n    createElement,\n    useContext,\n    useReducer,\n    useEffect\n} from \"react\";\nimport {\n    __,\n    append,\n    concat,\n    difference,\n    lensPath,\n    mergeRight,\n    filter,\n    findIndex,\n    move,\n    over,\n    propEq,\n    remove,\n    reverse,\n    set\n} from \"ramda\";\nimport t from \"tcomb\";\nimport {localStorageOrDefault} from \"./helpers\";\nimport defaultTourneyList from \"./demo-tourney.json\";\nimport {autoPair, manualPair} from \"./match-functions\";\nimport {createTournament, Player} from \"../data-types\";\n\nconst ActionAddTourney = t.interface({\n    name: t.String\n});\nconst ActionDelTourney = t.interface({\n    index: t.Number\n});\nconst ActionAddRound = t.interface({\n    tourneyId: t.Number\n});\nconst ActionDelLastRound = t.interface({\n    tourneyId: t.Number,\n    players: t.list(Player)\n});\nconst ActionAddRemoveTieBreak = t.interface({\n    tourneyId: t.Number,\n    id: t.Number\n});\nconst ActionMoveTieBreak = t.interface({\n    tourneyId: t.Number,\n    oldIndex: t.Number,\n    newIndex: t.Number\n});\nconst ActionSetTourneyPlayers = t.interface({\n    tourneyId: t.Number,\n    players: t.list(t.Number)\n});\nconst ActionSetByeQueue = t.interface({\n    tourneyId: t.Number,\n    byeQueue: t.list(t.Number)\n});\nconst ActionAutoPair = t.interface({\n    tourneyId: t.Number,\n    roundId: t.Number,\n    unpairedPlayers: t.list(t.Number),\n    playerState: t.Any,\n    byeValue: t.Number\n});\nconst ActionManualPair = t.interface({\n    tourneyId: t.Number,\n    roundId: t.Number,\n    pair: t.list(t.Number),\n    players: t.list(Player),\n    byeValue: t.Number\n});\nconst ActionSetMatchResult = t.interface({\n    tourneyId: t.Number,\n    roundId: t.Number,\n    matchId: t.String,\n    result: t.tuple([t.Number, t.Number]),\n    newRating: t.tuple([t.Number, t.Number])\n});\nconst ActionEditMatch = t.interface({\n    tourneyId: t.Number,\n    roundId: t.Number,\n    matchId: t.String\n});\nconst ActionMoveMatch = t.interface({\n    tourneyId: t.Number,\n    roundId: t.Number,\n    oldIndex: t.Number,\n    newIndex: t.Number\n});\nconst ActionLoadState = t.interface({state: t.Any});\nconst ActionTypes = t.union([\n    ActionLoadState,\n    ActionAddTourney,\n    ActionDelTourney,\n    ActionAddRound,\n    ActionDelLastRound,\n    ActionAddRemoveTieBreak,\n    ActionAddRemoveTieBreak,\n    ActionMoveTieBreak,\n    ActionSetTourneyPlayers,\n    ActionSetByeQueue,\n    ActionAutoPair,\n    ActionManualPair,\n    ActionSetMatchResult,\n    ActionEditMatch,\n    ActionMoveMatch\n]);\nActionTypes.dispatch = function (x) {\n    const typeToConstructor = {\n        \"LOAD_STATE\": ActionLoadState,\n        \"ADD_TOURNEY\": ActionAddTourney,\n        \"DEL_TOURNEY\": ActionDelTourney,\n        \"ADD_ROUND\": ActionAddRound,\n        \"DEL_LAST_ROUND\": ActionDelLastRound,\n        \"ADD_TIEBREAK\": ActionAddRemoveTieBreak,\n        \"DEL_TIEBREAK\": ActionAddRemoveTieBreak,\n        \"MOVE_TIEBREAK\": ActionMoveTieBreak,\n        \"SET_TOURNEY_PLAYERS\": ActionSetTourneyPlayers,\n        \"SET_BYE_QUEUE\": ActionSetByeQueue,\n        \"AUTO_PAIR\": ActionAutoPair,\n        \"MANUAL_PAIR\": ActionManualPair,\n        \"SET_MATCH_RESULT\": ActionSetMatchResult,\n        \"DEL_MATCH\": ActionEditMatch,\n        \"SWAP_COLORS\": ActionEditMatch,\n        \"MOVE_MATCH\": ActionMoveMatch\n    };\n    return typeToConstructor[x.type];\n};\n\nfunction tourneysReducer(state, action) {\n    ActionTypes(action);\n    switch (action.type) {\n    case \"ADD_TOURNEY\":\n        return append(createTournament({name: action.name}), state);\n    case \"DEL_TOURNEY\":\n        return state.filter((ignore, i) => i !== action.index);\n    case \"ADD_ROUND\":\n        return over(\n            lensPath([action.tourneyId, \"roundList\"]),\n            append([]),\n            state\n        );\n    case \"DEL_LAST_ROUND\":\n        return over(\n            lensPath([action.tourneyId, \"roundList\"]),\n            remove(-1, 1),\n            state\n        );\n    case \"ADD_TIEBREAK\":\n        return over(\n            lensPath([action.tourneyId, \"tieBreaks\"]),\n            append(action.id),\n            state\n        );\n    case \"DEL_TIEBREAK\":\n        return over(\n            lensPath([action.tourneyId, \"tieBreaks\"]),\n            filter((id) => id !== action.id),\n            state\n        );\n    case \"MOVE_TIEBREAK\":\n        return over(\n            lensPath([action.tourneyId, \"tieBreaks\"]),\n            move(action.oldIndex, action.newIndex),\n            state\n        );\n    case \"SET_TOURNEY_PLAYERS\":\n        return set(\n            lensPath([action.tourneyId, \"players\"]),\n            action.players,\n            state\n        );\n    case \"SET_BYE_QUEUE\":\n        return set(\n            lensPath([action.tourneyId, \"byeQueue\"]),\n            action.byeQueue,\n            state\n        );\n    case \"AUTO_PAIR\":\n        return over(\n            lensPath([action.tourneyId, \"roundList\", action.roundId]),\n            concat(\n                __,\n                autoPair(\n                    state[action.tourneyId],\n                    action.playerState,\n                    action.roundId,\n                    action.unpairedPlayers,\n                    action.byeValue\n                )\n            ),\n            state\n        );\n    case \"MANUAL_PAIR\":\n        return over(\n            lensPath([action.tourneyId, \"roundList\", action.roundId]),\n            append(manualPair(action.players, action.pair, action.byeValue)),\n            state\n        );\n    case \"SET_MATCH_RESULT\":\n        return set(\n            lensPath([\n                action.tourneyId,\n                \"roundList\",\n                action.roundId,\n                findIndex(\n                    propEq(\"id\", action.matchId),\n                    state[action.tourneyId].roundList[action.roundId]\n                ),\n                \"result\"\n            ]),\n            action.result,\n            set(\n                lensPath([\n                    action.tourneyId,\n                    \"roundList\",\n                    action.roundId,\n                    findIndex(\n                        propEq(\"id\", action.matchId),\n                        state[action.tourneyId].roundList[action.roundId]\n                    ),\n                    \"newRating\"\n                ]),\n                action.newRating,\n                state\n            )\n        );\n    case \"DEL_MATCH\":\n        return over(\n            lensPath([action.tourneyId, \"roundList\", action.roundId]),\n            filter((match) => match.id !== action.matchId),\n            state\n        );\n    case \"SWAP_COLORS\":\n        return over(\n            lensPath([\n                action.tourneyId,\n                \"roundList\",\n                action.roundId,\n                findIndex(\n                    propEq(\"id\", action.matchId),\n                    state[action.tourneyId].roundList[action.roundId]\n                )\n            ]),\n            (match) => mergeRight(\n                match,\n                {\n                    result: reverse(match.result),\n                    players: reverse(match.players),\n                    origRating: reverse(match.origRating),\n                    newRating: reverse(match.newRating)\n                }\n            ),\n            state\n        );\n    case \"MOVE_MATCH\":\n        return over(\n            lensPath([action.tourneyId, \"roundList\", action.roundId]),\n            move(action.oldIndex, action.newIndex),\n            state\n        );\n    case \"LOAD_STATE\":\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type \" + action.type);\n    }\n}\n\nconst TournamentContext = createContext(null);\n\nexport function useTournaments() {\n    return useContext(TournamentContext);\n}\n\nexport function useTournament(tourneyId) {\n    const [tourneys, dispatch] = useContext(TournamentContext);\n    return [tourneys[tourneyId], dispatch];\n}\n\nexport function useRound(tourneyId, roundId) {\n    const [tourney, dispatch] = useTournament(tourneyId);\n    const matchList = tourney.roundList[roundId];\n    const matched = matchList.reduce(\n        (acc, match) => acc.concat(match.players),\n        []\n    );\n    const unmatched = difference(tourney.players, matched);\n    return {tourney, dispatch, unmatched, matchList};\n}\n\nexport function TournamentProvider(props) {\n    const loadedData = localStorageOrDefault(\"tourneys\", defaultTourneyList);\n    const [state, dispatch] = useReducer(tourneysReducer, loadedData);\n    useEffect(\n        function () {\n            localStorage.setItem(\"tourneys\", JSON.stringify(state));\n        },\n        [state]\n    );\n    return (\n        createElement(\n            TournamentContext.Provider,\n            {value: [state, dispatch]},\n            props.children\n        )\n    );\n}\n","import {\n    createContext,\n    createElement,\n    useContext,\n    useReducer,\n    useEffect\n} from \"react\";\nimport {assoc} from \"ramda\";\nimport t from \"tcomb\";\nimport {localStorageOrDefault} from \"./helpers\";\nimport defaultOptions from \"./demo-options.json\";\n\nconst ActionLoadState = t.interface({state: t.Any});\nconst ActionSetByeValue = t.interface({byeValue: t.Number});\nconst ActionTypes = t.union([ActionLoadState, ActionSetByeValue]);\nActionTypes.dispatch = function (x) {\n    const typeToConstructor = {\n        \"LOAD_STATE\": ActionLoadState,\n        \"SET_BYE_VALUE\": ActionSetByeValue\n    };\n    return typeToConstructor[x.type];\n};\n\nfunction reducer(state, action) {\n    ActionTypes(action);\n    switch (action.type) {\n    case \"SET_BYE_VALUE\":\n        return assoc(\"byeValue\", action.byeValue, state);\n    case \"LOAD_STATE\":\n        return action.state;\n    default:\n        throw new Error(\"Unexpected action type.\");\n    }\n}\n\nconst OptionsContext = createContext(null);\n\nexport function useOptions() {\n    return useContext(OptionsContext);\n}\n\nexport function OptionsProvider(props) {\n    const loadedData = localStorageOrDefault(\"options\", defaultOptions);\n    const [state, dispatch] = useReducer(reducer, loadedData);\n    useEffect(\n        function () {\n            localStorage.setItem(\"options\", JSON.stringify(state));\n        },\n        [state]\n    );\n    return (\n        createElement(\n            OptionsContext.Provider,\n            {value: [state, dispatch]},\n            props.children\n        )\n    );\n}\n","import React, {useEffect, useMemo} from \"react\";\nimport PropTypes from \"prop-types\";\nimport Tooltip from \"@reach/tooltip\";\nimport {Link} from \"@reach/router\";\nimport last from \"ramda/src/last\";\nimport Icons from \"../icons\";\nimport {useTournament, usePlayers} from \"../../state\";\nimport {calcNumOfRounds} from \"../../pairing-scoring\";\nimport {DUMMY_ID} from \"../../data-types\";\nimport styles from \"./tournament.module.css\";\n\nexport default function Tournament(props) {\n    const tourneyId = Number(props.tourneyId);\n    const [tourney, dispatch] = useTournament(tourneyId);\n    const {name, players, roundList} = tourney;\n    const {playerState, getPlayer, playerDispatch} = usePlayers();\n    // This isn't expensive, but why not memoize it?\n    const isNewRoundReady = useMemo(\n        function () {\n            const lastRound = last(roundList);\n            if (!lastRound) {\n                return true;\n            }\n            const matchedPlayers = lastRound.reduce(\n                /** @param {number[]} acc */\n                (acc, match) => acc.concat(match.players),\n                []\n            );\n            const unMatchedPlayers = players.filter(\n                (pId) => !matchedPlayers.includes(pId)\n            );\n            const results = lastRound.map(\n                (match) => match.result[0] + match.result[1]\n            );\n            return (unMatchedPlayers.length === 0 && !results.includes(0));\n        },\n        [players, roundList]\n    );\n    useEffect(\n        function () {\n            const origTitle = document.title;\n            document.title = name;\n            return function () {\n                document.title = origTitle;\n            };\n        },\n        [name]\n    );\n    const isItOver = roundList.length >= calcNumOfRounds(players.length);\n    const [tooltipText, tooltipWarn] = (function () {\n        if (!isNewRoundReady) {\n            return [\n                \"You must complete the last round before beginning a new one.\",\n                true\n            ];\n        } else if (isItOver) {\n            return [\"All necessary rounds have completed.\", true];\n        } else {\n            return [\"Ready to begin a new round.\", false];\n        }\n    }());\n\n    function newRound() {\n        const confirmText = (\n            \"All rounds have completed. Are you sure you want to begin a new \"\n            + \"one?\"\n        );\n        if (isItOver) {\n            if (!window.confirm(confirmText)) {\n                return;\n            }\n        }\n        dispatch({type: \"ADD_ROUND\", tourneyId});\n        return;\n    }\n\n    async function delLastRound() {\n        if (window.confirm(\"Are you sure you want to delete the last round?\")) {\n            await props.navigate(\".\");\n            // If a match has been scored, then reset it.\n            // Should this logic be somewhere else?\n            last(roundList).forEach(function (match) {\n                if (match.result[0] + match.result[1] === 0) {\n                    return; // Don't change players who haven't scored.\n                }\n                match.players.forEach(function (pId, color) {\n                    if (pId === DUMMY_ID) {\n                        return; // Don't try to set the dummy.\n                    }\n                    const {matchCount} = getPlayer(pId);\n                    playerDispatch({\n                        type: \"SET_PLAYER_MATCHCOUNT\",\n                        id: pId,\n                        matchCount: matchCount - 1\n                    });\n                    playerDispatch({\n                        type: \"SET_PLAYER_RATING\",\n                        id: pId,\n                        rating: match.origRating[color]\n                    });\n                });\n            });\n            dispatch({\n                type: \"DEL_LAST_ROUND\",\n                players: playerState.players,\n                tourneyId\n            });\n        }\n    }\n\n    return (\n        <div className={styles.tournament}>\n            <div className={styles.header}>\n                <nav>\n                    <Link to=\"/\">\n                        <Icons.ChevronLeft/> Back\n                    </Link>\n                </nav>\n                <h2>{name}</h2>\n            </div>\n            <div className={styles.sidebar}>\n                <nav>\n                    <ul>\n                        <li>\n                            <Link to=\".\">\n                                <Icons.Users /> Players\n                            </Link>\n                        </li>\n                        <li>\n                            <Link to=\"crosstable\">\n                                <Icons.Layers /> Crosstable\n                            </Link>\n                        </li>\n                        <li>\n                            <Link to=\"scores\">\n                                <Icons.List /> Score detail\n                            </Link>\n                        </li>\n                    </ul>\n                    <hr />\n                    <ul>\n                        {Object.keys(roundList).map((id) => (\n                            <li key={id}>\n                                <Link to={`${id}`}>\n                                    Round {Number(id) + 1}\n                                </Link>\n                            </li>\n                        ))}\n                    </ul>\n                </nav>\n                <hr />\n                <ul>\n                    <li>\n                        <button\n                            onClick={newRound}\n                            disabled={!isNewRoundReady}\n                        >\n                            <Icons.Plus/> New round\n                        </button>{\" \"}\n                        <Tooltip label={tooltipText}>\n                            <span className=\"helpIcon\">\n                                {(tooltipWarn)\n                                    ? <Icons.Alert className=\"status-alert\" />\n                                    : <Icons.Check className=\"status-ok\" />\n                                }\n                            </span>\n                        </Tooltip>\n                    </li>\n                    <li>\n                        <button\n                            className={\"danger \" + styles.toolbarItem}\n                            onClick={delLastRound}\n                            disabled={roundList.length === 0}\n                        >\n                            <Icons.Trash /> Remove last round\n                        </button>\n                    </li>\n                    <li>\n                        Round progress: {roundList.length}/\n                        {calcNumOfRounds(players.length)}{\" \"}\n                    </li>\n                </ul>\n            </div>\n            <div className={styles.content}>\n                {props.children}\n            </div>\n        </div>\n    );\n}\nTournament.propTypes = {\n    tourneyId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    children: PropTypes.node,\n    navigate: PropTypes.func,\n    path: PropTypes.string\n};\n","import React, {useState} from \"react\";\nimport Icons from \"../icons\";\nimport {Link} from \"@reach/router\";\nimport {useTournaments} from \"../../state\";\n\nexport default function TournamentList(props) {\n    const [tourneys, dispatch] = useTournaments();\n    const [newTourneyName, setNewTourneyName] = useState(\"\");\n\n    function updateNewName(event) {\n        setNewTourneyName(event.target.value);\n    }\n\n    function makeTournament(event) {\n        event.preventDefault();\n        dispatch({\n            type: \"ADD_TOURNEY\",\n            name: newTourneyName\n        });\n        setNewTourneyName(\"\");\n    }\n\n    return (\n        <div>\n            {(tourneys.length > 0) &&\n                <h2>Tournament list</h2>\n            }\n            {(tourneys.length > 0)\n                ?\n                <ol>\n                    {tourneys.map((tourney, i) =>\n                        <li key={i}>\n                            <Link to={String(i)}>\n                                {tourney.name}\n                            </Link>{\" \"}\n                            <button\n                                title={`Delete ${tourney.name}`}\n                                aria-label={`Delete ${tourney.name}`}\n                                className=\"danger iconButton\"\n                                onClick={\n                                    () => dispatch({\n                                        type: \"DEL_TOURNEY\",\n                                        index: i\n                                    })\n                                }\n                            >\n                                <Icons.Trash />\n                            </button>\n                        </li>\n                    )}\n                </ol>\n                : <p>No tournaments added yet.</p>\n            }\n            <form onSubmit={makeTournament}>\n                <fieldset>\n                    <legend>Make a new tournament</legend>\n                    <label>Name:{\" \"}\n                        <input\n                            type=\"text\"\n                            placeholder=\"tournament name\"\n                            value={newTourneyName}\n                            onChange={updateNewName}\n                            required={true}\n                        />\n                    </label>\n                    <input type=\"submit\" value=\"Create\" />\n                </fieldset>\n            </form>\n        </div>\n    );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Tournament from \"./tournament\";\nimport TournamentList from \"./list\";\n\nconst TournamentIndex = (props) => (\n    <div>\n        {props.children}\n    </div>\n);\nTournamentIndex.propTypes = {\n    children: PropTypes.node,\n    path: PropTypes.string\n};\n\nexport default TournamentIndex;\nexport {Tournament, TournamentList};\n","import React, {useMemo, useState, useEffect} from \"react\";\nimport PropTypes from \"prop-types\";\nimport numeral from \"numeral\";\nimport {Link} from \"@reach/router\";\nimport Icons from \"../icons\";\nimport {getPlayerAvoidList, kFactor} from \"../../pairing-scoring\";\nimport {usePlayers} from \"../../state\";\n\nexport default function PlayerInfoBox(props) {\n    const playerId = Number(props.playerId);\n    const {playerState, playerDispatch, getPlayer} = usePlayers();\n    const {players, avoid} = playerState;\n    const [singAvoidList, setSingAvoidList] = useState(\n        getPlayerAvoidList(playerId, avoid)\n    );\n    const unAvoided = useMemo(\n        () => (\n            players.map(\n                (player) => player.id\n            ).filter(\n                (pId) => !singAvoidList.includes(pId) && pId !== playerId\n            )\n        ),\n        [players, playerId, singAvoidList]\n    );\n    const [selectedAvoider, setSelectedAvoider] = useState(unAvoided[0]);\n    function avoidAdd(event) {\n        event.preventDefault();\n        playerDispatch({\n            type: \"ADD_AVOID_PAIR\",\n            pair: [playerId, Number(selectedAvoider)]\n        });\n    }\n    useEffect(\n        function () {\n            setSingAvoidList(getPlayerAvoidList(playerId, avoid));\n        },\n        [avoid, playerId]\n    );\n    useEffect(\n        function () {\n            setSelectedAvoider(unAvoided[0]);\n        },\n        [setSelectedAvoider, unAvoided]\n    );\n    useEffect(\n        function () {\n            const origTitle = document.title;\n            document.title = (\n                getPlayer(playerId).firstName\n                + \" \" + getPlayer(playerId).lastName\n            );\n            return function () {\n                document.title = origTitle;\n            };\n        },\n        [playerId, getPlayer]\n    );\n    function handleChange(event) {\n        event.preventDefault();\n        const {firstName, lastName, matchCount, rating} = event.currentTarget;\n        playerDispatch({\n            type: \"SET_PLAYER\",\n            id: playerId,\n            firstName: firstName.value,\n            lastName: lastName.value,\n            matchCount: Number(matchCount.value),\n            rating: Number(rating.value)\n        });\n    }\n    return (\n        <div>\n            <Link to=\"..\"><Icons.ChevronLeft /> Back</Link>\n            <h2>\n                Profile for{\" \"}\n                {getPlayer(playerId).firstName} {getPlayer(playerId).lastName}\n            </h2>\n            <form onChange={handleChange} onSubmit={handleChange}>\n                <p>\n                    <label>\n                    First name{\" \"}\n                        <input\n                            type=\"text\"\n                            name=\"firstName\"\n                            defaultValue={getPlayer(playerId).firstName}\n                        />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                    Last name{\" \"}\n                        <input\n                            type=\"text\"\n                            name=\"lastName\"\n                            defaultValue={getPlayer(playerId).lastName}\n                        />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                    Matches played{\" \"}\n                        <input\n                            type=\"number\"\n                            name=\"matchCount\"\n                            defaultValue={\n                                String(getPlayer(playerId).matchCount)\n                            }\n                        />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                    Rating\n                        <input\n                            type=\"number\"\n                            name=\"rating\"\n                            defaultValue={String(getPlayer(playerId).rating)}\n                        />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                    K factor\n                        <input\n                            type=\"number\"\n                            readOnly\n                            value={(\n                                numeral(\n                                    kFactor(getPlayer(playerId).matchCount)\n                                ).format(\"00\")\n                            )}\n                        />\n                    </label>\n                </p>\n            </form>\n            <ul>\n                <h3>Players to avoid</h3>\n                {singAvoidList.map((pId) => (\n                    <li key={pId}>\n                        {getPlayer(pId).firstName}{\" \"}\n                        {getPlayer(pId).lastName}{\" \"}\n                        <button\n                            className=\"danger iconButton\"\n                            onClick={() =>\n                                playerDispatch({\n                                    type: \"DEL_AVOID_PAIR\",\n                                    pair: [playerId, pId]\n                                })\n                            }\n                            title={`Remove ${getPlayer(pId).firstName} \n${getPlayer(pId).lastName}`}\n                            arial-label={`Remove \n${getPlayer(pId).firstName} ${getPlayer(pId).lastName} from avoid list.`}\n                        >\n                            <Icons.Trash />\n                        </button>\n                    </li>\n                ))}\n                {avoid.length === 0 && <li>None</li>}\n            </ul>\n            <form onSubmit={(event) => avoidAdd(event)}>\n                <fieldset>\n                    <legend>Add player to avoid</legend>\n                    <select\n                        onBlur={(event) =>\n                            setSelectedAvoider(Number(event.target.value))\n                        }\n                    >\n                        {unAvoided.map((pId) => (\n                            <option key={pId} value={pId}>\n                                {getPlayer(pId).firstName}{\" \"}\n                                {getPlayer(pId).lastName}\n                            </option>\n                        ))}\n                    </select>{\" \"}\n                    <input type=\"submit\" value=\"Add\" />\n                </fieldset>\n            </form>\n        </div>\n    );\n}\nPlayerInfoBox.propTypes = {\n    playerId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    path: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {Link} from \"@reach/router\";\nimport {usePlayers} from \"../state\";\nimport styles from \"./utility.module.css\";\nimport {DUMMY_ID} from \"../data-types\";\n\nexport const Button = ({children, action}) => (\n    <button onClick={action}>\n        {children}\n    </button>\n);\nButton.propTypes = {\n    children: PropTypes.node.isRequired,\n    action: PropTypes.func.isRequired\n};\n\nexport const BackButton = ({action}) => (\n    <Button action={action}>&lt; Back</Button>\n);\nBackButton.propTypes = {\n    action: PropTypes.func.isRequired\n};\n\nexport const OpenButton = ({action}) => (\n    <Button action={action}>Open &gt;</Button>\n);\nOpenButton.propTypes = {\n    action: PropTypes.func.isRequired\n};\n\nexport function Panel({children, style}) {\n    return (\n        <div style={{...style}} className={styles.panel}>\n            {children}\n        </div>\n    );\n}\nPanel.propTypes = {\n    children: PropTypes.node.isRequired,\n    style: PropTypes.object\n};\n\nexport function PanelContainer(props) {\n    return (\n        <div {...props} className={styles.panels}>\n            {React.Children.map(props.children, (child) => child)}\n        </div>\n    );\n}\nPanelContainer.propTypes = {\n    children: PropTypes.node.isRequired\n};\n\nexport function PlayerLink({id, firstName, lastName}) {\n    const {getPlayer} = usePlayers();\n    const player = getPlayer(id);\n    const name = (function () {\n        if (firstName && lastName) {\n            return player.firstName + \" \" + player.lastName;\n        } else if (firstName && !lastName) {\n            return player.firstName;\n        } else if (!firstName && lastName) {\n            return player.lastName;\n        } else {\n            return null;\n        }\n    }());\n    if (id === DUMMY_ID) { // there's no bye player profile\n        return name;\n    }\n    if (!name) {\n        return null;\n    }\n    return (\n        <Link to={\"/players/\" + id}>\n            {firstName && getPlayer(id).firstName}{\" \"}\n            {lastName && getPlayer(id).lastName}\n        </Link>\n    );\n}\nPlayerLink.propTypes = {\n    id: PropTypes.number.isRequired,\n    firstName: PropTypes.bool,\n    lastName: PropTypes.bool\n};\n\n/*******************************************************************************\n * Non-JSX functions\n ******************************************************************************/\nexport function findById(id, list) {\n    return list.filter((x) => x.id === id)[0];\n}\n\nexport function findIndexById(id, list) {\n    return list.indexOf(findById(id, list));\n}\n","import React, {useState} from \"react\";\nimport {usePlayers} from \"../../state\";\nimport {assoc} from \"ramda\";\n\nexport default function NewPlayer() {\n    const {playerDispatch} = usePlayers();\n    const newPlayerDefault = {firstName: \"\", lastName: \"\", rating: 1200};\n    const [newPlayerData, setNewPlayerdata] = useState(newPlayerDefault);\n\n    const handleSubmit = function (event) {\n        event.preventDefault();\n        const {firstName, lastName, rating} = newPlayerData;\n        setNewPlayerdata(newPlayerDefault);\n        playerDispatch({type: \"ADD_PLAYER\", firstName, lastName, rating});\n    };\n\n    const updateField = function (event) {\n        event.preventDefault();\n        const {name, value} = event.currentTarget;\n        setNewPlayerdata((prevState) => assoc(name, value, prevState));\n    };\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <fieldset>\n                <legend>Register a new player</legend>\n                <p>\n                    <label>\n                        First name{\" \"}\n                        <input type=\"text\" name=\"firstName\"\n                            onChange={updateField}\n                            value={newPlayerData.firstName} required\n                        />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                        Last name{\" \"}\n                        <input type=\"text\" name=\"lastName\"\n                            onChange={updateField}\n                            value={newPlayerData.lastName} required\n                        />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                        Rating {\" \"}\n                        <input\n                            type=\"number\"\n                            name=\"rating\"\n                            onChange={updateField}\n                            value={newPlayerData.rating}\n                            required\n                        />\n                    </label>\n                </p>\n                <p>\n                    <input type=\"submit\" value=\"Add\"/>\n                </p>\n            </fieldset>\n        </form>\n    );\n}\n","import React from \"react\";\nimport {Link} from \"@reach/router\";\nimport VisuallyHidden from \"@reach/visually-hidden\";\nimport Icons from \"../icons\";\nimport {usePlayers} from \"../../state\";\nimport {PlayerLink} from \"../utility\";\nimport NewPlayer from \"./new-player\";\n\nexport default function PlayerList(props) {\n    const {playerState, playerDispatch} = usePlayers();\n    const delPlayer = function (event, id) {\n        event.preventDefault();\n        playerDispatch({type: \"DEL_PLAYER\", id});\n    };\n    return (\n        <div>\n            <table>\n                <caption>Demo Roster</caption>\n                <thead>\n                    <tr>\n                        <th>First name</th>\n                        <th>Last name</th>\n                        <th>Rating</th>\n                        <th></th>\n                        <th></th>\n                    </tr>\n                </thead>\n                <tbody>{playerState.players.map((player) =>\n                    <tr key={player.id}>\n                        <td className=\"table__player\">\n                            <PlayerLink id={player.id} firstName />\n                        </td>\n                        <td className=\"table__player\">\n                            <PlayerLink id={player.id} lastName />\n                        </td>\n                        <td className=\"table__number\">{player.rating}</td>\n                        <td>\n                            <button\n                                className=\"danger iconButton\"\n                                onClick={(event) =>\n                                    delPlayer(event, player.id)\n                                }\n                                // eslint-disable-next-line max-len\n                                title={`Delete ${player.firstName} ${player.lastName}`}\n                                // eslint-disable-next-line max-len\n                                aria-label={`Delete ${player.firstName} ${player.lastName}`}\n                            >\n                                <Icons.Trash />\n                            </button>\n                        </td>\n                        <td>\n                            <Link to={String(player.id)}>\n                            Open\n                                <VisuallyHidden>\n                                    {\" \"}{player.firstName} {player.lastName}\n                                </VisuallyHidden>\n                                {\" \"}<Icons.ChevronRight />\n                            </Link>\n                        </td>\n                    </tr>\n                )}\n                </tbody>\n            </table>\n            <NewPlayer />\n        </div>\n    );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport PlayerInfo from \"./info-box\";\nimport PlayerList from \"./list\";\n\nexport default function Players(props) {\n    return (\n        <div>\n            {props.children}\n        </div>\n    );\n}\nPlayers.propTypes = {\n    children: PropTypes.node,\n    path: PropTypes.string\n};\n\nexport {PlayerInfo, PlayerList};\n","import React, {useState} from \"react\";\nimport numeral from \"numeral\";\nimport dashify from \"dashify\";\nimport {defaultTo} from \"ramda\";\nimport PropTypes from \"prop-types\";\nimport Icons from \"../icons\";\nimport {Tab, Tabs, TabList, TabPanel, TabPanels} from \"@reach/tabs\";\nimport {useTournament, usePlayers} from \"../../state\";\nimport {\n    createStandingTree,\n    tieBreakMethods\n} from \"../../pairing-scoring\";\nimport style from \"./scores.module.css\";\n\nfunction ScoreTable({tourneyId}) {\n    const [{tieBreaks, roundList}] = useTournament(tourneyId);\n    const {getPlayer} = usePlayers();\n    const [standingTree, tbMethods] = createStandingTree(tieBreaks, roundList);\n    return (\n        <table className={style.table}>\n            <caption>Score detail</caption>\n            <tbody>\n                <tr className={style.topHeader}>\n                    <th scope=\"col\">Rank</th>\n                    <th scope=\"col\">Name</th>\n                    <th scope=\"col\">Score</th>\n                    {tbMethods.map((name, i) => (\n                        <th key={i} scope=\"col\">\n                            {name}\n                        </th>\n                    ))}\n                </tr>\n                {standingTree.map((standingsFlat, rank) =>\n                    standingsFlat.map((standing, j, src) => (\n                        <tr key={standing.id} className={style.row}>\n                            {j === 0 && ( // Only display the rank once\n                                <th\n                                    scope=\"row\"\n                                    className={\"table__number \" + style.rank}\n                                    rowSpan={src.length}\n                                >\n                                    {numeral(rank + 1).format(\"0o\")}\n                                </th>\n                            )}\n                            <th\n                                scope=\"row\"\n                                className={style.playerName}\n                                data-testid={rank}\n                            >\n                                {getPlayer(standing.id).firstName}&nbsp;\n                                {getPlayer(standing.id).lastName}\n                            </th>\n                            <td\n                                className=\"table__number\"\n                                data-testid={dashify(\n                                    getPlayer(standing.id).firstName\n                                    + getPlayer(standing.id).lastName\n                                    + \" score\"\n                                )}\n                            >\n                                {numeral(standing.score).format(\"1/2\")}\n                            </td>\n                            {standing.tieBreaks.map((score, i) => (\n                                <td\n                                    key={i}\n                                    className=\"table__number\"\n                                    data-testid={dashify(\n                                        getPlayer(standing.id).firstName\n                                        + getPlayer(standing.id).lastName\n                                        + tbMethods[i]\n                                    )}\n                                >\n                                    {numeral(score).format(\"1/2\")}\n                                </td>\n                            ))}\n                        </tr>\n                    ))\n                )}\n            </tbody>\n        </table>\n    );\n}\nScoreTable.propTypes = {\n    tourneyId: PropTypes.number.isRequired\n};\n\nfunction SelectTieBreaks({tourneyId}) {\n    const [{tieBreaks}, dispatch] = useTournament(tourneyId);\n    const [selectedTb, setSelectedTb] = useState(null);\n\n    function toggleTb(id = null) {\n        const defaultId = defaultTo(selectedTb);\n        if (tieBreaks.includes(defaultId(id))) {\n            dispatch({type: \"DEL_TIEBREAK\", id: defaultId(id), tourneyId});\n            setSelectedTb(null);\n        } else {\n            dispatch({type: \"ADD_TIEBREAK\", id: defaultId(id), tourneyId});\n        }\n    }\n\n    function moveTb(direction) {\n        const index = tieBreaks.indexOf(selectedTb);\n        dispatch({\n            type: \"MOVE_TIEBREAK\",\n            oldIndex: index,\n            newIndex: index + direction,\n            tourneyId\n        });\n    }\n\n    return (\n        <div>\n            <h3>Selected tiebreak methods</h3>\n            <div className=\"toolbar\">\n                <button\n                    onClick={() => toggleTb()}\n                    disabled={selectedTb === null}\n                >\n                    Toggle\n                </button>\n                <button\n                    onClick={() => moveTb(-1)}\n                    disabled={selectedTb === null}\n                >\n                    <Icons.ArrowUp/> Move up\n                </button>\n                <button\n                    onClick={() => moveTb(1)}\n                    disabled={selectedTb === null}\n                >\n                    <Icons.ArrowDown/> Move down\n                </button>\n                <button\n                    onClick={() => setSelectedTb(null)}\n                    disabled={selectedTb === null}\n                >\n                    Done\n                </button>\n            </div>\n            <ol>\n                {tieBreaks.map((id) => (\n                    <li\n                        key={id}\n                        className={selectedTb === id ? \"selected\" : \"\"}\n                    >\n                        {tieBreakMethods[id].name}{\" \"}\n                        <button\n                            onClick={() =>\n                                selectedTb === id\n                                    ? setSelectedTb(null)\n                                    : setSelectedTb(id)\n                            }\n                            disabled={\n                                selectedTb !== null && selectedTb !== id\n                            }\n                        >\n                            {selectedTb === id ? \"Done\" : \"Edit\"}\n                        </button>\n                    </li>\n                ))}\n            </ol>\n            <h3>Available tiebreak methods</h3>\n            <ol>\n                {tieBreakMethods.map((method, id) => (\n                    <li key={id}>\n                        <span\n                            className={\n                                tieBreaks.includes(id)\n                                    ? \"enabled\"\n                                    : \"disabled\"\n                            }\n                        >\n                            {method.name}\n                        </span>\n                        {!tieBreaks.includes(id) && (\n                            <button onClick={() => toggleTb(id)}>\n                                Add\n                            </button>\n                        )}\n                    </li>\n                ))}\n            </ol>\n        </div>\n    );\n}\nSelectTieBreaks.propTypes = {\n    tourneyId: PropTypes.number.isRequired\n};\n\nconst Scores = ({tourneyId}) => (\n    <Tabs>\n        <TabList>\n            <Tab><Icons.List /> Scores</Tab>\n            <Tab><Icons.Settings /> Edit tiebreak rules</Tab>\n        </TabList>\n        <TabPanels>\n            <TabPanel>\n                <ScoreTable tourneyId={Number(tourneyId)}/>\n            </TabPanel>\n            <TabPanel>\n                <SelectTieBreaks tourneyId={Number(tourneyId)} />\n            </TabPanel>\n        </TabPanels>\n    </Tabs>\n);\nScores.propTypes = {\n    tourneyId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    path: PropTypes.string\n};\n\nexport default Scores;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport NewPlayer from \"../../players/new-player\";\nimport {useTournament, usePlayers} from \"../../../state\";\n\nexport default function Selecting({tourneyId}) {\n    const [{players}, dispatch] = useTournament(tourneyId);\n    const {playerState, getPlayer} = usePlayers();\n\n    function togglePlayer(event) {\n        const id = Number(event.target.value);\n        if (event.target.checked) {\n            dispatch({\n                type: \"SET_TOURNEY_PLAYERS\",\n                players: players.concat([id]),\n                tourneyId\n            });\n        } else {\n            dispatch({\n                type: \"SET_TOURNEY_PLAYERS\",\n                players: players.filter((pId) => pId !== id),\n                tourneyId\n            });\n        }\n    }\n\n    return (\n        <div>\n            <button\n                onClick={() =>\n                    dispatch({\n                        type: \"SET_TOURNEY_PLAYERS\",\n                        players: playerState.players.map(\n                            (p) => p.id\n                        ),\n                        tourneyId\n                    })\n                }\n            >\n                Select all\n            </button>\n            <button\n                onClick={() =>\n                    dispatch({\n                        type: \"SET_TOURNEY_PLAYERS\",\n                        players: [],\n                        tourneyId\n                    })\n                }\n            >\n                Select none\n            </button>\n            {/* <button onClick={() => setIsSelecting(false)}>\n                Done\n            </button> */}\n            <table>\n                <caption>Select players</caption>\n                <thead>\n                    <tr>\n                        <th>First name</th>\n                        <th>Last name</th>\n                        <th>Select</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {playerState.players.map(({id}) => (\n                        <tr key={id}>\n                            <td>{getPlayer(id).firstName}</td>\n                            <td>{getPlayer(id).lastName}</td>\n                            <td>\n                                <input\n                                    type=\"checkbox\"\n                                    value={id}\n                                    checked={players.includes(id)}\n                                    onChange={togglePlayer}\n                                />\n                            </td>\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n            <NewPlayer />\n        </div>\n    );\n}\nSelecting.propTypes = {\n    tourneyId: PropTypes.number\n};\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {Dialog} from \"@reach/dialog\";\nimport Icons from \"../../icons\";\nimport Selecting from \"./selecting\";\nimport {useTournament, usePlayers} from \"../../../state\";\nimport {PanelContainer, Panel} from \"../../utility\";\nimport {hasHadBye} from \"../../../pairing-scoring\";\n\nexport default function PlayerSelect(props) {\n    const tourneyId = Number(props.tourneyId);\n    const [{players, byeQueue, roundList}, dispatch] = useTournament(tourneyId);\n    const {getPlayer} = usePlayers();\n    const [isSelecting, setIsSelecting] = useState(players.length === 0);\n    return (\n        <PanelContainer>\n            <Panel>\n                <button onClick={() => setIsSelecting(true)}>\n                    <Icons.Edit /> Edit player roster\n                </button>\n                <table>\n                    <caption>Current roster</caption>\n                    <thead>\n                        <tr>\n                            <th>First name</th>\n                            <th>Last name</th>\n                            <th>Options</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {players.map((pId) => (\n                            <tr\n                                key={pId}\n                                className={getPlayer(pId).type + \" player\"}\n                            >\n                                <td>{getPlayer(pId).firstName}</td>\n                                <td>{getPlayer(pId).lastName}</td>\n                                <td>\n                                    <button\n                                        onClick={() =>\n                                            dispatch({\n                                                type: \"SET_BYE_QUEUE\",\n                                                byeQueue: byeQueue.concat(\n                                                    [pId]\n                                                ),\n                                                tourneyId\n                                            })\n                                        }\n                                        disabled={byeQueue.includes(\n                                            pId\n                                        )}\n                                    >\n                                        Bye signup\n                                    </button>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </Panel>\n            <Panel>\n                <h3>Bye queue</h3>\n                {(byeQueue.length === 0) &&\n                    <p>No players have signed up for a bye round.</p>\n                }\n                <ol>\n                    {byeQueue.map((pId) => (\n                        <li\n                            key={pId}\n                            className={\n                                hasHadBye(pId, roundList)\n                                    ? \"disabled\"\n                                    : \"\"\n                            }\n                        >\n                            {getPlayer(pId).firstName}{\" \"}\n                            {getPlayer(pId).lastName}\n                            <button\n                                onClick={() =>\n                                    dispatch({\n                                        type: \"SET_BYE_QUEUE\",\n                                        byeQueue: byeQueue.filter(\n                                            (id) => pId !== id\n                                        ),\n                                        tourneyId\n                                    })\n                                }\n                            >\n                                Remove\n                            </button>\n                        </li>\n                    ))}\n                </ol>\n            </Panel>\n            <Dialog isOpen={isSelecting}>\n                <button onClick={() => setIsSelecting(false)}>Done</button>\n                <Selecting tourneyId={tourneyId} />\n            </Dialog>\n        </PanelContainer>\n    );\n}\nPlayerSelect.propTypes = {\n    path: PropTypes.string,\n    tourneyId: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n};\n","// TODO: This component is in need of a major cleanup. I made this way too\n// complex and fragile.\nimport React, {useMemo} from \"react\";\nimport PropTypes from \"prop-types\";\nimport numeral from \"numeral\";\nimport {assoc} from \"ramda\";\nimport Icons from \"../icons\";\nimport {useTournament, usePlayers} from \"../../state\";\nimport {\n    createStandingList,\n    getResultsByOpponent,\n    getPerformanceRatings,\n    rounds2Matches\n} from \"../../pairing-scoring\";\nimport style from \"./scores.module.css\";\n\nexport default function Crosstable({tourneyId}) {\n    const [{tieBreaks, roundList}] = useTournament(Number(tourneyId));\n    const {getPlayer} = usePlayers();\n    const [standings, opponentScores] = useMemo(\n        function () {\n            const [standingsFlat] = createStandingList(tieBreaks, roundList);\n            const matches = rounds2Matches(roundList);\n            const opponentResults = standingsFlat.reduce(\n                (acc, standing) => (\n                    assoc(\n                        String(standing.id),\n                        getResultsByOpponent(standing.id, matches),\n                        acc\n                    )\n                ),\n                {}\n            );\n            return [standingsFlat, opponentResults];\n        },\n        [roundList, tieBreaks]\n    );\n\n    function getXScore(player1Id, player2Id) {\n        if (player1Id === player2Id) {\n            return <Icons.X/>;\n        }\n        const result = opponentScores[String(player1Id)][player2Id];\n        if (result === undefined) {\n            return null;\n        }\n        return numeral(result).format(\"1/2\");\n    }\n\n    function getRatingChange(playerId) {\n        const matches = rounds2Matches(roundList);\n        const [\n            firstRating,\n            lastRating\n        ] = getPerformanceRatings(playerId, matches);\n        const change = numeral(lastRating - firstRating).format(\"+0\");\n        return `${lastRating}\\xA0(${change})`; // \\xA0 = &nsbp;\n    }\n    return (\n        <table className={style.table}>\n            <caption>Crosstable</caption>\n            <tbody>\n                <tr>\n                    <th>Rank</th>\n                    <th>Name</th>\n                    {standings.map((ignore, index) =>\n                        <th key={index}>\n                            {index + 1}\n                        </th>\n                    )}\n                    <th>Score</th>\n                    <th>Rating</th>\n                </tr>\n                {standings.map((standing, index)=>\n                    <tr key={index} className={style.row}>\n                        <th scope=\"col\">\n                            {index + 1}\n                        </th>\n                        <th\n                            scope=\"row\"\n                            className={style.playerName}\n                        >\n                            {getPlayer(standing.id).firstName}&nbsp;\n                            {getPlayer(standing.id).lastName}\n                        </th>\n                        {standings.map((opponent, index2) =>\n                            <td\n                                key={index2}\n                                className=\"table__number\"\n                            >\n                                {getXScore(standing.id, opponent.id)}\n                            </td>\n                        )}\n                        <td\n                            className=\"table__number\"\n                        >\n                            {numeral(standing.score).format(\"1/2\")}\n                        </td>\n                        <td className=\"table__number\">\n                            {getRatingChange(standing.id)}\n                        </td>\n                    </tr>\n                )}\n            </tbody>\n        </table>\n    );\n}\nCrosstable.propTypes = {\n    tourneyId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    path: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport numeral from \"numeral\";\nimport {createPlayerStats} from \"../../../pairing-scoring\";\nimport {useRound, usePlayers} from \"../../../state\";\nimport {findById} from \"../../utility\";\n\nexport default function PlayerMatchInfo({matchId, color, tourneyId, roundId}) {\n    const {tourney, matchList} = useRound(tourneyId, roundId);\n    const {playerState, getPlayer} = usePlayers();\n    const match = findById(matchId, matchList);\n    const playerData = createPlayerStats({\n        id: match.players[color],\n        playerDataSource: playerState.players,\n        avoidList: playerState.avoid,\n        roundList: tourney.roundList,\n        roundId\n    });\n    const colorBalance = playerData.colorBalance;\n    const prettyBalance = (function () {\n        if (colorBalance < 0) {\n            return \"White +\" + Math.abs(colorBalance);\n        } else if (colorBalance > 0) {\n            return \"Black +\" + colorBalance;\n        } else {\n            return \"Even\";\n        }\n    }());\n    return (\n        <dl className=\"player-card\">\n            <h3>\n                {playerData.profile.firstName} {playerData.profile.lastName}\n            </h3>\n            <dt>Score</dt>\n            <dd>{playerData.score}</dd>\n            <dt>Rating</dt>\n            <dd data-testid={`rating-${playerData.id}`}>\n                {match.origRating[color]} (\n                {numeral(\n                    match.newRating[color] - match.origRating[color]\n                ).format(\"+0\")}\n                )\n            </dd>\n            <dt>Color balance</dt>\n            <dd>{prettyBalance}</dd>\n            <dt>Has had a bye round</dt>\n            <dd>{playerData.hasHadBye ? \"Yes\" : \"No\"}</dd>\n            <dt>Opponent history</dt>\n            <dd>\n                <ol>\n                    {playerData.opponentHistory.map((opId) => (\n                        <li key={opId}>\n                            {getPlayer(opId).firstName}{\" \"}\n                            {getPlayer(opId).lastName}\n                        </li>\n                    ))}\n                </ol>\n            </dd>\n        </dl>\n    );\n}\nPlayerMatchInfo.propTypes = {\n    matchId: PropTypes.string,\n    color: PropTypes.number,\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number\n};\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {Dialog} from \"@reach/dialog\";\nimport Hidden from \"@reach/visually-hidden\";\nimport Icons from \"../../icons\";\nimport {PanelContainer, Panel} from \"../../utility\";\nimport {calcNewRatings} from \"../../../pairing-scoring\";\nimport {BLACK, WHITE, DUMMY_ID} from \"../../../data-types\";\nimport {useRound, usePlayers} from \"../../../state\";\nimport PlayerMatchInfo from \"./player-match-info\";\nimport {winnerSelect} from \"./round.module.css\";\nimport \"@reach/dialog/styles.css\";\n\nexport default function MatchRow({\n    pos,\n    match,\n    tourneyId,\n    roundId,\n    selectedMatch,\n    setSelectedMatch\n}) {\n    const {tourney, dispatch} = useRound(tourneyId, roundId);\n    const {playerDispatch, getPlayer} = usePlayers();\n    const [openModal, setOpenModal] = useState(false);\n    const resultCode = (function () {\n        if (match.result[0] > match.result[1]) {\n            return \"WHITE\";\n        } else if (match.result[1] > match.result[0]) {\n            return \"BLACK\";\n        } else if (match.result.every((x) => x === 0.5)) {\n            return \"DRAW\";\n        } else {\n            return \"NOTSET\";\n        }\n    }());\n    const whiteName = (\n        getPlayer(match.players[0]).firstName\n        + \" \"\n        + getPlayer(match.players[0]).lastName\n    );\n    const blackName = (\n        getPlayer(match.players[1]).firstName\n        + \" \"\n        + getPlayer(match.players[1]).lastName\n    );\n\n    function setMatchResult(event) {\n        const result = (function () {\n            switch (event.target.value) {\n            case \"WHITE\":\n                return [1, 0];\n            case \"BLACK\":\n                return [0, 1];\n            case \"DRAW\":\n                return [0.5, 0.5];\n            case \"NOTSET\":\n                return [0, 0];\n            default:\n                throw new Error();\n            }\n        }());\n        const white = getPlayer(match.players[WHITE]);\n        const black = getPlayer(match.players[BLACK]);\n        const newRating = (\n            (event.currentTarget.value === \"NOTSET\")\n            ? match.origRating\n            : calcNewRatings(\n                match.origRating,\n                [white.matchCount, black.matchCount],\n                result\n            )\n        );\n        playerDispatch({\n            type: \"SET_PLAYER_RATING\",\n            id: white.id,\n            rating: newRating[WHITE]\n        });\n        playerDispatch({\n            type: \"SET_PLAYER_RATING\",\n            id: black.id,\n            rating: newRating[BLACK]\n        });\n        // if the result hasn't been scored yet, increment the matchCount\n        if (match.result.reduce((a, b) => a + b) === 0) {\n            playerDispatch({\n                type: \"SET_PLAYER_MATCHCOUNT\",\n                id: white.id,\n                matchCount: white.matchCount + 1\n            });\n            playerDispatch({\n                type: \"SET_PLAYER_MATCHCOUNT\",\n                id: black.id,\n                matchCount: black.matchCount + 1\n            });\n        }\n        dispatch({\n            type: \"SET_MATCH_RESULT\",\n            tourneyId,\n            roundId,\n            matchId: match.id,\n            result,\n            newRating\n        });\n    }\n\n    return (\n        <tr className={match.id === selectedMatch ? \"selected\" : \"\"}>\n            <th className=\"table__number row__id\" scope=\"row\">{pos + 1}</th>\n            <td\n                className=\"table__player row__player\"\n                data-testid={`match-${pos}-white`}\n            >\n                {whiteName}{\" \"}\n                {resultCode === \"WHITE\" && (\n                    <span role=\"img\" aria-hidden>\n                        \n                    </span>\n                )}\n            </td>\n            <td\n                className=\"table__player row__player\"\n                data-testid={`match-${pos}-black`}\n            >\n                {blackName}{\" \"}\n                {resultCode === \"BLACK\" && (\n                    <span role=\"img\" aria-hidden>\n                        \n                    </span>\n                )}\n            </td>\n            <td className=\"data__input row__controls\">\n                <select\n                    onBlur={setMatchResult}\n                    onChange={setMatchResult}\n                    disabled={match.players.includes(DUMMY_ID)}\n                    value={resultCode}\n                    className={winnerSelect}\n                >\n                    <option value=\"NOTSET\">\n                        Select a winner\n                    </option>\n                    <option value=\"WHITE\">\n                        {whiteName} won\n                    </option>\n                    <option value=\"BLACK\">\n                        {blackName} won\n                    </option>\n                    <option value=\"DRAW\">\n                        Draw\n                    </option>\n                </select>\n            </td>\n            <td className=\"data__input row__controls\">\n                {(selectedMatch !== match.id)\n                ? (\n                    <button\n                        className=\"iconButton\"\n                        onClick={() => setSelectedMatch(match.id)}\n                        title=\"Edit match\"\n                    >\n                        <Icons.Edit />\n                    </button>\n                ) : (\n                    <button\n                        className=\"iconButton\"\n                        onClick={() => setSelectedMatch(null)}\n                        title=\"End editing match\"\n                    >\n                        <Icons.Check />\n                    </button>\n                )}\n                <button\n                    className=\"iconButton\"\n                    onClick={() => setOpenModal(true)}\n                    title=\"Open match information.\"\n                >\n                    <Icons.Info />\n                    <Hidden>\n                        View information for match:{\" \"}\n                        {whiteName} versus {blackName}\n                    </Hidden>\n                </button>\n                <Dialog isOpen={openModal}>\n                    <button onClick={() => setOpenModal(false)}>\n                        close\n                    </button>\n                    <p>{tourney.name}</p>\n                    <p>Round {roundId + 1}, match {pos + 1}</p>\n                    <PanelContainer>\n                        <Panel>\n                            <PlayerMatchInfo\n                                matchId={match.id}\n                                color={0}\n                                tourneyId={tourneyId}\n                                roundId={roundId}\n                            />\n                        </Panel>\n                        <Panel>\n                            <PlayerMatchInfo\n                                matchId={match.id}\n                                color={1}\n                                tourneyId={tourneyId}\n                                roundId={roundId}\n                            />\n                        </Panel>\n                    </PanelContainer>\n                </Dialog>\n            </td>\n        </tr>\n    );\n}\nMatchRow.propTypes = {\n    pos: PropTypes.number,\n    match: PropTypes.object,\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number,\n    selectedMatch: PropTypes.string,\n    setSelectedMatch: PropTypes.func\n};\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport Icons from \"../../icons\";\nimport MatchRow from \"./match-row\";\nimport {findById, findIndexById} from \"../../utility\";\nimport {useRound, usePlayers} from \"../../../state\";\nimport style from \"./round.module.css\";\n\nexport default function Round({roundId, tourneyId}) {\n    const {matchList, dispatch} = useRound(tourneyId, roundId);\n    const {playerDispatch, getPlayer} = usePlayers();\n    const [selectedMatch, setSelectedMatch] = useState(null);\n    if (!matchList) {\n        throw new Error(\"Round \" + roundId + \" does not exist.\");\n    }\n    function unMatch(matchId) {\n        const match = findById(matchId, matchList);\n        if (match.result.reduce((a, b) => a + b) !== 0) {\n            // checks if the match has been scored yet & resets the players'\n            // records\n            match.players.forEach(function (pId, color) {\n                playerDispatch({\n                    type: \"SET_PLAYER_MATCHCOUNT\",\n                    id: pId,\n                    matchCount: getPlayer(pId).matchCount - 1\n                });\n                playerDispatch({\n                    type: \"SET_PLAYER_RATING\",\n                    id: pId,\n                    rating: match.origRating[color]\n                });\n            });\n        }\n        dispatch({type: \"DEL_MATCH\", tourneyId, roundId, matchId});\n        setSelectedMatch(null);\n    }\n\n    function swapColors(matchId) {\n        dispatch({type: \"SWAP_COLORS\", tourneyId, roundId, matchId});\n    }\n\n    function moveMatch(matchId, direction) {\n        const oldIndex = findIndexById(matchId, matchList);\n        const newIndex = (\n            (oldIndex + direction >= 0)\n            ? oldIndex + direction\n            : 0\n        );\n        dispatch({type: \"MOVE_MATCH\", tourneyId, roundId, oldIndex, newIndex});\n    }\n\n    return (\n        <div>\n            <div className={style.toolbar}>\n                <button\n                    className=\"danger iconButton\"\n                    onClick={() => unMatch(selectedMatch)}\n                    disabled={selectedMatch === null}\n                >\n                    <Icons.Trash /> Unmatch\n                </button>\n                <button\n                    className=\"iconButton\"\n                    onClick={() => swapColors(selectedMatch)}\n                    disabled={selectedMatch === null}\n                >\n                    <Icons.Repeat /> Swap colors\n                </button>\n                <button\n                    className=\"iconButton\"\n                    onClick={() => moveMatch(selectedMatch, -1)}\n                    disabled={selectedMatch === null}\n                >\n                    <Icons.ArrowUp /> Move up\n                </button>\n                <button\n                    className=\"iconButton\"\n                    onClick={() => moveMatch(selectedMatch, 1)}\n                    disabled={selectedMatch === null}\n                >\n                    <Icons.ArrowDown /> Move down\n                </button>\n            </div>\n            {(matchList.length === 0) &&\n                <p>No players matched yet.</p>\n            }\n            <table className={style.table}>\n                {(matchList.length > 0) &&\n                    <caption>Round {roundId + 1} results</caption>\n                }\n                <tbody>\n                    {(matchList.length > 0) &&\n                        <tr>\n                            <th className=\"row__id\" scope=\"col\">\n                                #\n                            </th>\n                            <th className=\"row__player\" scope=\"col\">\n                                White\n                            </th>\n                            <th className=\"row__player\" scope=\"col\">\n                                Black\n                            </th>\n                            <th className=\"row__result\" scope=\"col\">\n                                Result\n                            </th>\n                            <th className=\"row__controls\" scope=\"col\">\n                                Controls\n                            </th>\n                        </tr>\n                    }\n                    {matchList.map((match, pos) => (\n                        <MatchRow\n                            key={match.id}\n                            pos={pos}\n                            match={match}\n                            tourneyId={tourneyId}\n                            roundId={roundId}\n                            selectedMatch={selectedMatch}\n                            setSelectedMatch={setSelectedMatch}\n                        />\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\nRound.propTypes = {\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number\n};\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {set, lensIndex, append} from \"ramda\";\nimport {Dialog} from \"@reach/dialog\";\nimport Hidden from \"@reach/visually-hidden\";\nimport Icons from \"../../icons\";\nimport Selecting from \"../player-select/selecting\";\nimport {useRound, usePlayers, useOptions} from \"../../../state\";\nimport {WHITE, BLACK, DUMMY_ID} from \"../../../data-types\";\n\nexport default function SelectList({\n    tourneyId,\n    roundId,\n    stagedPlayers,\n    setStagedPlayers\n}) {\n    const {dispatch, unmatched} = useRound(tourneyId, roundId);\n    const {playerState, getPlayer} = usePlayers();\n    const [{byeValue}] = useOptions();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n\n    function selectPlayer(id) {\n        if (stagedPlayers[WHITE] === null) {\n            setStagedPlayers(\n                (prevState) => set(lensIndex(WHITE), id, prevState)\n            );\n        } else if (stagedPlayers[BLACK] === null) {\n            setStagedPlayers(\n                (prevState) => set(lensIndex(BLACK), id, prevState)\n            );\n        }\n        // else... nothing happens\n    }\n\n    // make a new list so as not to affect auto-pairing\n    const unmatchedWithDummy = (\n        (unmatched.length % 2 !== 0)\n        ? append(DUMMY_ID, unmatched)\n        : unmatched\n    );\n    if (unmatched.length === 0) {\n        return null;\n    }\n    return (\n        <div>\n            <button\n                onClick={() => dispatch({\n                    type: \"AUTO_PAIR\",\n                    unpairedPlayers: unmatched,\n                    tourneyId,\n                    roundId,\n                    playerState,\n                    byeValue\n                })}\n                disabled={unmatched.length === 0}\n            >\n                Auto-pair unmatched players\n            </button><br/>\n            <button onClick={() => setIsModalOpen(true)}>\n                Add or remove players from the roster.\n            </button>\n            <ul>\n                {unmatchedWithDummy.map((pId) => (\n                    <li key={pId}>\n                        {stagedPlayers.includes(pId)\n                        ? <button disabled>Selected</button>\n                        : (\n                            <button\n                                disabled={!stagedPlayers.includes(null)}\n                                onClick={() => selectPlayer(pId)}\n                            >\n                                <Icons.UserPlus/>\n                                <Hidden>\n                                    Select {getPlayer(pId).firstName}{\" \"}\n                                    {getPlayer(pId).lastName}\n                                </Hidden>\n                            </button>\n                        )}{\" \"}\n                        {getPlayer(pId).firstName} {getPlayer(pId).lastName}\n                    </li>\n                ))}\n            </ul>\n            <Dialog isOpen={isModalOpen}>\n                <button onClick={() => setIsModalOpen(false)}>Done</button>\n                <Selecting tourneyId={tourneyId} />\n            </Dialog>\n        </div>\n    );\n}\nSelectList.propTypes = {\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number,\n    stagedPlayers: PropTypes.arrayOf(PropTypes.number),\n    setStagedPlayers: PropTypes.func\n};\n","import React, {Fragment} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {set, lensIndex} from \"ramda\";\nimport Icons from \"../../icons\";\nimport {useTournament, usePlayers, useOptions} from \"../../../state\";\nimport {WHITE, BLACK} from \"../../../data-types\";\n\nexport default function Stage({\n    tourneyId,\n    roundId,\n    stagedPlayers,\n    setStagedPlayers\n}) {\n    const {playerState, getPlayer} = usePlayers();\n    const {players} = playerState;\n    const dispatch = useTournament(tourneyId)[1];\n    const [{byeValue}] = useOptions();\n    const [white, black] = stagedPlayers;\n\n    function unstage(color) {\n        setStagedPlayers((prevState) => set(lensIndex(color), null, prevState));\n    }\n\n    function match() {\n        dispatch({\n            type: \"MANUAL_PAIR\",\n            pair: [white, black],\n            tourneyId,\n            roundId,\n            byeValue,\n            players\n        });\n        setStagedPlayers([null, null]);\n    }\n\n    return (\n        <div>\n            <h2>Selected for matching:</h2>\n            <p>\n                White:{\" \"}\n                {white !== null &&\n                    <Fragment>\n                        {getPlayer(white).firstName}{\" \"}\n                        {getPlayer(white).lastName}{\" \"}\n                        <button onClick={() => unstage(WHITE)}>\n                            <Icons.UserMinus /> Remove\n                        </button>\n                    </Fragment>\n                }\n            </p>\n            <p>\n                Black:{\" \"}\n                {black !== null &&\n                    <Fragment>\n                        {getPlayer(black).firstName}{\" \"}\n                        {getPlayer(black).lastName}{\" \"}\n                        <button onClick={() => unstage(BLACK)}>\n                            <Icons.UserMinus /> Remove\n                        </button>\n                    </Fragment>\n                }\n            </p>\n            <button\n                onClick={() => setStagedPlayers(\n                    (prevState) => ([prevState[BLACK], prevState[WHITE]])\n                )}\n                disabled={\n                    stagedPlayers.every((id) => id === null)\n                }\n            >\n                <Icons.Repeat/> Swap colors\n            </button>{\" \"}\n            <button\n                onClick={match}\n                disabled={stagedPlayers.includes(null)}\n            >\n                <Icons.Check/> Match selected\n            </button>{\" \"}\n        </div>\n    );\n}\nStage.propTypes = {\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number,\n    stagedPlayers: PropTypes.arrayOf(PropTypes.number),\n    setStagedPlayers: PropTypes.func\n};\n","// this component should eventually replace player-match-info.jsx\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {createPlayerStats} from \"../../../pairing-scoring\";\nimport {useTournament, usePlayers} from \"../../../state\";\n\nexport default function PlayerInfo({playerId, tourneyId, roundId}) {\n    const [{roundList}] = useTournament(tourneyId);\n    const {playerState, getPlayer} = usePlayers();\n    const {players, avoid} = playerState;\n    const {\n        profile,\n        rating,\n        score,\n        colorBalance,\n        hasHadBye,\n        opponentHistory,\n        avoidList\n    } = createPlayerStats({\n        id: playerId,\n        playerDataSource: players,\n        avoidList: avoid,\n        roundList,\n        roundId\n    });\n    const prettyBalance = (function () {\n        if (colorBalance < 0) {\n            return \"White +\" + Math.abs(colorBalance);\n        } else if (colorBalance > 0) {\n            return \"Black +\" + colorBalance;\n        } else {\n            return \"Even\";\n        }\n    }());\n    return (\n        <dl className=\"player-card\">\n            <h3>\n                {profile.firstName} {profile.lastName}\n            </h3>\n            <p>Score: {score}</p>\n            <p>Rating: {rating}</p>\n            <p>Color balance: {prettyBalance}</p>\n            <p>Has had a bye round: {hasHadBye ? \"Yes\" : \"No\"}</p>\n            <p>Opponent history:</p>\n            <ol>\n                {opponentHistory.map((opId) => (\n                    <li key={opId}>\n                        {getPlayer(opId).firstName}{\" \"}\n                        {getPlayer(opId).lastName}\n                    </li>\n                ))}\n            </ol>\n            <p>\n                Players to avoid:\n            </p>\n            <ol>\n                {avoidList.map((pId) => (\n                    <li key={pId}>\n                        {getPlayer(pId).firstName} {getPlayer(pId).lastName}\n                    </li>\n                ))}\n            </ol>\n        </dl>\n    );\n}\nPlayerInfo.propTypes = {\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number,\n    playerId: PropTypes.number\n};\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport numeral from \"numeral\";\nimport {pipe, map} from \"ramda\";\nimport SelectList  from \"./select-list\";\nimport Stage from \"./stage\";\nimport PlayerInfo from \"./player-info\";\nimport {PanelContainer, Panel} from \"../../utility\";\nimport {usePlayers, useTournament} from \"../../../state\";\nimport {findById} from \"../../utility\";\nimport {\n    calcPairIdeal,\n    maxPriority,\n    sortPlayersForPairing,\n    setUpperHalves,\n    createPlayerStats\n} from \"../../../pairing-scoring\";\n\nexport default function PairPicker({tourneyId, roundId}) {\n    const [stagedPlayers, setStagedPlayers] = useState([null, null]);\n    const {playerState} = usePlayers();\n    const [tourney] = useTournament(tourneyId);\n    const statsList = React.useMemo(\n        () => (\n            pipe(\n                map((id) => (\n                    createPlayerStats({\n                        id,\n                        playerDataSource: playerState.players,\n                        avoidList: playerState.avoid,\n                        roundList: tourney.roundList,\n                        roundId\n                    })\n                )),\n                sortPlayersForPairing,\n                setUpperHalves\n            )(tourney.players)\n        ),\n        [\n            tourney.players,\n            tourney.roundList,\n            playerState.avoid,\n            playerState.players,\n            roundId\n        ]\n    );\n    const matchIdeal = React.useMemo(\n        function () {\n            if (stagedPlayers.includes(null)) {\n                return null;\n            }\n            const player0stats = findById(stagedPlayers[0], statsList);\n            const player1stats = findById(stagedPlayers[1], statsList);\n            const ideal = calcPairIdeal(player0stats, player1stats);\n            return numeral(ideal / maxPriority).format(\"%\");\n        },\n        [stagedPlayers, statsList]\n    );\n    return (\n        <PanelContainer>\n            <Panel>\n                <SelectList\n                    tourneyId={tourneyId}\n                    roundId={roundId}\n                    stagedPlayers={stagedPlayers}\n                    setStagedPlayers={setStagedPlayers}\n                />\n            </Panel>\n            <Panel>\n                <Stage\n                    tourneyId={tourneyId}\n                    roundId={roundId}\n                    stagedPlayers={stagedPlayers}\n                    setStagedPlayers={setStagedPlayers}\n                />\n                <PanelContainer>\n                    {stagedPlayers.map((id) =>\n                        id !== null && (\n                            <Panel key={id}>\n                                <PlayerInfo\n                                    playerId={id}\n                                    tourneyId={tourneyId}\n                                    roundId={roundId}\n                                />\n                            </Panel>\n                        )\n                    )}\n                </PanelContainer>\n                Match ideal: {matchIdeal}\n            </Panel>\n        </PanelContainer>\n    );\n}\nPairPicker.propTypes = {\n    tourneyId: PropTypes.number,\n    roundId: PropTypes.number\n};\n","import React, {useState, useEffect} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {Tab, Tabs, TabList, TabPanel, TabPanels} from \"@reach/tabs\";\nimport Icons from \"../../icons\";\nimport Round from \"./round\";\nimport PairPicker from \"../pair-picker\";\nimport {useRound} from \"../../../state\";\n\nexport default function Index(props) {\n    // reach router passes strings instead\n    const tourneyId = Number(props.tourneyId);\n    const roundId = Number(props.roundId);\n    const {unmatched} = useRound(tourneyId, roundId);\n    const [openTab, setOpenTab] = useState(0);\n    useEffect(\n        function () {\n            if (unmatched.length > 0) {\n                setOpenTab(1);\n            } else {\n                setOpenTab(0);\n            }\n        },\n        [unmatched.length]\n    );\n    return (\n        <Tabs index={openTab} onChange={(index) => setOpenTab(index)}>\n            <TabList>\n                <Tab><Icons.List/> Matches</Tab>\n                <Tab disabled={unmatched.length === 0}>\n                    <Icons.Users/> Unmatched players\n                </Tab>\n            </TabList>\n            <TabPanels>\n                <TabPanel>\n                    <Round\n                        tourneyId={tourneyId}\n                        roundId={roundId}\n                    />\n                </TabPanel>\n                <TabPanel>\n                    <PairPicker\n                        tourneyId={tourneyId}\n                        roundId={roundId}\n                    />\n                </TabPanel>\n            </TabPanels>\n        </Tabs>\n    );\n}\nIndex.propTypes = {\n    tourneyId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    roundId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    path: PropTypes.string\n};\n","import React, {useState, useEffect, useMemo} from \"react\";\nimport {useTournaments, useOptions, usePlayers} from \"../state\";\nimport {createPlayer} from \"../data-types\";\nimport defaultPlayers from \"../state/demo-players.json\";\nimport defaultOptions from \"../state/demo-options.json\";\nimport defaultTourneys from \"../state/demo-tourney.json\";\n\nexport function Options(props) {\n    const [tourneys, tourneysDispatch] = useTournaments();\n    const [options, optionsDispatch] = useOptions();\n    const {playerState, playerDispatch} = usePlayers();\n    const [text, setText] = useState(\"\");\n    // memoize this so the `useEffect` hook syncs with the correct state\n    const exportData = useMemo(\n        () => ({options, tourneys, playerState}),\n        [options, tourneys, playerState]\n    );\n    useEffect(\n        function () {\n            setText(JSON.stringify(exportData, null, 4));\n        },\n        [exportData]\n    );\n    function loadData(data) {\n        tourneysDispatch({type: \"LOAD_STATE\", state: data.tourneys});\n        optionsDispatch({type: \"LOAD_STATE\", state: data.options});\n        playerDispatch({type: \"LOAD_STATE\", state: data.playerState});\n        window.alert(\"Data loaded!\");\n    }\n    function handleText(event) {\n        event.preventDefault();\n        const importData = JSON.parse(text);\n        loadData(importData);\n    }\n    function handleFile(event) {\n        event.preventDefault();\n        const reader = new FileReader();\n        // eslint-disable-next-line fp/no-mutation\n        reader.onload = function (ev) {\n            const data = ev.target.result;\n            const importData = JSON.parse(data);\n            loadData(importData);\n        };\n        reader.readAsText(event.currentTarget.files[0]);\n        event.currentTarget.value = \"\"; // so the filename won't linger onscreen\n    }\n    function reloadDemoData(event) {\n        event.preventDefault();\n        loadData({\n            options: defaultOptions,\n            playerState: {\n                players: defaultPlayers.playerList.map((p) => createPlayer(p)),\n                avoid: defaultPlayers.avoidList\n            },\n            tourneys: defaultTourneys\n        });\n    }\n    return (\n        <div>\n            <form>\n                <fieldset>\n                    <legend>Bye options</legend>\n                    Select how many points a bye is worth:{\" \"}\n                    <label>\n                        1\n                        <input\n                            type=\"radio\"\n                            checked={options.byeValue === 1}\n                            onChange={() => optionsDispatch({\n                                type: \"SET_BYE_VALUE\",\n                                byeValue: 1\n                            })}\n                        />\n                    </label>{\" \"}\n                    <label>\n                        \n                        <input\n                            type=\"radio\"\n                            checked={options.byeValue === 0.5}\n                            onChange={() => optionsDispatch({\n                                type: \"SET_BYE_VALUE\",\n                                byeValue: 0.5\n                            })}\n                        />\n                    </label>\n                </fieldset>\n            </form>\n            <fieldset>\n                <legend>Manage data</legend>\n                <p>\n                    <a\n                        href={\n                            \"data:application/json,\"\n                            + encodeURIComponent(JSON.stringify(exportData))\n                        }\n                        download=\"chessahoochee.json\"\n                    >\n                        Download all data\n                    </a>\n                </p>\n                <label>\n                    Load data file:{\" \"}\n                    <input type=\"file\" id=\"file\" onChange={handleFile}/>\n                </label>\n            </fieldset>\n            <fieldset>\n                <legend>Reset all changes</legend>\n                <button onClick={reloadDemoData}>Reload demo data</button>\n            </fieldset>\n            <form onSubmit={handleText}>\n                <fieldset>\n                    <legend>\n                        Advanced: manually edit data\n                    </legend>\n                    <textarea\n                        className=\"json\"\n                        rows={25}\n                        cols={50}\n                        value={text}\n                        name=\"playerdata\"\n                        onChange={(event) => setText(event.currentTarget.value)}\n                        spellCheck={false}\n                    />\n                    <p>\n                        <input type=\"submit\" value=\"Load\" />\n                    </p>\n                </fieldset>\n            </form>\n        </div>\n    );\n}\n","import React from \"react\";\nimport styles from \"./index.module.css\";\n\nconst Caution = () => (\n    <aside className={styles.caution}>\n        <p className={styles.caution__text}>\n            <span role=\"img\" aria-label=\"WARNING.\"></span>\n            &nbsp;\n            This is beta software.\n            &nbsp;\n            <span role=\"img\" aria-label=\"WARNING.\"></span>\n            {\" \"}\n            Want to help make it better? Check out the\n            {\" \"}\n            <span role=\"img\" aria-hidden></span>\n            &nbsp;\n            <a\n                className={styles.caution__link}\n                href=\"https://github.com/johnridesabike/chessahoochee\"\n            >\n                Git repository\n            </a>.\n        </p>\n    </aside>\n);\n\nexport default Caution;\n","import numeral from \"numeral\";\n\n// let's make a custom numeral format. I don't really know how this works.\nnumeral.register(\"format\", \"half\", {\n    regexps: {\n        format: /(1\\/2)/,\n        unformat: /(1\\/2)/\n    },\n    // eslint-disable-next-line no-unused-vars\n    format: function (value, format, roundingFunction) {\n        const whole = Math.floor(value);\n        const remainder = value - whole;\n        const fraction = (function () {\n            switch (remainder) {\n            case 0.25:\n                return \"\";\n            case 0.5:\n                return \"\";\n            case 0.75:\n                return \"\";\n            default:\n                return \"\";\n            }\n        }());\n        const stringedWhole = (\n            (whole === 0 && remainder)\n            ? \"\"\n            : String(whole)\n        );\n        return stringedWhole + fraction;\n    },\n    /** @param {string} value */\n    unformat: function (value) {\n        return Number(value); // doesn't work... todo?\n    }\n});\n","import React from \"react\";\nimport {\n    Router,\n    Link,\n    LocationProvider,\n    createHistory,\n    Redirect\n} from \"@reach/router\";\nimport createHashSource from \"hash-source\";\nimport About from \"./components/about\";\nimport NotFound from \"./components/404\";\nimport TournamentIndex from \"./components/tournament\";\nimport {TournamentList, Tournament} from \"./components/tournament\";\nimport Players, {PlayerList, PlayerInfo} from \"./components/players\";\nimport Scores from \"./components/tournament/scores\";\nimport PlayerSelect from \"./components/tournament/player-select\";\nimport Crosstable from \"./components/tournament/crosstable\";\nimport Round from \"./components/tournament/round\";\nimport {Options} from \"./components/options\";\nimport Caution from \"./components/caution\";\nimport {OptionsProvider, TournamentProvider, PlayersProvider} from \"./state\";\nimport \"side-effects\";\nimport \"@reach/tabs/styles.css\";\nimport \"@reach/tooltip/styles.css\";\nimport {link} from \"./App.module.css\";\n// These are just for deploying to GitHub pages.\nlet source = createHashSource();\nlet history = createHistory(source);\n\n// const electron = window.require(\"electron\");\n\nfunction App() {\n    return (\n        <div className=\"app\">\n            <Caution />\n            <LocationProvider history={history}>\n                <header className=\"header\">\n                    <h1>\n                         Chessahoochee: <small>a chess tournament app.</small>\n                    </h1>\n                    <nav>\n                        <Link to=\"tourneys\" className={link}>\n                            Tournaments\n                        </Link>\n                        <Link to=\"players\" className={link}>\n                            Players\n                        </Link>\n                        <Link to=\"options\" className={link}>\n                            Options\n                        </Link>\n                        <Link to=\"about\" className={link}>\n                            About\n                        </Link>\n                    </nav>\n                </header>\n                <main className=\"content\">\n                    {/* Lots of nested contexts. Is there a better way? */}\n                    <OptionsProvider>\n                        <PlayersProvider>\n                            <TournamentProvider>\n                                <Router>\n                                    <TournamentIndex path=\"tourneys\">\n                                        <TournamentList path=\"/\" />\n                                        <Tournament path=\":tourneyId\">\n                                            <PlayerSelect path=\"/\" />\n                                            <Crosstable path=\"crosstable\" />\n                                            <Scores path=\"scores\" />\n                                            <Round path=\":roundId\" />\n                                        </Tournament>\n                                    </TournamentIndex>\n                                    <Players path=\"players\">\n                                        <PlayerList path=\"/\"/>\n                                        <PlayerInfo path=\":playerId\" />\n                                    </Players>\n                                    <Options path=\"options\" />\n                                    <About path=\"about\" />\n                                    <NotFound default />\n                                    <Redirect from=\"/\" to=\"tourneys\" noThrow />\n                                </Router>\n                            </TournamentProvider>\n                        </PlayersProvider>\n                    </OptionsProvider>\n                </main>\n            </LocationProvider>\n        </div>\n    );\n}\n\nexport default App;\n","/* eslint-disable */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets;\n      // see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React, {StrictMode} from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\n// if (process.env.NODE_ENV !== \"production\") {\n//     const axe = require(\"react-axe\");\n//     axe(React, ReactDOM, 1000);\n// }\n\nReactDOM.render(\n    <StrictMode><App /></StrictMode>,\n    document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"scores_table__22BFZ\",\"topHeader\":\"scores_topHeader__2RVRR\",\"row\":\"scores_row__bmBzX\",\"playerName\":\"scores_playerName__3ghv9\",\"rank\":\"scores_rank__3AxBb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tournament\":\"tournament_tournament__2nSxH\",\"header\":\"tournament_header__9nZzI\",\"sidebar\":\"tournament_sidebar__21G-s\",\"content\":\"tournament_content__1mdG3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"round_table__2JmnE\",\"winnerSelect\":\"round_winnerSelect__317oT\",\"toolbar\":\"round_toolbar__3CWVM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"link\":\"App_link__TB6Cl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"caution\":\"caution_caution__17Bbq\",\"caution__text\":\"caution_caution__text__2ptRS\",\"caution__link\":\"caution_caution__link__X_K5Y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panels\":\"utility_panels__LN75I\",\"panel\":\"utility_panel__2GOiH\"};"],"sourceRoot":""}